<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD AnonCVS</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta http-equiv="Content-Type" content="text/html; charset=iso-2022-jp">
<meta name="description" content="How to get OpenBSD updates via Internet using Anonymous CVS">
<meta name="keywords" content="openbsd,anoncvs,updates">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-2004 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">

<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="../images/smalltitle.gif" border="0"></a>
<p>
<h2><font color="#e00000">Anonymous CVS</font></h2>

<hr>

<h3>目次</h3>

<ul>
<li><a href="#anoncvs">Anonymous CVS とは ?</a>
<li><a href="#CVS">CVS とは ?</a>
<li><a href="#starting">Anonymous CVS を使い始めるために</a>
<li><a href="#using">ソースツリーの取得・更新に CVS を使う</a>
<li><a href="#CVSROOT">利用可能な Anonymous CVS サーバ</a>
<li><a href="#CRYPTO">cvs(1) を使っての暗号ソースの取得</a>
<li><a href="#EXAMPLE">cvs(1) の使用例</a>
<li><a href="#WHICH">rsh(1) と ssh(1) をどちらを使うか ?</a>
<li><a href="#SUP">sup(1) を使った CVS リポジトリのミラーリング</a>
<li><a href="#MIRROR">anoncvs ミラーの構築</a>
</ul>

<hr>

<h3><a name="anoncvs"><font color="#0000e0">Anonymous CVS とは ?</font></a></h3>

<p>
Anonymous CVS は、現時点での OpenBSD ソースに対して加えられた更新に関して、
OpenBSD のソースツリーのあなたのローカルなコピーを最新に維持しておくための
方法です。開発の最先端に追従することに加えて、リリースの errata のための
パッチを追跡することもまた可能です。

<p>
他のソースコード更新技術に対する Anonymous CVS の主な利点は、中央の
ソースコードリポジトリかミラーに対して、それが直接働くということ
でしょう。これはつまり、あなたの変更と他のソースの変更に関する更新や
マージを制御したり、diff を取ったり、変更履歴や他のことを中央の
リポジトリに対して質問したりするために、フルセットの CVS コマンドを
あなたは使用できるということです。

<p>
OpenBSD プロジェクトは、現状では、次の 5 個の主ソースリポジトリを持っています。

<ul>
  <li><b>src</b> - OpenBSD オペレーティングシステムの全ソースコードを収容。
  <li><b>ports</b> - <a href="ports.html">OpenBSD Ports</a> を収容。
  <li><b>www</b> - すべての OpenBSD の Web ページ (このページを含む) を収容。
  <li><b>X11</b> - OpenBSD 対応の
      <a href="http://www.XFree86.org/">XFree86-3</a> ソフトウェアプロジェクトを収容。
      これは歴史的な理由で残されてるもので、ほとんどのユーザにとっては不要です。
      現在は使われていません。
  <li><b>XF4</b> - OpenBSD 版の X の開発用ソースツリー。
</ul>

<p>
要約しますと、Anonymous CVS を使用することの実際の強みは、それが「寛容な」
ソースコードコントロールシステムであるということであり、それは、あなたが
そのまま続けずに解決しなければならない難問のリストを放置するのではなく、
むしろ、あなたのローカルなソースに対してあなたが加えた変更と、あなたの
全体のソースツリーを更新するための<strong>「最善の努力」</strong>をする
ことを<strong>尊重する</strong>ということです。

<h3><a name="CVS"><font color="#0000e0">CVS とは ?</font></a></h3>

<p>
<a href="http://www.cvshome.org/">CVS</a> とは、
OpenBSD のソースツリーを管理するのに使用されているソースコードコントロール
システムです。</a>それは、すべての正式にリリースされたソースコードとそれに対する
変更のための中央のリポジトリを実装する一方で、開発者に対しては彼らの作業中の変更を
含むソースコードのローカルなコピーを保守することを許しています。

ソースツリーへのアクセスには、次の 2 種類のレベルがあります。
<ul>
<li><b>読み書きアクセス (開発者用)</b>
変更をソースツリーにコミットする必要がある開発者は、OpenBSD プロジェクトの
マシンにアカウントを持っていなければなりません。
ソースに対して他の OpenBSD 開発者と共同作業をするということは、通常、
このアクセスを得るということです。
すばらしい作業をしてる誰かが、それが OpenBSD のチームと共同でできるものだと
示したなら、その人にアカウントが発行されるでしょう。

<li><b>読み出し専用アクセス (誰でも可能)</b>
読み出し専用 CVS リポジトリには、誰でもアクセスすることが可能です。
ミラーサーバもたくさんあります。
</ul>

<p>
CVS の主な強みは、あなたの行ったあなたのローカルなコピーに対する変更とともに、
中央のリポジトリに対する変更のインテリジェントなマージを実行可能なことでしょう。
これは、もし、あなたがモジュールに対して変更を加えて、更新を実行した場合にも、
あなたの変更が「吹き飛ばされる」ようなことがないことを意味しており、むしろ、
CVS は、中央のソースに対する変更とあなたがあなたのローカルなコピーに対して
加えた変更とをマージするよう、最大限の努力を払おうとします。

<p>
変更を完全にマージできなかった場合には、CVS は「柔軟なフォールバック」を提供し、
また、あなたのローカルなコピーに対する注釈された変更を提供し、あなたのバージョンの
変更されていないコピーを保存し、そして、あなたの要求した他のソースモジュールの
更新を継続します。

<h3><a name="starting"><font color="#0000e0">Anonymous CVS
を使い始めるために</font></a></h3>

AnonCVS サーバからはソースコード全体をダウンロードすることもできますが、
OpenBSD の CD や FTP サーバからダウンロードしたソースファイルをあらかじめ
用意しておくことで、時間やネットワーク帯域を大幅に短縮することができます。
<i>-release</i> と <i>-stable</i> の間に加えられる変更点は比較的少ないので、
これは <a href="stable.html"><i>-stable</i></a> を運用している場合に
特に有利な方法です。

<p>
CD から /usr/src に CVS ツリーをコピーするには、次のようにします
(CD は /mnt にマウントされているものと仮定します)。
<pre>
    # <b>cd /usr/src; tar xzf /mnt/src.tar.gz</b>
    # <b>cd /usr; tar xzf /mnt/XF4.tar.gz</b>
    # <b>tar xzf /mnt/ports.tar.gz</b>
</pre>

FTP サーバからダウンロードしたソースファイルは、ソースツリーの一部を
入手したいという人の時間を節約できるように、2 個のファイルに分かれています。
この 2 個のファイルとは、カーネルの構築に必要な <tt>sys.tar.gz</tt> という
ファイルと、その他のユーザランドユーティリティが含まれる <tt>src.tar.gz</tt>
です。特別な理由がなければ、両方をインストールすべきでしょう。
ダウンロードしたファイル <tt>src.tar.gz</tt> と <tt>sys.tar.gz</tt> が、
<tt>/usr</tt> に置かれている場合、次のようにします。
<pre>
    # <b>cd /usr/src</b>
    # <b>tar xzf ../sys.tar.gz</b>
    # <b>tar xzf ../src.tar.gz</b>
    # <b>cd /usr</b>
    # <b>tar xzf XF4.tar.gz</b>
    # <b>tar xzf ports.tar.gz</b>
</pre>

<p>
この 2 個のファイルを必ず展開しなければならない、というわけでは
ありませんが、システム全体は互いに同期がとれていなければならないため、
通常はツリー全体を用意する必要があります。

<p>
cvs(1) を使って、ソースリポジトリを"<b>チェックアウト</b>"することも可能です。
具体的な手順については、<a href="#using">次のセクション</a>で解説します。

<p>
その後、<tt>/usr/src</tt> は、良きチェックアウトのための領域となり、ここで、すべての
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a>
コマンドがうまく動くことでしょう。

<h3><a name="using"><font color="#0000e0">ソースツリーの取得・更新に
CVS を使う</font></a></h3>

<p>
CVS は、ソースを受け取り、それを更新するための単純な方法であることを目指して
設計されたものです。まず最初に、追いかけるのは <i>-current</i> なのか、
<a href="stable.html">パッチブランチ</a> なのかを決める必要があります。
-current ツリーには細かい変更のすべてが含まれており、
パッチブランチは、正式リリースに加え、<a href="errata.html">errata</a>
の修正パッチや影響の小さな問題の修正が既に適用されたものとなっています。
このような OpenBSD の"種類"については、
<a href="faq/faq5.html#Flavors">ここ</a>をご覧ください。

<p>いったん、追いかけるツリーを決めたら、どの Anonymous CVS サーバを
使うのかを選択しなければなりません。これらのサーバのリストは、
<a href="#CVSROOT">このページの下のほう</a>にあります。

<p>
どの <a href="#CVSROOT">Anonymous CVS サーバ</a>を使うのかを選択したら、
cvs を使い始めることができます。
CD をお持ちの人は、自分のシステムにソースを取得するために、
<a href="#starting">上記</a>の方法で CD 上の CVS のチェックアウトで cvs を使い始められます。
もし、CD をお持ちでないなら、ソースをチェックアウトするために次の方法をお使いください。
この方法は、OpenBSD のソースを <i>/usr/src</i> に置くためのものです。

<pre>
	# <b>cd /usr; cvs checkout -P src</b>
</pre>

<p>
上記の方法は、<i>-current</i> のソースツリーをチェックアウトすることになります。多くの人に
とっては、パッチブランチのソースが欲しいことでしょう。このパッチブランチをチェックアウト
するためには、次の例のようにコマンドライン上でタグを指定する必要があります。

<pre>
	# <b>cd /usr; cvs checkout -P -rOPENBSD_3_6 src</b>
</pre>
<p>
これは、3.5 の場合なら、OPENBSD_3_5 となります。

<p>OPENBSD_3_6 のタグは、リリースのソースと適用済の errata
を含んでいます。

<h3><a name="CVSROOT"><font color="#0000e0">利用可能な Anonymous CVS サーバ
</font></a></h3>

<p>
<em>以下の <a href="#WHICH">ssh vs. rsh</a> に関する注を御参照ください &nbsp; !</em>
<p>
<ul>
<li><strong>CVSROOT=anoncvs@anoncvs1.usa.openbsd.org:/cvs</strong><br>
このホストは、<strong>anoncvs@anoncvs.usa.openbsd.org</strong> や
<strong>anoncvs@anoncvs4.usa.openbsd.org</strong> という別名があります。<br>
所在地: 米国西部のカルフォルニア州レッドウッド市<br>
保守担当: <a href="mailto:millert@openbsd.org">Todd Miller</a><br>
対応プロトコル: rsh、ssh、ssh port 2022、pserver<br>
更新間隔: 2 時間<br>
SSH fingerprints:<br>
(RSA1) 1024 64:de:26:16:c2:ff:1b:c7:24:ed:a4:4a:d7:2f:69:3e<br>
(RSA) 1024 49:67:9a:46:62:8a:3f:4e:b3:63:ca:d6:41:29:2a:2f<br>
(DSA) 1024 a7:75:49:77:f3:47:d1:3c:5e:65:84:84:3b:03:f1:33<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs2.usa.openbsd.org:/cvs</strong><br>
このホストは <strong>repository.citi.umich.edu</strong> という別名があります。<br>
所在地: 米国中央部のミシガン大学<br>
保守担当: <a href="mailto:rees@umich.edu">Jim Rees</a><br>
対応プロトコル: ssh, ssh port 2022<br>
更新間隔: 12 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs3.usa.openbsd.org:/cvs</strong><br>
所在地: 米国西部、コロラド州ボウルダーの国立気象研究所 (National Center for Atmospheric Research)<br>
保守担当: <a href="mailto:millert@openbsd.org">Todd Miller</a>.<br>
対応プロトコル: rsh, ssh, ssh port 2022, pserver.<br>
更新間隔: 2 時間<br>
SSH fingerprints:<br>
(RSA1) 1024 34:95:19:c2:b3:e7:61:7b:39:e8:ab:86:37:cd:c4:49<br>
(RSA) 1024 42:56:39:98:65:05:e7:2a:98:2b:ee:cc:e5:a3:53:ed<br>
(DSA) 1024 e3:e7:83:ef:f6:78:dc:d3:ca:a5:cf:64:c6:b7:4f:43<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs1.ca.openbsd.org:/cvs</strong><br>
このホストは、<strong>anoncvs.ca.openbsd.org</strong>、
<strong>openbsd.sunsite.ualberta.ca</strong> という別名があります。<br>
所在地: カナダ・アルバータ州のエドモントン<br>
保守担当: <a href="mailto:beck@ualberta.ca">Bob Beck</a><br>
対応プロトコル: ssh、rsh、ssh port 2022、pserver<br>
更新間隔: 2 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.no.openbsd.org:/cvs</strong><br>
このホストは、<strong>cvs.inet.no</strong> という別名があります。<br>
所在地: ノルウェー<br>
保守担当: <a href="mailto:cvsadmin@inet.no">Michael Shuldman</a><br>
対応プロトコル: rsh、ssh、ssh port 2022<br>
更新間隔: 4 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.at.openbsd.org:/cvs</strong><br>
このホストは <strong>togetic.kd85.com</strong> という別名があります。<br>
所在地: オーストリア<br>
保守担当: <a href="mailto:wim@kd85.com">Wim Vandeputte</a><br>
対応プロトコル: ssh, ssh port 2022<br>
更新間隔: 3 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.nl.openbsd.org:/cvs</strong><br>
このホストは、<strong>anoncvs.calyx.nl</strong> という別名があります。<br>
所在地: オランダのアムステルダム<br>
保守担当: <a href="mailto:nick@calyx.net">Nick Merrill</a> と
<a href="mailto:alex@calyx.nl">Alexander Grendel</a><br>
対応プロトコル: ssh<br>
更新間隔: 3 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.jp.openbsd.org:/cvs</strong><br>
このホストは、<strong>kankoromochi.econ.nagasaki-u.ac.jp</strong> としても知られています。<br>
所在地: 日本の長崎大学経済学部<br>
保守担当: <a href="mailto:sigh@net.nagasaki-u.ac.jp">鈴木 斉</a><br>
対応プロトコルは: ssh、pserver<br>
更新間隔: 3 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.de.openbsd.org:/cvs</strong><br>
このホストは、<strong>grappa.unix-ag.uni-kl.de</strong> という別名があります。<br>
所在地: ドイツのカイザースラウテルン大学<br>
保守担当: <a href="mailto:naddy@openbsd.org">Christian Weisgerber</a><br>
対応プロトコル: ssh、ssh port 2022、pserver<br>
更新間隔: 6 時間<br>
SSH fingerprints:<br>
(RSA) 1024 cf:a9:ee:a4:60:5d:66:00:50:5b:fd:d3:72:04:14:a3<br>
(DSA) 1024 78:d4:19:da:df:6f:c0:14:7f:4a:55:2a:e9:82:5f:e4<br>
<!-- <p>
<li><strong>CVSROOT=anoncvs@anoncvs.pl.openbsd.org:/cvs</strong><br>
このホストは、<strong>anoncvs1.pl.openbsd.org</strong>、
<strong>incredible.bmtmc.gda.pl</strong> という別名があります。<br>
所在地: ポーランド・グダンスクの BMT Maritime Consultants<br>
保守担当: <a href="mailto:detergent@incredible.bmtmc.gda.pl">
Adam Naguszewski</a><br>
対応プロトコルは: ssh、pserver<br>
更新間隔: 3 時間<br> -->
<P>
<li><strong>CVSROOT=anoncvs@rt.fm:/cvs</strong><br>
所在地: 米国イリノイ州レークインザヒルズ<br>
保守担当: <a href="mailto:jcs@rt.fm">Joshua Stein</a><br>
対応プロトコル: ssh<br>
更新間隔: 3 時間<br>
SSH fingerprints:<br>
(RSA) 1024 54:74:ca:17:d0:07:c3:53:b7:7e:1d:9b:10:bf:04:37<br>
(DSA) 1024 46:78:40:52:7a:18:f9:0e:68:61:b0:27:29:f9:d9:c4<br>
<p>
<li><strong>CVSROOT=anoncvs@cvs.openbsd.cz:/cvs</strong><br>
所在地: チェコ共和国のプラハ<br>
保守担当: <a href="mailto:vlada@openbsd.cz">Vladimir Kotal</a><br>
対応プロトコル: ssh、pserver<br>
更新間隔: 4 時間<br>
<!-- <p>
<li><strong>CVSROOT=anoncvs@anoncvs.openbsd.org.ua:/cvs</strong><br>
所在地: ウクライナのキエフ<br>
保守担当: <a href="mailto:hunter@dg.net.ua">Sergey Smitienko</a><br>
対応プロトコル: ssh<br>
更新間隔: 6 時間<br> -->
<p>
<li><strong>CVSROOT=openbsd@openbsd.bug.it:/cvs</strong><br>
所在地: イタリアのモデナ<br>
保守担当: <a href="mailto:jwk@bug.it">Giacomo Cariello</a><br>
対応プロトコル: ssh。パスワードは "openbsd" を御使用ください。<br>
更新間隔: 6 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.openbsd.lt:/cvs</strong><br>
このホストは、<strong>anoncvs.studentas.lt</strong> としても知られています。<br>
所在地: リトアニアのケーブル TV・インターネットサービス会社 TVK<br>
保守担当: <a href="mailto:helpas@ebox.lt">Donatas Budvytis</a><br>
対応プロトコル: ssh。パスワードは "anoncvs"<br>
更新間隔: anoncvs.usa.openbsd.org から 3 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs2.de.openbsd.org:/cvs</strong><br>
このホストは、<strong>openbsd.informatik.uni-erlangen.de</strong> としても知られています。<br>
所在地: ドイツのエアランゲン・ニュルンベルグ大学<br>
保守担当: <a href="mailto:Alexander.Gernler@informatik.stud.uni-erlangen.de">Alexander von Gernler</a><br>
対応プロトコル: ssh、ssh port 2022、pserver<br>
更新間隔: 2 時間<br>
SSH fingerprints:<br>
(RSA) 1024 fc:94:b0:c1:e5:b0:98:7c:58:43:99:76:97:ee:9f:b7<br>
(DSA) 1024 a9:00:3f:ba:50:81:16:d1:e9:b8:4f:3c:b2:10:e2:6c<br>
<p>
<li><strong>CVSROOT=anoncvs@mirror.osn.de:/cvs</strong><br>
所在地: ドイツのニュルンベルグ<br>
保守担当: <a href="mailto:aw@osn.de">Armin Wolfermann</a><br>
対応プロトコル: ssh<br>
更新間隔: 4 時間<br>
SSH fingerprints:<br>
(RSA) 1024 f2:73:d2:f6:e3:01:ef:ca:3b:e7:6c:80:b6:bd:bb:84<br>
(DSA) 1024 fb:33:05:62:96:20:cf:88:7e:10:cb:8d:91:72:57:32<br>
<p>
<li><strong>CVSROOT=anoncvs@openbsd.chem.uw.edu.pl:/cvs</strong><br>
所在地: ポーランドのワルシャワ<br>
保守担当: <a href="mailto:admin@chem.uw.edu.pl">Piotr Klein</a><br>
対応プロトコル: ssh<br>
更新間隔: 3 時間<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.student.pw.edu.pl:/cvs</strong><br>
所在地: ポーランドのワルシャワ工科大学<br>
保守担当: <a href="mailto:dmarcink@elka.pw.edu.pl">Darek Marcinkeiwicz</a><br>
対応プロトコル: ssh<br>
更新間隔: 3 時間<br>
<li><strong>CVSROOT=anoncvs@anoncvs.se.openbsd.org:/cvs</strong><br>
所在地: スウェーデン王立工科大学、Stacken コンピュータクラブ<br>
保守担当: <a href="mailto:hin@openbsd.org">Hans Insulander</a><br>
対応プロトコル: ssh<br>
更新間隔: 3 時間<br>
</ul>


<p>
<em>注:</em> もし、あなたのサーバが、不正確な情報や知らない情報で
ここにリストアップされていた場合、
<a href="mailto:beck@openbsd.org"><tt>beck@openbsd.org</tt></a>に御連絡ください。

<p>
あなたは、どのサーバが最も自分に近いところにあるのかを見つけるために、
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a>
を使いたいと思うかも知れません。
サーバに関する問題は、
問題のサーバの<b>メンテナ</b>に報告すべきです。

<h3><a name="CRYPTO"><font color="#0000e0">cvs(1)
を使っての暗号ソースの取得</font></a></h3>

<p>
<strong>重要な注意事項:</strong>
誰もが知っておくべきこととして、暗号ソフトウェアに関しては
若干の問題があります。
<ul>
<li>OpenBSD のソースはカナダからのもの
なので、
	<a href="http://www.efc.ca/pages/doc/crypto-export.html">
	カナダの個人によって研究されたもの</a>として、
また、
	<a href="http://axion.physics.ubc.ca/ECL.html">
	カナダの輸出制限リストの記述</a>にあるように、
カナダから世界に向けての暗号ソフトウェアの輸出は合法的なものです。
<p>
<li>しかしながら、あなたが、米国やカナダ以外の地域に住んでいるのなら、
あなたは米国内にある Anonymous CVS サーバから OpenBSD のソースの
暗号セクションを持っていくべきではありません。問題のファイルは次のとおりです。
<ul>
<li>src/kerberosIV/*
<li>src/kerberosV/*
<li>src/lib/libdes/*
<li>src/lib/libc/crypt/crypt.c
<li>src/lib/libc/crypt/morecrypt.c
<li>src/sys/crypto
<li>src/sys/netinet
<li>src/usr.sbin/afs/src/rxkad/*
<li>XF4/xc-mit/lib/Xdmcp/Wraphelp.c
<li>XF4/xc-old/lib/Xdmcp/Wraphelp.c
<li>XF4/xc/lib/Xdmcp/Wraphelp.c
</ul>
米国の ITAR 軍需品リストによって、暗号ソフトウェアは、
米国からカナダだけに対して輸出されたものかも知れないのです。
</ul>

<h3><a name="EXAMPLE"><font color="#0000e0">cvs(1) の使用例</font>
</a></h3>

<p>
注意: もし、(パッチブランチのような) ブランチを <i>-current</i> に更新したい場合、
<code>-A</code> フラグを cvs に追加することができますが、このフラグは他にはほとんど
使い道がないものです。古目のバージョンのバージョンの OpenBSD のドキュメンテーションでは、
多くの例の中で、このフラグの使用が推奨されていました。我々は最早、絶対に必要でない限りは、
このフラグを推奨していません。

<p>
Anonymous CVS サーバの使用法の例は次のとおりです。
<pre>
% <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
% <strong>cd /tmp</strong>
% <strong>cvs get src/sys/arch/sparc</strong>
    [リポジトリからあなたのマシンへファイルをコピー]
% <strong>cvs log src/sys/arch/sparc/sparc/locore.s</strong>
    [選択したファイルのコミットログを表示]
% <strong>cvs diff -bc -r1.1 -r1.5 src/sys/arch/sparc/sparc/locore.s</strong>
    [リビジョン 1.1 とリビジョン 1.5 との間の変更点を表示]
</pre>

<p>
<a name="pserver">cvs を ``pserver'' (ssh や rsh を使用する代わりの直接の TCP 接続) で使用する場合には、いったん login しなければなりません。</a>

<pre>
% <strong>setenv CVSROOT :pserver:anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
% <strong>cvs login</strong>
(anoncvs@anoncvs1.ca.openbsd.org への login)
CVS password: <strong>anoncvs</strong>
    [この行を ~/.cvspass に書く (ファイル名は CVS_PASSFILE がオーバーライドします)。]
    [上記において、'blah' とタイプした後の私の ~/.cvspass 内の行の一例              ]
    [password is:                                                                   ]
    [:pserver:anoncvs@anoncvs5.usa.openbsd.org:/cvs Au'yc                           ]
    [一度 login した後は、他のすべての上記の CVSROOT が動くようになるでしょう。     ]
% <strong>cvs get ksrc-i386 ksrc-common</strong>
    [あなたは、i386 カーネルを再構築するのに必要なものだけ、受け取ることができます。]
</pre>

<p>
Anonymous CVS を使用する人が、普通に自分のソースツリーを更新
するには、
<ul><li>まず、初期のツリーを `get' します。

<p> (もし、<i>-current</i> を追いかけているのなら):
<pre>
	# <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
	# <strong>cd /usr</strong>
	# <strong>cvs -q get -P src</strong>
</pre>

<p> (もし、3.6 のパッチブランチを追いかけているのなら):
<pre>
	# <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
	# <strong>cd /usr</strong>
	# <strong>cvs -q get -rOPENBSD_3_6 -P src</strong>
</pre>
</li>

<li> その後、いつでもこのツリーを `update' するには:
<p> (もし、<i>-current</i> を追いかけているのなら):
<pre>
	# <strong>cd /usr/src</strong>
	# <strong>cvs -q up -Pd</strong>
</pre>

<p> (もし、3.6 のパッチブランチを追いかけているのなら):
<pre>
	# <strong>cd /usr/src</strong>
	# <strong>cvs -q up -rOPENBSD_3_6 -Pd</strong>
</pre>

これを実行するごとに、いつでも自分の /usr/src ツリーを同期させるでしょう。これに
よってあなたのローカルな変更が壊されることはなく、むしろ、変更をマージしようと
試みます。

<p>
<li> 注:
もし、最初に異なるサーバから持ってきた、あるいは CD から持ってきたソースツリー
を更新しようとするのでしたら、<em>-d $CVSROOT</em> オプションを cvs のコマンドライン
に追加する<strong>必要があります</strong>。
<pre>
	# <strong>cd /usr/src</strong>
	# <strong>cvs -d $CVSROOT -q up -Pd</strong>
</pre>
</ul>

<p>
<a href="ports.html">ports</a> を<a name="ports">使う</a>のも、src と同様です。
<ul><li>
<p> (もし、<i>-current</i> を追いかけているのなら):
<pre>
	# <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
	# <strong>cd /usr</strong>
	# <strong>cvs -q get -P ports</strong>
</pre>
<p> (もし、3.6 のパッチブランチを追いかけているのなら):
<pre>
	# <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
	# <strong>cd /usr</strong>
	# <strong>cvs -q get -rOPENBSD_3_6 -P ports</strong>
</pre>
<li> その後、いつでもこのツリーを `update' するには:
<p> (もし、<i>-current</i> を追いかけているのなら):
<pre>
	# <strong>cd /usr/ports</strong>
	# <strong>cvs -q up -Pd</strong>
</pre>
<p> (もし、3.6 のパッチブランチを追いかけているのなら):
<pre>
	# <strong>cd /usr/ports</strong>
	# <strong>cvs -q up -rOPENBSD_3_6 -Pd</strong>
</pre>
</ul>

上記の例において、cvs の出力を最小化させるために、<i>-q</i> オプションも
指定可能です。画面いっぱいの出力がお好みの向きには、これのオプションは
外しておいた方が幸せでしょう。

<p>
また、ローカルにパッチを当てたモジュール (ここでは <i>cd.c</i>) をバグレポートに
含めるために diff を取るには、
<pre>
	# <strong>cd /usr</strong>
	# <strong>cvs diff -u src/sys/scsi/cd.c &gt; /tmp/patch</strong>
</pre>

<p>
(CVS ソースに含まれている)
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1&amp;format=html">
cvs(1) マニュアルページ</a>には、
もっと多くの CVS の使い方についての情報があります。

<p>
<strong>警告:</strong>
cvs を使用する場合には、カレントディレクトリが、参照しているツリーの root か、
/tmp のような独立した場所かのどちらかになっているよう、注意すべきでしょう。
"get" のようなあコマンドの場合、カレントディレクトリの下に、任意のサブツリーを作成
できてしまいますので、これに続く更新は再帰的にこのサブツリーを更新していくでしょう。

<p>
Anonymous CVS サービスは、経験の浅い開発者にとって、CVS のオペレーションを
学び、"commit" アクセスを経験するまでの、とても複雑な開発プロセスを経験するための
絶好のチャンスを提供していますが、高品質で有用な技術を見せることの結果として、
彼らはいずれ自然に開発者としてのアクセスを与えられるようになるでしょう。
同様に、パッチを提供する人は、CVS ツリーに関係する自分の "diff" を作成することが
できますが、それは、簡単に統合できるものでしょう。


<h3><a name="WHICH"><font color="#0000e0">rsh(1) と ssh(1) をどちらを使うか ?</font></a></h3>

CVS は、サーバ・クライアント間で 3 種類のアクセス方法に対応しています。

<ul>
<li><b>ssh:</b> anonymous CVS サーバへのアクセスに Secure Shell を使います。
情報が暗号化されるため、<i>おすすめの</i>方法です。

<li><b>rsh:</b> <a href="http://www.openssh.com/">ssh</a> を使うことが
できないユーザ向けに用意されたサーバには、Remote Shell
に対応したものがあります。

<li><b>pserver:</b> pserver は、上記の 2 種類の方法がファイアウォールによって
遮断されてしまっているユーザにとって特に有用な方法です。
</ul>

<b>注意:</b> rsh を使う人場合は、最初に <tt>CVS_RSH</tt> 環境変数に
rsh(1) プログラムのパス名を設定する必要があります。

<ul>
<li>Korn/Bourne シェルの場合:
<pre>
        $ <b>export CVS_RSH=/usr/bin/rsh</b>
</pre>
<li>csh/tcsh の場合:
<pre>
        % <b>setenv CVS_RSH /usr/bin/rsh</b>
</pre>
</ul>

<p>
OpenBSD の CVS クライアントはデフォルトで、CVS サーバとのやり取りに ssh ("secure shell":
<a href="http://www.openssh.com/">OpenSSH</a>) を使用します。

<p>
多くの CVS サイトは、最早セキュリティ上の理由から rsh をサポートしていません。
ファイアウォール等のローカルな問題や、slirp のような不完全なプロトコルエミュレータ
もまた、rsh の利用の邪魔になるかも知れません。しかし、それでも、もし、rsh を使う必要が
ある場合には、<var>CVS_RSH</var> 環境変数に rsh を指定しなければなりません
(典型的には <strong>/usr/bin/rsh</strong> です)。

<p>
もし、ローカルなポリシーが ssh のデフォルトポートの 22 番の外との接続を邪魔する場合、
ポート 2022 がその代わりに使用されるかも知れません。しかしながら、それはすべての Anonymous
CVS サーバがこのポートでの ssh 接続を受け付けるわけではないことに注意する必要があります。
さらに、セキュリティ上の理由から、最近のバージョンの ssh では、暗号<strong>なし</strong>
が無効化されていますので、ほとんどの Anonymous CVS サーバは最早この接続を受け付けません。
また、CVS では既に圧縮が有効ですので、ssh での圧縮を有効にしようとはしません。

<p>
上記に述べた制限や落し穴を避けるために、
<strong>$HOME/.ssh/config</strong> コンフィグレーションファイルなどを
指定することができます。
<pre>
	Host anoncvs.ca.openbsd.org
	    Compression no
	    Port 2022
</pre>

<p>
CVS をスタートする際は、少々騒々しいので、少し静かにさせるために、
次のようなことをしたくなるかも知れません。

<pre>
	<strong>% setenv CVS_CLIENT_PORT -1</strong>
</pre>

<p>
<h3><a name="SUP"><font color="#0000e0">sup(1) を使った
CVS リポジトリのミラーリング</font></a></h3>

<p>
OpenBSD のツリーそのものをミラーしようとするユーザは、
<em>anoncvs.usa.openbsd.org</em> や <em>anoncvs3.usa.openbsd.org</em>
(これらは異なるマシンです) から、そうしようとするかも知れません。しかし、これらは
cvs ツリーであり、ソースツリーをチェックアウトしているのでは<b>ない</b>ことに注意
する必要があります。これは、もし、高速な cvs オペレーション (diff、annotate 等) や、
もし、複数のソースツリーを持ち、新しいものを転送したい (そうすれば、ローカルな cvs
ミラーからツリーをチェックアウトすることができます) 場合にのみ有用でしかありません。
<p>
supfile の例は次のとおりです。
<pre>
	cvs host=anoncvs.usa.openbsd.org hostbase=/ base=/home delete
</pre>
<p>
これは、/home/sup の中の最後の sup データファイルとともに cvs ツリーを
/home/cvs にミラーするでしょう。すべての OpenBSD cvs ツリーは、現状では
およそ 2.5GB のサイズになります。もちろん、これは今後も増え続けるでしょう。

<h3><a name="MIRROR"><font color="#0000e0">anoncvs ミラーの構築
</font></a></h3>

<p>
もし、あなたが Anonymous CVS のミラーサイトを構築して、
それを一般公開しようとお考えでしたら、Anonymous CVS
の<a href="mailto:sup@openbsd.org">メンテナ</a>に御連絡ください。
Anonymous CVS ミラーは約 2.2GB のディスク容量を必要とし、Anonymous CVS ユーザ
ひとり当たり 32MB までのスワップを使用する (ユーザは大きなオペレーションを行うもの
と仮定する一方で、小さなオペレーションはより少量のリソースを使用すると仮定しますが、
それでもなお、 Anonymous CVS は ftp や sup より大きなインパクトがあります)。
そのような Anonymous CVS マシンは、サービスを行おうとする地域に対する優れた
ネットワーク接続を持つべきでしょう。Anonymous CVS サーバを構築について記述された
<a href="../anoncvs.shar">ドキュメント</a>が利用可能となっています。

<h3><font color="#0000e0">最終的な注意事項</font></h3>
ソースツリーをアップグレードした後、構築しようとする前に、
<kbd>/usr/src/Makefile</kbd> の先頭のコメントを読むべきでしょう。
また、もし、可能なら、<kbd>make build</kbd> を実行する<strong>前</strong>に
新しいカーネルを構築しておくべきです。場合によっては、カーネルを構築できる
ようになる前に、<kbd>config</kbd> ユーティリティを再構築し、インストールして
おく必要があるかも知れません。もし、<kbd>config GENERIC</kbd> が失敗する
ようでしたら、たぶん、このケースでしょう。
<p>
ソースからの再構築によって、リリースから -current ツリーへのアップグレードは、
しばしば明確ではない依存性のため、どちらかと言えば難しいということに注意して
ください。ですので、ソースからツリーを構築しようとする前に、まず、最新の
スナップショットをインストールすることを提案しておきます。

<hr>
<a href="index.html"><img height="24" width="24" src="../back.gif" border="0"
alt="OpenBSD"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!-- 
Originally [OpenBSD: anoncvs.html,v 1.227 ]
$Translation: anoncvs.html,v 1.36 2005/01/20 04:32:48 toshi Exp $
-->
$OpenBSD: anoncvs.html,v 1.34 2005/01/20 19:41:28 jufi Exp $
</small>

</body>
</html>
