<!DOCTYPE HTML PUBLIC  "-//IETF//DTD HTML Strict Level 2//EN//2.0">
<html>
<head>
<title>Kryptografie in OpenBSD</title>
<link rev=made href=mailto:www@openbsd.org>
<meta name="resource-type" content="document">
<meta name="description" content="OpenBSD Kryptografie">
<meta name="keywords" content="openbsd,Kryptografie,openssh,openssl,kerberos">
<meta name="keywords" content="ipsec,photuris,isakmp,ike,blowfish,des,rsa,dsa">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1997 by OpenBSD.">
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#23238E">
<img align=left alt="[OpenBSD]" height=166 width=197 SRC="../images/blowfish-notext.jpg">
<br>
<br>
<br>
Das Mantra eines jeden guten Sicherheitsingenieurs ist : "Sicherheit
ist kein Produkt, sondern ein Prozess !" Es steckt mehr dahinter
als starke Kryptografie in ein System zu integrieren, es bedeutet das gesamte
System so zu entwerfen, dass alle Sicherheitsmassnahmen, inklusive der 
Kryptografie, zusammen arbeiten. 
<br>
<br>
-- Bruce Schneier, Autor von "Applied Cryptography".
<br clear=all>
<h2><font color=#e00000>Cryptography</font><hr></h2>

<strong>Index</strong><br>
<a href=#why>Warum liefern wir Kryptografie aus?</a>.<br> 
<a href=#ssh>OpenSSH</a>.<br> 
<a href=#prng>Pseudo Zufallszahlen Generatoren</a> (PRNG): ARC4, ...<br>
<a href=#hash>Kryptografische Hash Funktionen</a>: MD5, SHA1, ...<br>
<a href=#trans>Symmetrische Verschlüsselungsverfahren</a>: DES, Blowfish, ...<br>
<a href=#hardware>Unterstützung für kryptologische Hardware</a><br>
<a href=#people>Internationale Kryptologen gesucht</a><br>
<a href=#papers>Weitere Quellen</a><br>
<p>
<hr>

<a name=why></a>
<h3><font color=#e00000>Warum liefern wir Kryptografie aus ?</font></h3><p>

In drei Worten:  <strong>weil wir können</strong>.<p>

Das OpenBSD Projekt ist in Kanada beheimatet.<p>

Die <a href=../ECL.html>Export Kontrollliste von Kanada</a>
beinhaltet keine signifikaten Beschränkungen bezüglich des
Exports von kryptologischer Software, und ist sogar noch offener,
was den Export frei-erhältlicher kryptologischer Software angeht.
Marc Plumb hat 
<a href=http://insight.mcmaster.ca/org/efc/pages/doc/crypto-export.html>
einige Nachforschungen betrieben, um die Kryptologiegesetze zu prüfen
</a>.
<p>

Daher hat das OpenBSD-Projekt Kryptologie in zahlreichen Orten im Betriebsystem
integriert. Wir verlangen, dass die kryptologische Software, die wir benutzen
wollen, 
<a href=policy.html>frei erhältlich ist und guten Lizenzen unterliegt</a>.
Wir benutzen Kryptografie mit garstigen Lizenzen nicht direkt.
Wir verlangen ausserdem, dass solche Software aus Ländern mit vernünftigen
Exportbedingungen kommt, da wir nicht die Gesetze irgendeines Landes brechen 
wollen.
Die kryptografischen Komponenten, die wir momentan benutzen, wurden in
Argentinien, Australien, Kanada, Deutschland, Griechenland, Norwegen und
Schweden geschrieben.
<p>

Wenn wir OpenBSD Versionen oder Snapshots machen, erzeugen wir diese
in freien Ländern, um sicherzustellen, dass sowohl Sourcen, als auch
Binaries frei von Beschränkungen sind.
In der Vergangenheit wurden unsere Versionen in Kanada, Schweden und
Deutschland erzeugt.
<p>

OpenBSD wird mit Kerberos IV ausgeliefert.  Die Codebase, die wir benutzen
ist die exportierbare KTH-basierte Version aus Schweden.
Unsere X11-Sourcen wurden ebenfalls so erweitert, dass sie Gebrauch von
Kerberos IV machen.
Kerberos V Unterstützung wird irgendwann in 2000 erscheinen, aber
zur Zeit existiert einfach keine frei exportierbare Version von
Kerberos V.
<p>

Heutzutage ist Kryptografie eine wichtige Sache, um die 
<a href=security.html>Sicherheit</a> eines Betriebsystems zu 
erhöhen. Die in OpenBSD integrierte Kryptografie kann in folgende
Bereiche klassifiziert werden :
<p>

<a name=ssh></a>
<h3><font color=#e00000>OpenSSH</font></h3><p>

Was ist das erste, was die Leute tun, nachdem sie OpenBSD installiert 
haben ?  Sie installieren Secure Shell 
(<a href=http://www.openbsd.org/cgi-bin/man.cgi?query=ssh>ssh</a>)
aus dem Ports-Tree oder den Paketen auf den FTP-Servern. Bis vor 
einiger Zeit zumindest.
<p>

Seit der Version 2.6 hat OpenBSD 
<a href="http://www.openssh.com/">OpenSSH</a> integriert , eine absolut
freie und nicht-patentierte Version von ssh. 
<a href="http://www.openssh.com/">OpenSSH</a> interagierte mit ssh Version 1
und hatte viele weitere Features.
<ul>
<li>
Alle Teile restriktiver Natur wurden entfernt (also Patente, siehe
<a href=http://www.openbsd.org/cgi-bin/man.cgi?query=ssl>ssl</a>)
jegliche lizensierte oder patentierte Komponenten stammten aus externen
Libraries/Bibliotheken.
</li>
<li>
war um das Protokoll Version 1.5 erweitert worden.
</li>
<li>
beinhaltete Unterstützung für 
<a href=http://www.openbsd.org/cgi-bin/man.cgi?query=kerberos>kerberos</a>
Authenfizierung und Ticket-Passing.
</li>
<li>
unterstützte Einmal-Passwörter durch 
<a href=http://www.openbsd.org/cgi-bin/man.cgi?query=skey>skey</a>.
</li>
</ul>
<p>

Grob gesagt haben wir eine Version von ssh mit freier Lizenz genommen und sie OpenBSD-fiziert.
Wir umgehen das USA-basierte Patent von RSA, indem wir einen einfachen Weg 
anbieten, die libcrypto und libssl Libraries mit RSA einfach herunterzuladen
und zu installieren. 
Diese Pakete basieren auf OpenSSL. Leute, die ausserhalb der USA leben, können
den von RSA patentierten Code frei benutzen, solange sie ihn nicht für
kommerzielle Zwecke einsetzen.
Es sieht so aus, als ob Firmen innerhalb der USA RSA-patentierten Code
ebenfalls frei benutzen können, solange RSA keine Hauptrolle beim 
Geldverdienen spielt.
<p>

Aber auf diesem Wege bekommt fast jeder ein eingebautes ssh in seinem Betriebssystem.
<p>

<strong>NEU!  OpenSSH unterstützt Protokoll 2.0!</strong><p>

Vor kurzem haben wir OpenSSH so  erweitert, dass es auch das SSH2 Protokoll benutzen
kann. Ein ssh-daemon, der alle 3 wichtigen SSH-Protokole beherrscht, bringt uns 
viel mehr Flexibilität. Protokoll 2.0 benutzt kein RSA für seine Publib-Key-Kryptografie,
und verlässt sich stattdessen auf DH und DSA Algorithmen. In OpenBSD 2.7 -- das mit dem neuen SSH 
ausgeliefert wird -- hast du Protokoll 2.0 Unterstützung gleich mit eingebaut! Wenn du zusätzlich 
Protokoll 1.3 und 1.5 unterstützen willst, brauchst du nur das RSA-Paket zu installieren (so wie
auf der <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=ssl>ssl</a>
manual Page beschrieben), und den Daemon neu starten.
 

<a name=prng></a>
<h3><font color=#e00000>Pseudo Zufallszahlen Generatoren</font></h3><p>

Ein Pseudo Zufallszahlengenerator (PRNG = Pseudo Random Number Generator) versorgt Applikationen mit einem Strom
von Zahlen, die einen erheblichen Einfluss auf die Sicherheit des Systems haben:
<p>

<ul>
<li>Es sollte für einen Aussenstehenden unmöglich sein, weitere Zahlen vorauszusagen,
sogar mit Kenntnis der bisherigen Zahlen.
<li>Die generierten Zahlen sollten keine sich wiederholenden Muster aufweisen,
d.h. der PRNG sollte einen sehr langen  Kreislauf haben.
</ul>
<p>

Ein PRNG ist eigentlich nur ein Algorithmus, bei dem mit den selben Startwerten
auch die selben Ergebnisse herauskommen.
Bei einem Multi-User-System gibt es viele Möglichkeiten den PRNG mit
Zufallsdaten zu füttern.
Der OpenBSD Kernel benutzt das Maus-Interrupt-Timing, Netzwerk-Daten-Interrupt-
Verzögerungen, die Zeit zwischen Tastendrücken und Festplatten IO-Informationen
um Zufallszahlen zu bekommen.
Zufallszahlen stehen den Kernel-Routinen zur Verfügung und werden an 
"Userland"-Programme weitergegeben.
Bisher werden Zufallszahlen hierbei benutzt :<p>

<ul>
<li>Dynamische sin_port Zuweisung in bind(2).
<li>PIDs von Prozessen.
<li>IP Datagramm IDs.
<li>RPC Transaktions IDs (XID).
<li>NFS RPC Transaktions IDs (XID).
<li>DNS Abfrage-IDs.
<li>Inode generation numbers, siehe getfh(2) und fsirand(8).
<li>Timing Störungen in traceroute(8).
<li>Stärkere vorübergehende Namen für mktemp(3) und mkstemp(3)
<li>Zufälligkeit zum  TCP ISS hinzugefügt, um Spoofing-Angriffe zu
	verhindern.
<li>
	random padding in IPSEC esp_old Paketen.
<li>Um salts für die verschiedenen Passwort-Algorithmen zu generieren..
<li>Um vorgetäuschte S/Key Herausforderungen zu generieren.
<li>In <a href=http://www.physnet.uni-hamburg.de/provos/photuris/>photurisd</a> 
        und <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd>isakmpd</a>
	um einen guten Beweis für den Schlüssel-Austausch zu haben.
</ul>

<p>
<a name=hash></a>
<h3><font color=#e00000>Kryptografische Hash Funktionen</font></h3><p>

Eine Hash Funktion komprimiert ihre eingegebenen Daten zu einer
Zeichenkette konstanter Länge.
Für eine kryptografische Hash-Funktion ist es undurchführbar folgendes zu finden:

<ul>
<li>Zwei Eingaben, die die selbe Ausgabe erzeugen (Resistent gegen Kollisionen),
<li>Eine andere Eingabe für eine gegeben Eingabe mit der selben Ausgabe
	(2nd preimage resistant).
</ul>
<p>

In OpenBSD werden MD5, SHA1, und RIPEMD-160 als kryptografische Hash-Funktionen benutzt,
z.B. hier:<p>
<ul> 
<li>In <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=skey>S/Key</a>
    um Einmal-Passwörter bereitzustellen.
<li>In <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec>IPsec</a>,
    <a href=http://www.physnet.uni-hamburg.de/provos/photuris/>photurisd</a>
    und
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd>isakmpd(8)</a>
    um die Herkunft von Daten zu authentifizieren und Packetintegrität zu gewährleisten.
<li>Um MD5 Passwörter im FreeBSD-Stil bereitzustellen (kein Standard), siehe
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=passwd.conf&sektion=5>
    passwd.conf(5)</a>
<li>Für TCP SYN Cookie Unterstützung (kein Standard), siehe
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=options&sektion=4>
    options(4)</a>
<li>In libssl zum digitalen Signieren von Nachrichten.
</ul>
<p>

<p>
<a name=trans></a>
<h3><font color=#e00000>Symmetrische Verschlüsselungsalgorithmen</font></h3><p>

Symmetrische Verfahren werden benutzt um Daten zu ver- und entschlüsseln.
Normalerweise werden sie mit einem Schlüsel zur Ver- und einem Schlüssel zur 
Entschlüsselung gebraucht. Die Sicherheit eines symmetrischen Algorithmus sollte
wirklich nur auf den Schlüsseln beruhen.
<p>

OpenBSD stellt symmetrische Verfahren wie DES, 3DES, Blowfish und Cast für Kernel-
und Userland-Programme zur Verfügung, die an vielen Plätzen, wie z.B. an diesen benutzt
werden :
<p>
<ul>
<li>In der libc zum Erstellen von
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=blf_key>Blowfish</a>
    Passwörtern.  Dazu siehe auch das <a href=../papers/bcrypt-paper.ps>USENIX paper</a>
    .
<li>In
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec>IPsec</a>
    um Vertrauen in die Netzwerkschicht zu bringen.
<li>In Kerberos und einer handvoll "kerberisierter" Applikationen, wie
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=telnet>telnet</a>,
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=cvs>cvs</a>,
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=rsh>rsh</a>,
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=rcp>rcp</a>,
    und
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=rlogin>rlogin</a>.
<li>In <a href=http://www.physnet.uni-hamburg.de/provos/photuris/>
    photurisd</a> und
    <a href=http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd>isakmpd</a>
    um den Austausch von IPsec Schlüsselmaterial zu schützen.
<li>In AFS um die Nachrichten zu schützen, die über das Netzwerk gehen,
    und Vertrauen in den Zugriff auf entfernte Dateisysteme zu gewährleisten.
<li>In libssl um Applikationen über das kryptografisch sichere und zudem
    de-facto-Standard 
    ssl-Protokoll laufen zu lassen.
</ul>

<a name=hardware></a>
<h3><font color=#e00000>Unterstützung für kryptologische Hardware</font></h3><p>

OpenBSD unterstützt seit Version 2.7 einige kryptologische Hardware wie etwa 
Hardwarebeschleuniger und Zufallszahlengeneratoren.
<ul>
<li><b>IPSEC crypto dequeue</b><br>
    Unser IPSEC Stack wurde so verändert, dass kryptografische Funktionen
    auch "aus-der-Reihe" gemacht werden können. Die meisten Software IPSEC Stacks
    müssen die kryptografischen Funktionen mit jedem einzelnen Paket, das sie behandeln,
    durchführen. Das resultiert in synchroner Leistungsfähigkeit. Um Hardware sauber und schnell
    zu nutzen, muss man diese zwei Komponenten trennen, so wie wir das gemacht haben. Tatsächlich
    springt dabei sogar etwas Leistung für die Softwareseite heraus.
<p>
<li><b>HiFn 7751</b><br>
    Karten, die den <a href="http://www.hifn.com/products/7751.html">HiFn 7751</a>
    verwenden können als kryptografischer Hardwarebeschleuniger benutzt werden, z.B. 
    <a href="http://www.powercrypt.com">PowerCrypt</a>).
    Die momentan dabei erreichte Leistung beträgt
    63Mbit/sec für 3DES/SHA1 ESP, wenn man einen einzelnen Hifn 7751 auf jeder Seite eines
    Tunnels hat, das ist fast eine 600%ige Verbessrung gegenüber einer
    P3/550 CPU.  An weiteren Verbesserungen bezüglich einiger Punkte wird noch gearbeitet,
    aber mit Stand 13.April 2000 wird der Code als stabil angesehen.
    Wir haben unseren eigenen Treiber geschrieben, um diesen Chip zu unterstützen, anstatt
    den (in den USA geschriebenen)
    <a href="http://www.powercrypt.com">powercrypt</a> Treiber zu benutzen, ausserdem
    arbeitet unser Treiber sauber mit IPSEC zusammen.<p>
    Der 7751 wird in bezug auf Industriestandard als langsam angesehen und viele Anbieter 
    haben schnellere Chips (auch HiFn hat einen schnelleren, aber auch teuereren Chip).
    <p>
<li><b>Broadcom Bluesteelnet 5501/5601/5805</b><br>
    Direkt nach der Veröffentlichung von OpenBSD 2.7 konnten wir Unterstützung
    für diese frühen Versionen erreichen,  die uns der Hersteller
    zu Verfügung gestellt hat, insbesondere von 
    <a href="http://www.bluesteelnet.com/product.html">5501</a>.
    Die anderen Karten sind ähnlich, ausser dass sie auch eine asymmetrische Maschine
    hinzufügen,um DSA, RSA und ähnliche Algorithmen zu untersützen. Mit einer 
    annähernd doppelt so grossen Performance wie die der HiFn wird dieses Gerät hoffentlich
    verbreiteter sein. Wir haben den Treiber noch nicht optimiert, so dass Performancezahlen
    noch folgen werden.
    <p>

<li><b>Andere Karten</b><br>
    Wir nähern uns auch der Unterstützung von weiteren Chips wie etwa:
    <ul>
    <li><a href="http://www.ire.com/OEM/OEMTechnologyDefault.htm">IRE 2141</a>
    <li><a href="http://www.pcc.pijnenburg.nl/pcc-ises.htm">Pijnenburg PCC-ISES</a>
    <li>vielleicht dem
    <a href="http://www.3com.com/promotions/3c990promo/index.html">3com 3c990</a>
    <li>und weiteren
    </ul>
    <p>
    Von diesen Anbietern war insbeondere IRE sehr freundlich und hat uns alle Informationen gegeben,
    die wir brauchen, um ihre Hardware zu unterstützen. Andere Anbieter sind ebenfalls auf
    auf unserer Liste, aber wir konzentrieren uns zuerst auf die schnellen und einfachen Lösungen.
    Intel (und 3com , aber nicht ganz so deutlich) verstehen noch nicht ganz, 
    wie sie davon profitieren können, wenn sie uns Dokumentation ihrer
    kryptografischen Karten geben, also ist es uns jederzeit recht, wenn du sie
    kontaktieren und sie ermutigen willst.
    <p>
    Wenn jemand beim Schreiben der Treiber helfen will, bitte einfach 
    <a href=#people>herkommen und mithelfen</a>.
<p>
<li><b>Intel 82802AB/82802AC Firmware Hub RNG</b><br>
    Der 82802 FWH Xhip (zu finden auf i810, i820, und i840 Motherboards) enthält
    einen Zufallszahlengenerator (random number generator (RNG)).  Hochleistungs-IPSEC 
    benötigt eine größere Zufallszahlenentropie. Nach Stand vom 10. April 2000 unterstützen
    wir den RNG. Wir werden Unterstützung für weitere RNG hinzufügen, die wir auf
    Crypto-Chips finden.
<p>
<li><b>OpenSSL</b><br>
    Wir haben grosse Pläne, was die Unterstützung für Karten betrifft, die RSA oder
    DSA-Operationen durchführen, und auch was das Auslagern solcher Funktionen in die
    OpenSSL betrifft, so dass Userland-Programme
    (also hier <a href="http://www.openssh.com">ssh</a>,
    <a href="http://www.modssl.org/">apache https</a>, etc.)
    davon profitieren können.
</ul>

<p>

<p>
<a name=people></a>
<h3><font color=#e00000>Internationale Kryptologen gesucht</font></h3><p>

Natürlich braucht unser Projekt Leute, die an diesen Systemen arbeiten. 
Wenn ein Nicht-amerikanischer Kryptologe, den die oben erwähnten Zwänge
nicht betreffen, an Mitarbeit an unserer eingebettenen Kryptologie 
interessiert ist, soll er uns kontakten.
<p>

<p>
<a name=papers></a>
<h3><font color=#e00000>Weitere Quellen</font></h3><p>

Eine Reihe von Leuten aus dem OpenBSD-Team haben Vorträge und Aufsätze über
die Veränderungen geschrieben, die sie in OpenBSD eingeführt haben.
Die Postscript-Versionen sind hier erhältlich:
<p>

<ul>
<li>A Future-Adaptable Password Scheme.<br>
    <a href=../events.html#usenix99>Usenix 1999</a>,
    by <a href=mailto:provos@openbsd.org>Niels Provos<a/>,
    <a href=mailto:dm@openbsd.org>David Mazieres</a>.<br>
    <a href=../papers/bcrypt-paper.ps>paper</a> and
    <a href=../papers/bcrypt-slides.ps>slides</a>.
<p>
<li>Cryptography in OpenBSD: An Overview.<br>
    <a href=../events.html#usenix99>Usenix 1999</a>,
    by <a href=mailto:deraadt@openbsd.org>Theo de Raadt</a>,
    <a href=mailto:niklas@openbsd.org>Niklas Hallqvist</a>,
    <a href=mailto:art@openbsd.org>Artur Grabowski</a>,
    <a href=mailto:angelos@openbsd.org>Angelos D. Keromytis</a>,
    <a href=mailto:provos@openbsd.org>Niels Provos</a>.<br>
    <a href=../papers/crypt-paper.ps>paper</a> and
    <a href=../papers/crypt-slides.ps>slides</a>.
</ul>

<p>
<hr>
<a href=index.html><img height=24 width=24 src=../back.gif border=0 alt=OpenBSD></a>
<a href=mailto:www@openbsd.org>www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: crypto.html,v 1.58 ]
<br>
$Translation: crypto.html,v 1.13 2000/06/16 20:54:28 jufi Exp $
<br>
</small>
<small>$OpenBSD: crypto.html,v 1.8 2000/06/16 21:04:33 jufi Exp $</small>
</body>
</html>
