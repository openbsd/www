<!doctype html>
<html lang=en>

<!-- If you make edits to any FAQ documents, please start each sentence
     on a new line, and try to keep the general formatting consistent
     with the rest of the pages -->

<title>OpenBSD PF: Runtime Options</title>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../../openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/faq/pf/options.html">

<!--
Copyright (c) 2003-2007 Joel Knight <enabled@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<h2 id=OpenBSD>
<a href="../../index.html">
<i>Open</i><b>BSD</b></a>
PF - Runtime Options
<small>
<a href="index.html">[Contents]</a>
</small>
</h2>
<hr>

<p>
Options are used to control PF's operation.
Options are specified in <code>pf.conf</code> using the <code>set</code>
directive.

<dl id="block-policy">
<dt><code>set block-policy <i>option</i></code><br>
<dd>Sets the default behavior for <a href="filter.html">filter</a> rules
    that specify the <code>block</code> action.
    <ul>
      <li><code>drop</code> - packet is silently dropped.
      <li><code>return</code> - a TCP RST packet is returned for blocked TCP
          packets and an ICMP Unreachable packet is returned for all others.
    </ul>
<dd>Note that individual filter rules can override the default response.
    The default is <code>drop</code>.
</dl>

<dl id="debug">
<dt><code>set debug <i>option</i></code><br>
<dd>Set pf's debugging level.
    Choices include <code>emerg</code>, <code>alert</code>, <code>crit</code>,
    <code>err</code>, <code>warning</code>, <code>notice</code>,
    <code>info</code> and <code>debug</code>.
</dl>

<dl id="fingerprints">
<dt><code>set fingerprints <i>file</i></code><br>
<dd>Sets the file to load operating system fingerprints from.
    For use with <a href="filter.html#osfp">passive OS fingerprinting</a>.
    The default is <code>/etc/pf.os</code>.
</dl>

<dl id="limit">
<dt><code>set limit <i>option value</i></code><br>
<dd>Set various limits on pf's operation. The current settings of
    these values can be viewed with <code>pfctl -s memory</code>.
    <ul>
      <li><code>frags</code> - maximum number of entries in the memory pool used
          for packet reassembly (scrub rules).
          Default is 5000.
      <li><code>src-nodes</code> - maximum number of entries in the memory pool
          used for tracking source IP addresses (generated by the
          <code>sticky-address</code> and <code>source-track</code> options).
          Default is 10000.
      <li><code>states</code> - maximum number of entries in the memory pool
          used for state table entries (<a href="filter.html">filter</a> rules
          that specify <code>keep state</code>).
          Default is 100000.
      <li><code>tables</code> - maximum number of
          <a href="tables.html">tables</a> that can be created.
          Default is 1000.
      <li><code>table-entries</code> - the overall limit on how many addresses
          can be stored in all tables.
          Default is 200000.
          If the system has less than 100MB of physical memory, the default is
          set to 100000.
    </ul>
</dl>

<dl id="loginterface">
<dt><code>set loginterface <i>interface</i></code><br>
<dd>Sets the interface for which PF should gather statistics such as bytes
    in/out and packets passed/blocked.
    Statistics can only be gathered for <i>one</i> interface at a time.
    Note that the <code>match</code>, <code>bad-offset</code>, etc., counters
    and the state table counters are recorded regardless of whether
    <code>loginterface</code> is set or not.
    To turn this option off, set it to <code>none</code>.
    Default is <code>none</code>.
</dl>

<dl id="optimization">
<dt><code>set optimization <i>option</i></code><br>
<dd>Optimize PF for one of the following network environments:
    <ul>
      <li><code>normal</code> - suitable for almost all networks.
      <li><code>high-latency</code> - high latency networks such as satellite
          connections.
      <li><code>aggressive</code> - aggressively expires connections from the
          state table.
          This can greatly reduce the memory requirements on a busy firewall
          at the risk of dropping idle connections early.
      <li><code>conservative</code> - extremely conservative settings.
          This avoids dropping idle connections at the expense of greater
          memory utilization and slightly increased processor utilization.
    </ul>
<dd>The default is <code>normal</code>.
</dl>

<dl id="ruleset-optimization">
<dt><code>set ruleset-optimization <i>option</i></code>
<dd>Control operation of the PF ruleset optimizer.
    <ul>
      <li><code>none</code> - disable the optimizer altogether.
      <li><code>basic</code> - enables the following ruleset optimizations:
        <ol>
          <li>remove duplicate rules
          <li>remove rules that are a subset of another rule
          <li>combine multiple rules into a table when advantageous
          <li>re-order the rules to improve evaluation performance
        </ol>
      <li><code>profile</code> - uses the currently loaded ruleset as a feedback
          profile to tailor the ordering of quick rules to actual network
          traffic.
    </ul>
<dd>Starting in OpenBSD 4.2, the default is <code>basic</code>.
See <a href="https://man.openbsd.org/pf.conf">pf.conf(5)</a> for a more complete
description.
</dl>

<dl id="skip">
<dt><code>set skip on <i>interface</i></code><br>
<dd>Skip <i>all</i> PF processing on <code><i>interface</i></code>.
    This can be useful on loopback interfaces where filtering, normalization,
    queueing, etc, are not required.
    This option can be used multiple times.
    By default, this option is not set.
</dl>

<dl id="state-policy">
<dt><code>set state-policy <i>option</i></code><br>
<dd>Sets PF's behavior when it comes to  keeping state.
    This behavior can be overridden on a per-rule basis.
    See <a href="filter.html#state">keeping state</a>.
    <ul>
      <li><code>if-bound</code> - states are bound to the interface they're
          created on.
          If traffic matches a state table entry but is not crossing the
          interface recorded in that state entry, the match is rejected.
          The packet must then match a filter rule or will be dropped/rejected
          altogether.
      <li><code>floating</code> - states can match packets on any interface.
          As long as the packet matches a state entry and is passing in the
          same direction as it was on the interface when the state was created,
          it does not matter what interface it's crossing.
          It will pass.
    </ul>
<dd>The default is <code>floating</code>.
</dl>

<dl id="timeout">
<dt><code>set timeout <i>option value</i></code><br>
<dd>Set various timeouts (in seconds).
    <ul>
      <li><code>interval</code> - seconds between purges of expired states and
          packet fragments.
          Default is <code>10</code>.
      <li><code>frag</code> - seconds before an unassembled fragment is expired.
          Default is <code>30</code>.
      <li><code>src.track</code> - seconds to keep a
          <a href="filter.html#stateopts">source tracking</a> entry in memory
          after the last state expires.
          Default is <code>0</code>.
    </ul>
</dl>

Example:

<pre class="cmdbox">
set timeout interval 10
set timeout frag 30
set limit { frags 5000, states 2500 }
set optimization high-latency
set block-policy return
set loginterface dc0
set fingerprints "/etc/pf.os.test"
set skip on lo0
set state-policy if-bound
</pre>
