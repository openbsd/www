<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF : Principes de Base</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003, 2004 Joel Knight <enabled@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif">
<p>
[<a href="index.html">Index</a>]
[<a href="macros.html">Suivant : Listes et Macros</a>]

<p>
<h1><font color="#e00000">PF : Principes de Base</font></h1>

<hr>

<h3>Table des Matières</h3>
<ul>
<li><a href="#activate">Activation</a>
<li><a href="#config">Configuration</a>
<li><a href="#control">Contrôle</a>
</ul>

<hr>

<a name="activate"></a>
<h2>Activation</h2>
Pour activer PF, éditez le fichier
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8&amp;manpath=OpenBSD+3.5"><tt>/etc/rc.conf</tt></a>
et modifiez la ligne PF comme suit :

<blockquote>
<tt>
pf=YES
</tt>
</blockquote>

<p>
Redémarrez votre système pour que les modifications soient prises en
compte.

<p>
Vous pouvez aussi activer et désactiver PF en utilisant le programme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5">pfctl(8)</a> :

<blockquote>
<tt>
# pfctl -e<br>
# pfctl -d
</tt>
</blockquote>

<p>
La première commande active PF (l'option "-e" correspond à "enable"). La
seconde commande désactive PF (l'option "-d" correspond à "disable").
Ces commandes ne causent pas le chargement d'une base de règles. Cette
dernière doit être chargée séparemment avant ou après l'activation de
PF.


<a name="config"></a>
<h2>Configuration</h2>
<p>
PF lit les règles de configuration à partir du fichier
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.5"><tt>/etc/pf.conf</tt></a>
au démarrage de la machine. Ces règles sont chargées au démarrage par
les
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8&amp;manpath=OpenBSD+3.5">scripts rc</a>.  
Il est à noter que
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+3.5"><tt>/etc/pf.conf</tt></a>
est le fichier par défaut chargé par ces scripts. C'est un fichier texte
chargé et interprété par
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5">pfctl(8)</a>
puis inséré dans
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4&amp;manpath=OpenBSD+3.5">pf(4)</a>.
Pour certaines applications, d'autres bases de règles peuvent être
chargées à partir de fichiers différents durant la phase de démarrage.
Comme n'importe quelle application Unix bien conçue, PF offre une grande
flexibilité.

<p>
Le fichier <tt>pf.conf</tt> est composé de sept parties :
<ul>
<li><b><a href="macros.html">Macros :</a></b> Variables définies par
    l'utilisateur pouvant contenir des adresses IP, des noms
    d'interfaces, etc.
<li><b><a href="tables.html">Tables :</a></b> Structures conçues pour
    contenir des listes d'adresses IP.
<li><b><a href="options.html">Options :</a></b> Diverses options pour
    contrôler le fonctionnement de PF.
<li><b><a href="scrub.html">Scrub :</a></b> Retraitement des paquets
    pour les normaliser et les défragmenter.
<li><b><a href="queueing.html">Gestion de La Bande Passante :</a></b>
    Gère la bande passante et la priorité des paquets.
<li><b><a href="nat.html">Traduction ("Translation") :</a></b> Contrôle
    la Traduction d'Adresses IP et <a href="rdr.html">la redirection de
    paquets</a>.
<li><b><a href="filter.html">Règles de Filtrage :</a></b> Permet le
    filtrage séléctif ou le bloquage des paquets lors de leur traversée
    de n'importe quelle interface.
</ul>

<p>
A l'exception des macros et des tables, chaque section doit apparaître
dans l'ordre précité dans le fichier de configuration. Cependant toutes
les sections ne sont pas obligatoires.

<p>
Les lignes vides sont ignorées et les lignes commençant par <tt>#</tt>
sont considérées comme des commentaires.

<a name="control"></a>
<h2>Contrôle</h2>
Après le démarrage, PF peut être contrôlé grâce au programme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5">pfctl(8)</a>.  Voici des exemples de commandes :

<pre>
     # pfctl -f /etc/pf.conf     <i>Charge le fichier pf.conf</i>
     # pfctl -nf /etc/pf.conf    <i>Analyse le fichier mais ne le charge pas</i>
     # pfctl -Nf /etc/pf.conf    <i>Charge uniquement les règles NAT à partir du fichier</i>
     # pfctl -Rf /etc/pf.conf    <i>Charge uniquement les règles de filtrage à partir du fichier</i>

     # pfctl -sn                 <i>Affiche les règles NAT actuelles</i> 
     # pfctl -sr                 <i>Affiche les règles de filtrage actuelles</i>
     # pfctl -ss                 <i>Affiche la table d'état actuelle</i>
     # pfctl -si                 <i>Affiche les statistiques et les compteurs de filtrage</i>
     # pfctl -sa                 <i>Affiche TOUT ce qu'on est capable d'afficher</i>
</pre>

<p>
Pour une liste complète de commandes, veuillez lire la
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.5">page du manuel pfctl(8)</a>.

<p>
[<a href="index.html">Index</a>]
[<a href="macros.html">Suivant : Listes et Macros</a>]

<p>
<hr>
<a href="index.html"><img alt="[back]" border="0" height="24" src="../../../images/back.gif" width="24"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: config.html,v 1.12 ]<br>
$Translation: config.html,v 1.12 2004/10/11 12:59:49 saad Exp $<br>
$OpenBSD: config.html,v 1.9 2004/10/11 16:17:48 jufi Exp $
</small>

</body>
</html> 
