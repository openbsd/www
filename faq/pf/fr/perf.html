<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF : Performances</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003, 2004, Nick Holland <nick@openbsd.org>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif">
<p>
[<a href="logging.html">Précédent : Journal des
Evénements</a>]
[<a href="index.html">Index</a>]
[<a href="ftp.html">Suivant : </a>]

<p>
<h1><font color="#e00000">PF : Performances</font></h1>
<hr>

<h3>
"Combien de bande passante PF peut-il gérer ?"<br>
"Quelle puissance machine est suffisante pour gérer mon
accès Internet ?" "How much computer do I need to handle my
Internet connection?" </h3>

<p>
Il n'y a pas de réponse facile à ces questions. Pour
certaines applications, un 486/66 avec une paire de bonnes cartes
réseau ISA pourrait filtrer et faire de la NAT à quelques
5Mbps, mais d'autres applications une machine beaucoup plus puissante
avec des cartes réseau PCI plus efficaces pourrait être
insuffisante. La vraie question n'est pas le nombre de bits par seconde
mais plutôt le nombre de paquets par seconde et la
complexité des jeux de règles.

<p>
Les performances de PF sont déterminées par plusieurs
variables :
<ul>
<li>Nombre de paquets par seconde. Pratiquement le même traitement
    doit être effectué sur une paquet avec une charge utile
    de 1400 octets que sur un paquet avec une charge utile d'un octet.
    Le nombre de paquets par seconde détermine le nombre de fois
    que la table d'état et, au cas où il n'y a pas de
    correspondance, les règles de filtrage doivent être
    évaluées chaque seconde, déterminant ainsi
    à quel point on sollicite le système.

<li>Performance du bus système. Le bus ISA a une bande passante
    maximale de 8MB/sec, et lorsque le processeur y accède, il
    doit diminuer sa vitesse à la vitesse effective d'un 80286
    cadencé à 8MHz, peu importe la vitesse réelle
    du processeur. Le bus PCI a une bande passante effective beaucoup
    plus grande et a moins d'impact sur le processeur.

<li>Efficacité de la carte réseau. Certaines cartes
    réseau sont plus efficaces que d'autres. Les cartes
    basées sur le Realtek 8139
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rl&amp;sektion=4&amp;manpath=OpenBSD+3.5">rl(4)</a>)
    ont tendance a avoir de faibles performances alors que les cartes
    basées sur l'Intel 21143
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dc&amp;sektion=4&amp;manpath=OpenBSD+3.5">dc(4)</a>)
    ont tendance à avoir d'excellentes performances. Pour des
    performances maximales, utilisez des cartes Ethernet gigabit
    même si vous ne vous connectez pas à des réseaux
    gigabit. Ces cartes ont une gestion de la mémoire tampon
    beaucoup plus avancée que les autres cartes.

<li>Complexité et conception de votre jeu de règles. Plus
    le jeu de règles est complexe, plus lent le pare-feu sera.
    Plus vous utiliserez des règles <tt>keep state</tt> et
    <tt>quick</tt> pour filtrer les paquets, meilleures les performances
    seront. Plus le nombre de lignes devant être
    évaluées pour chaque paquet, plus faibles seront les
    performances.

<li>Mentionnons quand même deux éléments : le CPU et
    la RAM. Vu que PF est un processus noyau, il n'utilisera pas
    d'espace de pagination (swap). Donc si vous avez suffisamment de
    RAM, il fonctionne sinon il se met en mode panique à cause de
    l'épuisement de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pool&amp;sektion=9&amp;manpath=OpenBSD+3.5">pool(9)</a>
    exhaustion. Des quantités énormes de RAM ne sont
    guère nécessaires. 32MB devraient permettre de
    contenir 30 000 états ce qui un nombre énorme pour des
    applications SoHo. La plupart des utilisateurs trouveront qu'une
    machine "recyclée" est plus que suffisante pour un
    système PF. Un système cadendé à 300MHz
    pourra gérer un très grand nombre de paquets
    rapidement, dans la mesure où il a des bonnes cartes
    réseau et un bon jeu de règles.
</ul>

<p>
Les utilisateurs demandent souvent des benchmarks PF. Le seul benchmark
qui compte vraiment est la performance de <i>votre</i> système
dans <i>votre</i> environnement. Un benchmark qui ne réplique pas
votre environnement ne vous aidera pas à planifier correctement
votre système pare-feu. La meilleure action possible est de
tester PF vous-même dans les mêmes conditions réseau
ou du moins dans les conditions les plus proches possibles que votre
pare-feu actuel sur le même matériel.

<p>
PF est utilisé dans certaines applications très
conséquentes et à haut trafic, et les développeurs
sont des "power users" de PF. Il y a donc beaucoup de chance pour que PF
fonctionne dans votre environnement avec des performances correctes.

<p>
[<a href="logging.html">Précédent : Journal des
Evénements</a>]
[<a href="index.html">Index</a>]
[<a href="ftp.html">Suivant : Gestion du Protocole FTP</a>]

<p>
<hr>
<a href="index.html"><img alt="[back]" border="0" height="24"
src="../../../images/back.gif" width="24"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: perf.html,v 1.14 ]<br>
$Translation: perf.html,v 1.10 2004/10/11 12:24:36 saad Exp $<br>
$OpenBSD: perf.html,v 1.10 2004/10/11 16:17:48 jufi Exp $
</small>

</body>
</html> 
