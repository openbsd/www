<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Listy i makra</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2002-2004 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif">
<p>
[<a href="config.html">Wstecz: Pierwsze kroki</a>]
[<a href="index.html">Spis tre¶ci</a>]
[<a href="tables.html">Dalej: Tabele</a>]

<h1><font color="#e00000">PF: Listy i makra</font></h1>
<hr>

<h3>Spis tre¶ci</h3>
<ul>
<li><a href="#lists">Listy</a>
<li><a href="#macros">Makra</a>
</ul>

<hr>

<a name="lists"></a>
<h2>Listy</h2>
Listy pozwalaj± na podawanie wielu podobnych kryteriów w jednej regule.
Na przyk³ad, wielu protoko³ów, numerów portów, adresów, itp.
Dziêki temu, zamiast pisaæ regu³ê filtruj±c± dla ka¿dego adresu IP, który
ma byæ blokowany, mo¿na zapisaæ te adresy IP w postaci listy. Listy
s± definiowane poprzez wymienienie elementów w nawiasach
klamrowych (<tt>{ }</tt>).

<p>
Gdy
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8&amp;manpath=OpenBSD+3.4"
>pfctl(8)</a> napotyka listê podczas ³adowania zestawu regu³, tworzy
wiele regu³ek, po jednej dla ka¿dego elementu z listy. Na przyk³ad:
<blockquote>
<tt>
block out on fxp0 from { 192.168.0.1, 10.5.32.6 } to any
</tt>
</blockquote>

<p>
jest rozwijane do:
<blockquote>
<tt>
block out on fxp0 from 192.168.0.1 to any<br>
block out on fxp0 from 10.5.32.6 to any
</tt>
</blockquote>

<p>
Wiele list mo¿e byæ wyspecyfikowanych w jednej regule. Listy nie s±
ograniczone jedynie do regu³ filtruj±cych:
<blockquote>
<tt>
rdr on fxp0 proto tcp from any to any port { 22 80 } -&gt; \<br>
&nbsp;&nbsp;&nbsp;192.168.0.6<br>
block out on fxp0 proto { tcp udp } from { 192.168.0.1, \<br> 
&nbsp;&nbsp;&nbsp;10.5.32.6 } to any port { ssh telnet }
</tt>
</blockquote>

<p>
Zwróæ uwagê, ¿e przecinki pomiêdzy elementami list s± opcjonalne.

<a name="macros"></a>
<h2>Makra</h2>
Makra s± definiowanymi przez u¿ytkownika zmiennymi które mog± przechowywaæ
adresy IP, numery portów, nazwy interfejsów sieciowych, itp. Makra mog±
ograniczyæ komplikacjê zestawu regu³ PF, a tak¿e powoduj±, ¿e wprowadzanie
zmian jest znacznie prostsze.

<p>
Nazwy makr musz± zaczynaæ siê od litery i mog± zawieraæ: litery, cyfry oraz
podkre¶lniki. Nazwy makr nie mog± byæ zarezerwowanymi s³owami, takimi jak
<tt>pass</tt>, <tt>out</tt>, <tt>queue</tt>, itp.
<blockquote>
<tt>
ext_if = "fxp0"<br>
<br>
block in on $ext_if from any to any<br>
</tt>
</blockquote>

<p>
W tym przyk³adzie utworzono makro <tt>ext_if</tt>. Gdy odwo³uje siê do makra
po jego zdefiniowaniu, robi siê to poprzedzaj±c jego nazwê znakiem <tt>$</tt>.

<p>
Makra mog± byæ tak¿e listami, jak np:
<blockquote>
<tt>
friends = "{ 192.168.1.1, 10.0.2.5, 192.168.43.53 }"
</tt>
</blockquote>

<p>
Makra mog± byæ definiowane rekursywnie. Poniewa¿ makra nie s± rozszerzane
pomiêdzy nawiasami, stosuje siê nastêpuj±c± sk³adniê:
<blockquote>
<tt>
host1      = "192.168.1.1"<br>
host2      = "192.168.1.2"<br>
all_hosts  = "{" $host1 $host2 "}"<br>
</tt>
</blockquote>

<p>
Makro <tt>$all_hosts</tt> jest teraz rozszerzane do 192.168.1.1, 192.168.1.2.

<p>
[<a href="config.html">Wstecz: Pierwsze kroki</a>]
[<a href="index.html">Spis tre¶ci</a>]
[<a href="tables.html">Dalej: Tabele</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[wstecz]"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: macros.html,v 1.9 ]<br>
$Translation: macros.html,v 1.5 2004/01/12 17:37:45 pl-team Exp $<br>
$OpenBSD: macros.html,v 1.5 2004/01/16 21:01:34 jufi Exp $
</small>
</body>
</html> 
