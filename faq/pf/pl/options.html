<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>PF: Opcje w czasie dzia³ania</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq,pf">
<meta name="distribution"  content="global">
</head>

<!--
Copyright (c) 2003-2007 Joel Knight <enabled@myrealbox.com>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">
<!-- Passes validator.w3.org, please keep it this way;
please, use a max of 72 chars per line -->

<a href="../../../pl/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../../images/smalltitle.gif" border="0">
</a>
<p>
[<a href="shortcuts.html">Wstecz: Skracanie zestawów regu³</a>]
[<a href="index.html">Spis tre¶ci</a>]
[<a href="scrub.html">Dalej: Scrub (normalizacja pakietów)</a>]

<p>
<h1><font color="#e00000">PF: Opcje w czasie dzia³ania</font></h1>

<hr>

<p>
Opcje s± wykorzystywane do kontroli pracy PF. S± one specyfikowane w
<tt>pf.conf</tt> przy pomocy dyrektywy <tt>set</tt>.

<p>
<b><font color="#ff0000">Uwaga:</font></b> 
W OpenBSD 3.7 i po¼niejszych, zachowanie opcji
startowych uleg³o zmianie.
Poprzednio, gdy opcja zosta³a ustawiona nie by³a resetowana
do warto¶ci domy¶lnej, nawet je¶li zestaw regu³ by³ prze³adowywany.
Pocz±wszy od OpenBSD 3.7, ilekroæ ³adowany jest zestaw regu³, opcje
startowe s± resetowane do warto¶ci domy¶lnych przed parsowaniem regu³.
Zatem, je¿eli opcja jest ustawiona i pó¼niej usuniêta z regu³, a nastêpnie
regu³y prze³adowano, opcja ta zostanie zresetowana do warto¶ci domy¶lnej.


<a name="block-policy"></a>
<p>
<dl>
<dt><tt>set block-policy <i>opcja</i></tt><br>
<dd>Ustala domy¶ln± akcjê dla regu³ <a href="filter.html">filtruj±cych</a>
<tt>block</tt> w przypadku odrzucenia pakietu.
<ul>
<li><tt>drop</tt> - pakiet jest porzucany (dropped).
<li><tt>return</tt> - wysy³a TCP RST przy blokowaniu pakietów TCP,
ICMP Unreachable (nieosi±galny) dla wszystkich pozosta³ych pakietów.
</ul>
<dd>Warto zauwa¿yæ, ¿e indywidualne regu³y filtruj±ce mog± wymuszaæ inne ni¿
domy¶lne zachowanie.
Warto¶ci± domy¶ln± jest <tt>drop</tt>
</dl>

<a name="debug"></a>
<p>
<dl>
<dt><tt>set debug <i>opcja</i></tt><br>
<dd>Ustaw poziom komunikatów o b³êdach.
<ul>
<li><tt>none</tt> - brak komunikatów o b³êdach.
<li><tt>urgent</tt> - wy¶wietlaj komunikaty o powa¿nych b³êdach.
<li><tt>misc</tt> - wy¶wietlaj komunikaty o ró¿nych b³êdach (np
powiadamiaj o statusie normalizacji/scrubber`a dla pakietów oraz
b³êdów podczas ustanawiania po³±czeñ stanowych).
<li><tt>loud</tt> - wy¶wietlaj komunikaty dla typowych dzia³añ
(np powiadamiaj o statusie pasywnego rozpoznawania systemów operacyjnych
[ang. OS fingerprinter]).
</ul>
<dd>Domy¶lnie jest <tt>urgent</tt>.
</dl>

<a name="fingerprints"></a>
<p>
<dl>
<dt><tt>set fingerprints <i>file</i></tt><br>
<dd>Ustawia plik z którego maj± zostaæ pobrane sygnatury systemów operacyjnych
wykorzystywane przy <a href="filter.html#osfp">pasywnym rozpoznawaniu systemów
operacyjnych</a>.
Domy¶lnie jest to <tt>/etc/pf.os</tt>.
</dl>

<a name="limit"></a>
<p>
<dl>
<dt><tt>set limit <i>option value</i></tt><br>
<dd>Ustawia ró¿ne limity na operacje PF'a.
<ul>
<li><tt>frags</tt> - maksymalna liczba wpisów w puli pamiêci (ang.
    memory pool) wykorzystywanych do defragmentacji pakietów (regu³y
    <a href="scrub.html">scrub</a>). Domy¶lnie jest to 5000.

<li><tt>src-nodes</tt> - maksymalna liczba wpisów w puli pamiêci
    wykorzystywanych do ¶ledzenia ¼ród³owych adresów IP (generowanych przez 
    opcje <tt>sticky-address</tt> i <tt>source-track</tt>).
    Domy¶lnie jest to 10000.

<li><tt>states</tt> - maksymalna liczba wpisów w puli pamiêci
    wykorzystywanych przez wpisy tabeli stanów (regu³y
    <a href="filter.html">filtruj±ce</a>, które zawieraj± opcje
    <tt>keep state</tt>). Domy¶lnie jest to 10000.

<li><tt>tables</tt> - maksymalna liczba
    <a href="tables.html">tablic</a> które mo¿na utworzyæ.
    Domy¶lnie jest to 1000.

<li><tt>table-entries</tt> - górny limit liczby adresów jakie mog±
    byæ przechowywane we wszystkich tablicach.
    Domyslnie jest to 200000.
    Je¿eli system posiada mniej ni¿ 100MB pamiêci fizycznej, warto¶æ
    domy¶lna ustawiana jest na 100000.
</ul>
</dl>

<a name="loginterface"></a>
<p>
<dl>
<dt><tt>set loginterface <i>interfejs</i></tt><br>
<dd>Ustaw interfejs sieciowy, dla którego PF powinno zbieraæ statystyki takie
jak ilo¶æ wys³anych/odebranych bajtów, liczba przepuszczonych/zablokowanych
pakietów, itp. Statystyki mog± byæ zbierane tylko dla <i>jednego</i> interfejsu
na raz. Proszê zwróciæ uwagê na fakt, ¿e liczniki <tt>match</tt>,
<tt>bad-offset</tt>, itp, oraz liczniki tabeli stanów s± ca³y czas aktywne bez
wzglêdu na to, czy opcja <tt>loginterface</tt> jest ustawiona, czy nie.
Aby wy³±czyæ t± opcjê, ustaw j± na <tt>none</tt>.
Warto¶ci± domy¶ln± jest <tt>none</tt>.
</dl>

<a name="optimization"></a>
<p>
<dl>
<dt><tt>set optimization <i>option</i></tt><br>
<dd>Optymalizacja PF dla jednego z nastêpuj±cych ¶rodowisk sieciowych:
<ul>
<li><tt>normal</tt> - w³a¶ciwe dla prawie wszystkich sieci.
<li><tt>high-latency</tt> - ¶rodowisko z du¿ymi opó¼nieniami
(takie jak po³±czenia satelitarne).
<li><tt>aggressive</tt> - agresywnego przeterminowywana po³±czeñ w tabeli
stanów. Powoduje to ogóln± redukcje zu¿ycia pamiêci na obci±¿onych
firewallach kosztem ryzyka zbyt wczesnego porzucania nawi±zanych po³±czeñ.
<li><tt>conservative</tt> -  bardzo zachowawcze ustawienie, zapobiegaj±ce
zrywaniu nawi±zanych po³±czeñ kosztem wiêkszego zu¿ycia pamiêci i przy
nieznacznym wzro¶cie wykorzystania procesora.
</ul>
<dd>Warto¶ci± domy¶ln± jest <tt>normal</tt>.
</dl>

<a name="ruleset-optimization"></a>
<p>
<dl>
<dt><tt>set ruleset-optimization <i>option</i></tt>
<dd>Kontroluje dzia³anie mechanizmu optymalizacji zestawu regu³ PF.
<ul>
<li><tt>none</tt> - wy³±cza ca³kowicie optymalizacjê.

<li><tt>basic</tt> - w³±cz± poni¿sze optymalizacje zestawu regu³:
    <ol>
    <li>usuwanie zduplikowanych regu³
    <li>usuwa regu³y które stanowi± fragmenty innej regu³y
    <li>³±czy wiele regu³ w tabelê gdy jest to korzystne
    <li>zmienia kolejno¶æ regu³ aby zwiêkszyæ wydajno¶æ klasyfikacji
    </ol>

<li><tt>profile</tt> - uzywa obecnie za³adowanych regu³ jako profil
odniesienia do uporz±dkowania regu³ "quick" w zale¿no¶ci od ruchu sieciowego.

</ul>
<dd>Od wersji OpenBSD 4.2 domy¶lnie u¿ywane jest <tt>basic</tt>.
Bardziej szczegó³owy opis znajdziesz na stronie manuala
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5&amp;manpath=OpenBSD+4.2"
>pf.conf(5)</a>.
</dl>

<a name="skip"></a>
<p>
<dl>
<dt><tt>set skip on <i>interfejs</i></tt><br>
<dd>Opuszcza <i>wszystkie</i> procedury PF dla zadanego <tt><i>interfejsu</i></tt>.
Mo¿e byæ przydatne dla interfejsu loopback dla ktorego filtrowanie,
normalizacja, kolejkowanie, itd., nie jest wymagane.
Opcja ta mo¿e byæ u¿ywana wielokrotnie.
Domy¶lnie nie jest ona ustawiona.
</dl>

<a name="state-policy"></a>
<p>
<dl>
<dt><tt>set state-policy <i>opcja</i></tt><br>
<dd>Okre¶la domy¶lne zachowanie PF odno¶nie ¶ledzenia stanów.
Oczywi¶cie, mo¿na je nadal okre¶liæ dla poszczególnych regu³ indywidualnie. 
Zobacz tak¿e <a href="filter.html#state">¦ledzenie stanów</a>.
<ul>
<li><tt>if-bound</tt> - stany s± dowi±zywane do interfejsów
na których je stworzono.
Je¶li ruch pasuje do wpisów w tabeli stanów, ale przechodzi przez
inny interfejs sieciowy ni¿ zapisany w tabeli stanów, jest odrzucany.
Pakiet musi pasowaæ do innej regu³y lub zostanie porzucony i zablokowany
jednocze¶nie.
<li><tt>group-bound</tt> - podobne zachowanie do <tt>if-bound</tt>
z tym wyj±tkiem, ¿e pakiety mog± przechodziæ przez ró¿ne interfejsy w obrêbie
tej samej grupy, np wszystkich interfejsów <tt>ppp</tt> itp.
<li><tt>floating</tt> - stany mog± pasowaæ do pakietów na dowolnym
interfejsie.

Tak d³ugo jak pakiet pasuje do wpisu w tabeli stanów i przechodzi w tym
samym kierunku w jakim przechodzi³ kiedy stan zosta³ wygenerowany, nie ma
znaczenia na przez jaki interfejs przechodzi, zostanie przepuszczony.
</ul>
<dd>Opcja domy¶lna to <tt>floating</tt>.
</dl>

<a name="timeout"></a>
<p>
<dl>
<dt><tt>set timeout <i>option value</i></tt><br>
<dd>Ustawia ró¿ne timeout'y (w sekundach).
<ul>
<li><tt>interval</tt> - odstêp czasu (w sekundach) pomiêdzy usuniêciem
wygas³ych stanów i fragmentów.
Warto¶ci± domy¶ln± jest <tt>10</tt>.
<li><tt>frag</tt> - ilo¶æ sekund, po których niez³o¿one fragmenty trac± wa¿no¶æ.
Warto¶ci± domy¶ln± jest <tt>30</tt>.


<li><tt>src.track</tt> - ilo¶æ sekund do przetrzymania wpisu
<a href="filter.html#stateopts">source tracking</a> w pamiêci
po tym jak przedawni siê ostatni stan.
Warto¶ci± domy¶ln± jest <tt>0</tt> (zero).
</ul>
</dl>

<p>
Przyk³ad:
<p>
<table border=0 width="650">
<tr><td nowrap bgcolor="#EEEEEE">
<pre>
set timeout interval 10
set timeout frag 30
set limit { frags 5000, states 2500 }
set optimization high-latency
set block-policy return
set loginterface dc0
set fingerprints "/etc/pf.os.test"
set skip on lo0
set state-policy if-bound
</pre>
</td></tr>
</table>


<p>
[<a href="shortcuts.html">Wstecz: Skracanie zestawów regu³</a>]
[<a href="index.html">Spis tre¶ci</a>]
[<a href="scrub.html">Dalej: Scrub (normalizacja pakietów)</a>]

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../../images/back.gif" border="0" alt="[wstecz]"></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: options.html,v 1.17 ]<br>
$Translation: options.html,v 1.16 2007/11/03 10:20:39 tkniaz Exp $<br>
-->
$OpenBSD: options.html,v 1.16 2007/11/12 20:29:59 saad Exp $
</small>
</body>
</html> 
