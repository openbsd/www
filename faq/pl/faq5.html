<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>5 - Tworzenie systemu ze ¼róde³</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-2">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2005 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<!-- Passes validator.w3.org.  Please keep it this way -->

<a href="../../pl/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    
</a>
<p>
<font color= "#0000e0">
<a href= "index.html">[Spis tre¶ci]</a>
<a href= "faq4.html">[Sekcja 4 - Instalacja OpenBSD]</a>
<a href= "faq6.html">[Sekcja 6 - Sieæ]</a>
</font>

<h1><font color="#e00000">5 - Tworzenie systemu ze ¼róde³</font></h1>

<!--
UNCOMMENT ONLY WHEN THE FILE IS OUT OF SYNC

<hr>
<p>
<b><font color="#e00000">Uwaga:</font></b>Zawarto¶æ tego pliku
jest ju¿ bardzo nieaktualna w stosunku do
<a href="../faq5.html">bie¿±cej wersji anglojêzycznej</a>.

<p>
Je¶li chcesz pomóc w aktualizacji tego pliku, zajrzyj na
<a href="../../translation.html">stronê t³umaczeñ</a>.
-->

<hr>

<p>
<h3>Spis tre¶ci</h3>
<ul>
<li><a href= "#Flavors">5.1 - W±tki OpenBSD</a>
<li><a href= "#WhySrc">5.2 - Dlaczego potrzebujê systemu zbudowanego ze ¼róde³?</a>
<li><a href= "#Bld">5.3 - Tworzenie OpenBSD ze ¼róde³</a>
<ul>
<li><a href= "#BldOverview">5.3.1 - Wprowadzenie</a>
<li><a href= "#BldBinary">5.3.2 - Instalacja lub uaktualnienie do najbli¿szej
    dostêpnej wersji binarnej</a>
<li><a href="#BldGetSrc">5.3.3 - Pobieranie odpowiedniego kodu 
¼ród³owego</a>
<li><a href="#BldKernel">5.3.4 - Tworzenie j±dra</a>
<li><a href="#BldUserland">5.3.5 - Tworzenie przestrzeni u¿ytkownika</a>
</ul>
<li><a href="#Release">5.4 - Tworzenie wydania</a>
<li><a href="#Xbld">5.5 - Tworzenie Xów</a>
<li><a href="#Why">5.6 - Dlaczego potrzebuje w³asnego j±dra?</a>
<li><a href="#Options">5.7 - Tworzenie w³asnego j±dra</a>
<li><a href="#BootConfig">5.8 - Konfiguracja kernela podczas startu 
systemu</a>
<li><a href="#config">5.9 - Zastosowanie config(8) do zmian w skompilowanym
j±drze</a>
<li><a href="#VerboseBoot">5.10 - Otrzymywanie dok³adniejszych informacji podczas                                                                
startu systemu</a>
<li><a href="#buildprobs">5.11 - Typowe problemy, sztuczki i pytania
zwi±zane z kompilacj± i tworzeniem ze ¼róde³</a>
<ul>
<li><a href="#sig11">5.11.1 - Tworzenie zatrzymane przez b³±d "Signal 11"</a>
<li><a href="#snake">5.11.2 - Instrukcja "make build" przerwana komunikatem "cannot open output
     file snake: is a directory"</a> 
<li><a href="#ProbIPv6">5.11.3 - Mój system nie dzia³a bez IPv6!</a>
<li><a href="#ProbObj">5.11.4 - Oops! Zapomnia³em stworzyæ katalogu 
<tt>/usr/obj</tt>!</a>
<li><a href="#ProbObjPt">5.11.5 - Umieszczanie <tt>/usr/obj</tt> na jego w³asnej partycji</a>
<li><a href="#ProbSKIPDIR">5.11.6 - W jaki sposób mogê nie tworzyæ czê¶ci drzewa ¼róde³?</a>
<li><a href="#ProbMoreInfo">5.11.7 - Gdzie mogê siê dowiedzieæ wiêcej na temat procesu
tworzenia ze ¼róde³?</a>
<li><a href="#NoSnaps">5.11.8 - Nie widzê ¿adnej wersji snapshot w FTP. Gdzie siê podzia³y?</a>
<li><a href="#NewCompiler">5.11.9 - W jaki sposób mogê za³adowaæ nowsz± wersjê kompilatora (<i>gcc</i>)?</a>
<li><a href="#UpdateEtc">5.11.10 - Jaka jest najlepsza metoda uaktualnienia
<tt>/etc</tt>, <tt>/var</tt>, oraz <tt>/dev</tt>?</a>
<li><a href="#Hierarchy">5.11.11 - Czy istnieje jaka¶ prosta droga do stworzenia wszystkich zmian w hierarchii plików?</a>
</ul>
</ul>
<hr>
<br>

<a name="Flavors"></a>
<h2>5.1 - W±tki OpenBSD</h2>
<!-- XXXversion - revise doodle -->
OpenBSD wystêpuje w trzech "w±tkach":
<ul>
<li><b>-release:</b> Wersja OpenBSD publikowana co sze¶æ miesiêcy na CD.
<li><b>-stable:</b>  Wersja 'Release', wraz z ³atami (ang. patches) naprawiaj±cymi krytyczne dla bezpieczeñstwa i wydajno¶ci
    elementy systemu.
<li><b>-current:</b> Najaktualniejsza (chwilowa) wersja OpenBSD, która
    przekszta³ci siê w nastêpne wydanie 'Release'.
</ul>

Graficznie, rozwój tych w±tków wygl±da
tak:

<blockquote>
<pre>
       ,------o-----------o----X                    3.4 Stable
       |      .           .
       |      .    ,------o---------o----X          3.5 Stable
       |      .    |      .         .
       |      .    |      .    ,----o----------o--&gt; 3.6 Stable
       |      .    |      .    |    .          .
       |      .    |      .    |    .    ,-----o--&gt; 3.7 Stable
       |      .    |      .    |    .    |     .
       |      .    |      .    |    .    |     .
 --&gt;3.4Rel-----&gt;3.5Rel-----&gt;3.6Rel-----&gt;3.7Rel----&gt; Current 

          Time ---&gt;

</pre>
</blockquote>

<p>
<i>-Current</i> to stan w którym prowadzone s± aktywnie prace, i 
przeradza siê w nastêpn± wersjê <i>-release</i> OpenBSD.

Co sze¶æ miesiêcy, kiedy wydawana jest nowa wersja OpenBSD, <i>-current</i>
jest oznaczane, i staje siê <i>-release</i>: zamro¿onym punktem w 
historii drzewa ¼ród³owego.
Ka¿da wersja <i>-release</i> nie jest nigdy zmieniana: one w³a¶nie s±
dostêpne na <a href="../orders.html">CD</a> i 
<a href="../ftp.html">serwerach FTP</a>. 

Wersja <i>-stable</i> oparta jest na <i>-release</i>, i jest odga³êzieniem
g³ównej ¶cie¿ki rozwoju OpenBSD. Jest znana tak¿e pod nazw± <i>paczkowej 
ga³êzi</i>. 
Gdy wa¿ne poprawki s± wprowadzane do wersji <i>-current</i>, s± 
w³±czane do odga³êzienia <i>-stable</i>.
W powy¿szej ilustacji, pionowe wykropkowane linie oznaczaj± uaktualnienia,
które s± w³±czane do ga³êzi <i>-stable</i>. W powy¿szym
przyk³adzie mo¿na zauwa¿yæ, ¿e ga³±¼ <i>3.4-stable</i> koñczy siê wraz
z ukazaniem siê <i>3.6-release</i>, oraz <i>3.5-stable</i> koñczy siê
w momencie utworzenia <i>3.7-release</i> -- starsze wersje s± standardowo
wspierane a¿ do dwóch wydañ wstecz.
Wspieranie starszych wersji jest czynno¶ci± wymagaj±c± wysi³ku i czasu,
i dlatego w czasie, kiedy mogliby¶my usprawniaæ starsze wydania, wolimy
skupiæ siê na rozwijaniu nowych funkcji systemu. Ga³±¼ <i>-stable</i> jest,
z za³o¿enia, bardzo prosta do utworzenia z <i>-release</i> tej samej wersji
(np., przej¶cie z <i>3.7-release</i> do <i>3.7-stable</i>).

<p>
Ga³±¼ <i>-stable</i> sk³ada siê z <i>-release</i> i ³atek (ang. patches),
które s± umieszczane na
<a href="../../errata.html">stronie z poprawkami</a>, oraz z kilku prostych
usprawnieñ, nie wchodz±cych w zakres poprawek.
Zwykle dzia³anie <i>-stable</i> jest
identyczne jak <i>-release</i> na której bazuje. Je¶li zmianie ulegn±
<a href="http://www.openbsd.org/cgi-bin/man.cgi">podrêczniki man</a>,
to prawdopodobnie nie zostanie to uwzglêdnione w <i>-stable</i>. Innymi 
s³owy, wsparcie dla nowego urz±dzenia NIE bêdzie dodane do <i>-stable</i>, 
podobnie nowa cecha systemu rzadko kiedy bêdzie dodana, chyba ¿e zostanie
uznana za bardzo wa¿n±.

<p>
Warte uwagi jest, ¿e nazwa "<i>-stable</i>" w zamierzeniu nie implikuje 
niestabilno¶ci wersji <i>-current</i>.
Co wiêcej, <i>-current</i> zmienia siê i rozwija, tymczasem dzia³ania na
<i>-stable</i> nie s± zamierzone na zmiany, zatem nie powinno byæ potrzebne
ponowne uczenie siê systemu lub zmiany plików konfiguracyjnych.
W rzeczywisto¶ci, jako ¿e naszym zamierzeniem jest ci±gle ulepszaæ 
OpenBSD, mo¿esz stwierdziæ ¿e <i>-current</i> jest lepszy dla ciebie
ni¿ <i>-stable</i>.

<p>
Ostrze¿enie: <i>-current</i> jest "uciekaj±cym celem". 
Zmienia siê z minuty na minutê, i mo¿e ulec wielu zmianom zanim 
uka¿e siê w postaci kodu ¼ród³owego. 
Chocia¿ developerzy ciê¿ko pracuj± by mieæ pewno¶æ ¿e system zawsze siê
skompiluje oraz ¿e nie zawiera ¿adnych powa¿nych b³êdów, jest zupe³nie
mo¿liw± sytuacja w której pobranie ¼róde³ <i>-current</i> nie zakoñczy
siê poprawn± kompilacj±, tymczasem piêæ minut pó¼niej wszystko bêdzie 
zupe³nie w porz±dku. 
S± tak¿e oznaczone dni i zmiany w g³ównym systemie, gdy developerzy
korzystaj± z jednorazowych narzêdzi, co oznacza ¿e uaktualnienia
ze ¼róde³ nie bêd± mo¿liwe.
<b>Je¿eli nie jeste¶ gotowy by siê na to godziæ, trzymaj siê z dala od
<i>-current</i>.</b>

<p>
Wiêkszo¶æ u¿ytkowników powinna korzystaæ z <i>-stable</i> lub <i>-release</i>.
Jak ju¿ zaznaczyli¶my, wielu ludzi korzysta z <i>-current</i> **on production
systems**. Jest to bardzo wa¿ne, ¿e jest kto¶ kto to robi, aby zidentyfikowaæ b³êdy i
przetestowaæ nowe funkcje. Jednak je¶li nie wiesz, jak prawid³owo opisaæ,
zdiagnozowaæ i poradziæ sobie z problemem, nie mów sobie (ani komukolwiek innemu),
¿e "pomagasz w projekcie" poprzez uruchamianie wersji <i>-current</i>.  "To
nie dzia³a!" nie jest <a href="../../pl/report.html#bugtypes">u¿ytecznym
raportem o b³êdach.</a>.  "Ostatnie zmiany w sterowniku pciide przerwa³y ich
kompatybilno¶æ z moim interfejsem IDE opartym na uk³adzie Slug.
Przesy³am dmesg dzia³aj±cego i uszkodzonego systemu..."
mo¿e byæ u¿ytecznym raportem.

<p>
Zdarzaj± siê przypadki, w których "zwykli" u¿ytkownicy chc± byæ na
bie¿±co i korzystaj± z <i>-current</i>. Najczêstsz± przyczyn± jest przypadek, kiedy u¿ytkownik
posiada urz±dzenie,
które nie jest wspierane przez <i>-release</i> (tak wiêc równie¿ niewspierane przez <i>-stable</i>),
lub chce korzystaæ z nowych udogodnieñ wersji <i>-current</i>. W tym przypadku,
wybór mo¿e byæ pomiêdzy <i>-current</i> lub nie korzystaniem z urz±dzenia, i
<i>-current</i> bêdzie mniejszym z³em. Jednak¿e u¿ytkownik nie powinien wówczas oczekiwaæ
pomocy od twórców systemu.

<h3>Snapshoty</h3>
Pomiêdzy kolejnymi oficjalnymi wydaniami OpenBSD, tworzone s± 
<i>snapshoty</i> -- chwilowe wersje obrazuj±ce dokonuj±ce siê przemiany
-- dostêpne na <a href="../../ftp.html">FTP</a>. Jak sama nazwa wskazuje,
s± to skompilowane wersje kodu, który znajdowa³ siê w drzewie ¼róde³ 
danej platformy sprzêtowej, w momencie skopiowania.
Nale¿y pamiêtaæ, ¿e dla niektórych platform, czas pomiêdzy kolejnymi 
"snapshotami" mo¿e wynosiæ wiele DNI, nim zostanie udostêpniony. 
Niestety nikt nie obiecuje, ¿e "snapshoty" s± ca³owicie funkcjonalne, 
a nawet ¿e mo¿na je zainstalowaæ. Czêsto stworzenie
"snapshota" jest spowodowane zmian±, która wymaga testowania. Niektóre
platformy maj± tworzone "snapshoty" prawie codziennie, inne
o wiele rzadziej. Je¶li pragniesz korzystaæ z <i>-current</i>, najnowszy
"snapshot" bêdzie zwykle tym, czego potrzebujesz, dlatego instalacja "
snapshota" jest zwykle dobrym punktem startu przed prób± samodzielnej 
kompilacji <i>-current</i> ze ¼róde³.

<p>
Czasem pada pytanie, czy jest jaka¶ mo¿liwo¶æ otrzymania kopii ¼róde³
kodu, który zosta³ u¿yty do stworzenia "snapshota". Odpowied¼ brzmi nie. 
Po pierwsze, nie ma z tego ¿adnej znacz±cej korzy¶ci. Po drugie, 
"snapshoty" s± tworzone kiedy jest ochota, czas pozwala i s± dostêpne 
niezbêdne zasoby.  Na szybkich platformach mo¿liwe jest tworzenie kilku 
"snapshotów" dziennie. Na wolniejszych, mo¿e to zaj±æ tydzieñ lub d³u¿ej, 
aby go stworzyæ. Wykonywanie etykiet (ang. tag) b±d¼ zak³adek w kodzie ¼ród³owym 
drzewa dla ka¿dego "snapshota" by³oby do¶æ niepraktyczne.

<h3>Utrzymywanie zgodno¶ci pomiêdzy elementami systemu</h3>
Wa¿ne jest zrozumienie, i¿ OpenBSD jest systemem operacyjnym, który powinien byæ
traktowany jako ca³o¶æ, a nie jako j±dro wraz z do³±czon± grup± narzêdzi.
Musisz byæ pewny, ¿e j±dro, "userland" (do³±czone
narzêdzia i pliki) i drzewo <a href="../../pl/ports.html"><tt>oprogramowania "ports"</tt></a>
s± ze sob± zgodne, bo je¶li nie mog± wyst±piæ nieoczekiwane k³opoty. Mówi±c innymi s³owy
(poniewa¿ ludzie pope³niaj± b³êdy), nie mo¿esz korzystaæ z naj¶wie¿szego drzewa
<tt>portów</tt> na systemie sprzed miesi±ca, lub przekompilowaæ j±dro ze ¼róde³ <i>-current</i>
i spodziewaæ siê, ¿e bêdzie ono funkcjonowaæ z oprogramowaniem pochodz±cym z <i>-release</i>. Tak,
to oznacza, ¿e musisz uaktualniaæ ca³y swój system, je¶li chcesz korzystaæ z nowego
programu, który zosta³ w³a¶nie dzisiaj dodany do drzewa portów. Przepraszamy,
powtórzymy to jeszcze raz, OpenBSD ma ograniczone zasoby.

<p>
Warto równie¿ pamiêtaæ, ¿e uaktualnienie
jest mo¿liwe <b>tylko w jednym kierunku: ze starszej do nowszej wersji</b>,
czyli ze <i>-stable</i> do <i>-current</i>. Nie mo¿esz korzystaæ z
<i>3.7-current</i> (lub snapshota), nastêpnie stwierdzaj±c, ¿e jeste¶ nara¿ony na zbyt du¿y
stres, chcesz wykonaæ krok w ty³ do <i>3.7-stable</i>. Jeste¶ pozostawiony sam sobie, je¶li
wybierzesz jak±kolwiek inn± ¶cie¿kê, ni¿ ta która jest wspierana, i nie spodziewaj siê, ¿e
ktokolwiek z twórców OpenBSD bêdzie Ci pomaga³ podczas przywracania uszkodzonego
systemu.

<p>
Chodzi o to, aby siê powa¿nie zastanowi³, zanim zaczniesz
korzystaæ z <i>-current</i>.

<a name="WhySrc"></a>
<h2>5.2 - Dlaczego potrzebujê systemu zbudowanego ze ¼róde³?</h2>
W³a¶ciwie, jest bardzo prawdopodobne ¿e nie potrzebujesz.

<p>
Kilka powodów dlaczego NIE budowaæ ze ¼róde³:

<ul>
<li>Kompilacja w³asnego systemu jako droga do uaktualnienia nie jest wspierana.
<li>NIE uzyskasz lepszej wydajno¶ci systemu poprzez zbudowanie go ze ¼róde³.
<li>Zmiany opcji kompilatora mog± bardziej zepsuæ twój system ni¿ go udoskonaliæ.
</ul>

Kilka powodów dlaczego mo¿esz chcieæ lub potrzebowaæ uaktualnienia systemu
ze ¼róde³:

<ul>
<li>Testy lub rozwijanie nowych funkcji.
<li>Kompilacja systemu powoduje spore obci±¿enie komputera, mo¿e byæ
to droga do sprawdzenia czy system który w³a¶nie z³o¿y³e¶ lub naby³e¶
jest faktycznie w ca³kiem dobrej kondycji.
<li>Chcesz pod±¿aæ za <a href="../stable.html">odga³êzieniem -stable.</a>
<li>Potrzebujesz wysoce dostosowanej wersji OpenBSD dla specjalnego
oprogramowania.
</ul>

<p>
Zespó³ OpenBSD bardzo regularnie umieszcza nowe snapshoty oparte na 
kodzie <i>-current</i> dla wszystkich platform.
To jest w³a¶ciwie wszystko czego mo¿esz potrzebowaæ do uruchomienia <i>-current</i>.

<p> 
Najczêstszym powodem do budowy systemu ze ¼róde³ jest chêæ pod±¿ania za
ga³êzi± <i>-stable</i>, gdzie budowa ze ¼róde³ jest jedyn± dostêpn± opcj±.


<a name="Bld"></a>
<h2>5.3 - Budowa OpenBSD ze ¼róde³</h2>

<a name="BldOverview"></a>
<h3>5.3.1 - Wprowadzenie</h3>

Budowanie OpenBSD ze ¼róde³ poci±ga za sob± kilka kroków:
<ul>
<li><a href="#BldBinary">Uaktualnienie do najnowszej dostêpnej wersji binarnej.</a>
<li><a href="#BldGetSrc">Pobranie odpowiedniego kodu ¼ród³owego.</a>
<li><a href="#BldKernel">Kompilacja j±dra i zabootowanie z niego.</a>
<li><a href="#BldUserland">Budowa "przestrzeni u¿ytkownika" ("make build").</a>
</ul>
 
Jest tak¿e kilka dodatkowych kroków jakie niektórzy u¿ytkownicy mog± 
chcieæ wykonaæ, w zale¿no¶ci od tego czy chc± posiadaæ ¶rodowisko X:

<ul>
<li><a href="#Release">Budowa "release".</a>
<li><a href="#Xbld">Budowa X.</a>
</ul>

<a name="BldBinary"></a>
<h3>5.3.2 - Instalacja lub uaktualnienie do najnowszej dostêpnej wersji binarnej.</h3>

Pierwszym krokiem do zbudowania systemu ze ¼róde³ jest upewnienie siê ¿e 
zainstalowane binaria s± najnowszymi dostêpnymi.

U¿yj poni¿szej tabeli by zorientowaæ siê gdzie siê znajdujesz, gdzie chcesz siê znale¼æ,
oraz z jakimi binariami powiniene¶ rozpocz±æ:

<p>
<table border="1" width="600">
<tr>
<td><b>Jeste¶ w:</b></td> <td><b>Cel</b></td>
<td><b>Uaktualnij binaria do:</b></td> <td><b>pó¼niej ...</b></td>
</tr>
<tr>
<td> Old -release </td> <td> New release </td> <td> Newest release </td>
<td> Gotowe! </td>
</tr>
<tr>
<td> -release </td> <td> -stable </td> <td> Newest release </td>
<td>Fetch &amp; build <i>-stable</i></td>
</tr>
<tr>
<td> Old -stable</td> <td> -stable </td> <td> Newest release </td>
<td>Fetch &amp; build <i>-stable</i></td>
</tr>
<tr>
<td> -release </td> <td> -current </td> <td> Latest Snapshot </td>
<td> (optional) Fetch &amp; build <i>-current</i>
</tr>
<tr>
<td> Old -current </td> <td> -current </td> <td> Latest Snapshot </td>
<td> (optional) Fetch &amp; build <i>-current</i>
</tr>
</table>

<p>
Jest zalecane, ¿eby instalowaæ binaria korzystaj±c z opcji "Upgrade"
w medium instalacyjnym.
Je¿eli jest to niemo¿liwe, mo¿esz tak¿e rozpakowaæ binaria jak to opisano
w <a href="../../upgrade37.html">tutaj</a>.
Bez wzglêdu na to bêdziesz musia³ przej¶æ ca³y proces uaktualnienia,
w³±czaj±c w to tworzenie u¿ytkowników lub inne zmiany konieczne 
w katalogu <tt>/etc</tt>.

<a name="BldGetSrc"></a>
<h3>5.3.3 - Pobieranie w³a¶ciwego kodu ¼ród³owego</h3>
¬ród³a OpenBSD s± zarz±dzane przy wykorzystaniu systemu
<a href="http://www.cvshome.org">CVS</a>, tak wiêc pobieranie
kopii ¿±danych ¼róde³ na twoj± lokaln± maszynê odbywa siê przy pomocy
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a>.
Mo¿esz to wykonaæ korzystaj±c z serwera <a href="../anoncvs.html">AnonCVS</a>
(maszyny przechowuj±cej publicznie dostêpn± kopiê ca³ego repozytorium CVS
wykorzystywanego w projekcie OpenBSD), lub z lokalnego repozytorium 
zarz±dzanego przez ciebie przy pomocy
<a href="../cvsup.html">CVSup</a>, lub
<a href="../cvsync.html">CVSync</a>, dostêpnego przez
<a href="faq8.html#Packages">pakiety</a>.
CVSup mo¿e byæ tak¿e wykorzystane w opcji "checkout", nie bêdzie to jednak
objête w tej dokumentacji.
Je¿eli posiadasz kilka maszyn na których chcesz zarz±dzaæ drzewem ¼róde³,
mo¿esz stwierdziæ ze lepiej jest posiadaæ lokalne repozytorium CVS, tworzone
i zarz±dzane przy pomocy CVSup oraz CVSync.

<p>
W sytuacji gdy zdecydujesz siê na skorzystanie z <a href="../anoncvs.html"> serwera AnonCVS</a>,
musisz sprawdziæ ("checkout") drzewo ¼róde³, a nastêpnie zarz±dziæ uaktualnienie ("update")
by wci±gn±æ uaktualnione pliki do twojego lokalnego drzewa.

<p>
Polecenie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">CVS(1)</a>
posiada wiele opcji, a niektóre z nich s± <i><b>wymagane</b></i> do sprawdzenia
i uaktualnienia przydatnego drzewa.
Inne polecenia mog± spowodowaæ uszkodzenie drzewa.
Wa¿ne jest by zrozumieæ i pod±¿aæ za wskazówkami w tym miejscu.

<p>
<b>Pod±¿anie za <i>-current</i></b><br>
<blockquote>
W tym przypadku za³o¿ymy, ¿e u¿ywamy publicznego serwera AnonCVS,
<b>anoncvs@anoncvs.example.org:/cvs</b>.
Za³o¿ymy tak¿e ze korzystasz z pow³oki  
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh(1)</a>,
(je¿eli korzystasz z innej pow³oki bêdziesz musia³ dostosowaæ niektóre z 
z podanych poleceñ).

<p>
Do pobrania ca³ego drzewa ¼róde³ CVS <i>-current</i>, mo¿esz u¿yæ:

<pre>
# <b>cd /usr</b>
# <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
# <b>cvs -d$CVSROOT checkout -P src</b>
</pre>

<p>
Gdy ju¿ posiadasz drzewo, mo¿esz je pó¼niej uaktualniæ:

<pre>
# <b>cd /usr/src</b>
# <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
# <b>cvs -d$CVSROOT up -Pd</b>
</pre>
</blockquote>

<b>Pod±¿anie za <i>-Stable</i></b><br>
<blockquote>
Je¿eli chcesz korzystaæ z alternatywnej "ga³êzi" drzewa, takiej jak
ga³±¼ <i>-stable</i>, u¿yjesz opcji "<tt>-r</tt>" ³±cznie z checkout:
<pre>
# <b>cd /usr</b>
# <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
# <b>cvs -d$CVSROOT checkout -rOPENBSD_3_7 -P src</b>
</pre>

Spowoduje to wci±gniêcie plików ¼ród³owych z ga³êzi OPENBSD_3_7, znanej 
tak¿e jako "Patch branch" lub "<a href="../stable.html">-stable</a>".

Bêdziesz móg³ uaktualniæ kod w podobny sposób:
<pre>
# <b>cd /usr/src</b>
# <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
# <b>cvs -d$CVSROOT up -rOPENBSD_3_7 -Pd</b>
</pre>

W³a¶ciwie CVS jest wystarczaj±co mi³y by oznaczyæ "etykiet±" w 
sprawdzanym systemie plików, tak ¿e nie bêdziesz musia³ pamiêtaæ o 
czê¶ci "<tt>-rOPENBSD_3_7</tt>", zapamiêta to a¿ do momentu gdy 
wyra¼nie wyczy¶cisz t± flagê lub ustawisz inn± korzystaj±c z opcji 
"<tt>-A</tt>" w "<tt>update</tt>".
Jakkolwiek, prawdopodobnie lepiej jest podaæ wiêcej informacji do linii
poleceñ CVS, ni¿ mniej.
</blockquote> 

<p>
Jak dotychczas posiadasz tylko drzewo "<tt>src</tt>", bêdziesz musia³
wykonaæ podobne kroki dla "<tt>XF4</tt>" oraz "<tt>portów</tt>".
Jako ¿e wszystkie czê¶ci OpenBSD musz± byæ utrzymywane w zgodno¶ci,
wszystkie drzewa z których korzystasz powinny byæ sprawdzane i uaktualniane
w tym samym czasie.
Mo¿esz po³±czyæ sprawdzanie w jedn± liniê (pokazano dla <i>-stable</i>):
<pre>
# <b>cd /usr</b>
# <b>export CVSROOT=anoncvs@anoncvs.example.org:/cvs</b>
# <b>cvs -d$CVSROOT checkout -rOPENBSD_3_7 -P src ports XF4</b>
</pre>

Jakkolwiek, uaktualnienia musz± byæ wykonywane katalog-po-katalogu.

<p>
W tym momencie, nie wa¿ne czy pod±¿asz za <i>-stable</i> czy <i>-current</i>
powiniene¶ mieæ u¿yteczne drzewo ¼róde³.
B±d¼ bardzo uwa¿ny z tym jakie drzewo pobierasz - do¶æ ³atwo mo¿na spróbowaæ
skompilowaæ <i>-current</i> my¶l±c ze to <i>-stable</i>.

<a name="CVSTips"></a>
<h4>Znane sztuczki z CVS</h4>

Jak wskazywali¶my wcze¶niej, niektóre opcje s± niezbêdne do pobrania
poprawnego drzewa <tt>/src</tt> w OpenBSD.
Opcja "<tt>P</tt>" powy¿ej jest jedn± z nich: "obcina" (usuwa) katalogi
które s± puste.
W ci±gu lat, katalogi s± tworzone i kasowane w drzewie ¼róde³ OpenBSD,
czasem nazwy starych katalogów s± na bie¿±co wykorzystywane jako
nazwy plików.
Bez opcji "<tt>-P</tt>", drzewo ¼róde³ które popra³e¶ NIE skompiluje 
siê pomy¶lnie.

<p>
Podobnie jest z opcj± "<tt>-d</tt>" w poleceniu "update" -- tworzy nowe
katalogi, które mog³y zostaæ dodane do drzewa od czasu twojego inicjuj±cego
sprawdzenia.

<p>
Do¶wiadczeni u¿ytkownicy mog± siê zastanawiaæ dlaczego CVSROOT zosta³o
podane i wykorzystane w przyk³adzie, chocia¿ cvs(1) zarejestruje
lokalizacjê serwera CVS w sprawdzanym drzewie.
Jest to prawd±, jakkolwiek wielokrotnie zdarza³o siê, ¿e niektórzy potrzebowali
nadpisaæ domy¶lny serwer anoncvs, wiele osób zaleca by <i>zawsze</i>
wyra¼nie sprecyzowaæ nazwê repozytorium.
Nie zmienia to tak¿e niczego w sytuacji gdy zmienna ¶rodowiskowa CVSROOT
mo¿e byæ u¿yta bezpo¶rednio przez cvs(1), jest u¿ywane tylko je¿eli nic
innego jej nie nadpisuje (np. cvs(1) zwróci³by b³±d bez tego), tymczasem
podanie jej w poleceniu cvs(1) nadpisuje wszystkie pozosta³e warto¶ci.

<p>
W tym przyk³adzie zauwa¿my ¿e parametr <tt>-Pd</tt> u¿ywany jest w poleceniu
<tt>up</tt>.
Jest to jeszcze jedna z WYMAGANYCH opcji, pozwalaj±ca na utworzenie nowych
katalogów które nie istnia³y w czasie twojego poprzedniego sprawdzania.

<p>
Czêsto u¿ytecznym jest korzystanie z <tt>.cvsrc</tt> w twoim katalogu 
domowym i okre¶lenie w nim niektórych z tych opcji.
Przyk³adowy plik <tt>.cvsrc</tt>:
<pre>
$ <b>more ~/.cvsrc</b>
cvs -q -danoncvs@anoncvs.example.org:/cvs
diff -up
update -Pd
checkout -P
</pre>
					         
Powinno to spowodowaæ by cvs(1) korzysta³ z serwera 
<tt>anoncvs@anoncvs.example.org:/cvs</tt>, likwiduj±c zazwyczaj niepotrzebne
wyj¶cie ("<tt>-q</tt>" oznacza "quiet" - "cicho") dla wszystkich operacji,
polecenie "cvs up" domy¶lnie korzysta z opcji <tt>-Pd</tt>, natomiast
polecenie "cvs diff" zapewnia "unified diffs" poprzez "<tt>-u</tt>", a
polecenie "cvs checkout" wykorzystuje opcjê "<tt>-P</tt>".
Pomimo i¿ jest to porêczne, je¿eli zapomnisz tego pliku, lub bêdziesz stara³
siê uruchomiæ te polecenia na maszynie bez tego pliku, bêdziesz mia³ problemy.


<a name="BldKernel"></a>
<a name="Building"></a>  <!-- Old tag -->
<h3>5.3.4 - Kompilacja j±dra</h3>
Za³ó¿my ¿e chcesz skompilowaæ standardowe j±dro (GENERIC
lub GENERIC.MP).
Normalnie jest to to co chcesz zrobiæ.
<i>Nie</i> rozwa¿aj kompilacji standardowego j±dra je¿eli nie opanowa³e¶
standartowego procesu kompilacji.
Jest oczywiste, ¿e j±dro jest najbardziej zale¿n± od urz±dzeñ czê¶ci±
systemu.
¬ród³a j±dra znajduj± siê w katalogu <tt>/usr/src/sys</tt>.
Niektóre czê¶ci kodu j±dra OpenBSD s± wspólne dla wszystkich platform,
inne s± bardzo charakterystyczne dla danego procesora lub architektury.
Je¿eli zajrzysz do katalogu <tt>/usr/src/sys/arch/</tt>, mo¿e zobaczyæ
rzeczy które wygl±daj± niego zagmatwane -- na przyk³ad znajduj± siê tam
katalogi <tt>mac68k</tt>, <tt>m68k</tt> oraz <tt>mvme68k</tt>.
W tym przypadku systemy mvme68k oraz mac68k, wykorzystuj± ten sam procesor,
lecz komputery oparte s± bardzo ró¿ne, i wymagaj± zupe³nie ró¿nych j±der
(znacznie wiêcej ni¿ tylko procesor wchodzi do konstrukcji komputera).
Jednak¿e, fragmenty j±dra s± wspólne, te fragmenty znajduj± siê w katalogu
m68k.
Je¿eli po prostu kompilujesz j±dro, katalogi bazowe dla architektur, jak
np. <tt>m68k</tt> nie powinny ciê martwiæ, bêdziesz pracowa³ wy³±cznie ze
"z³o¿on± architektur±" tak± jak <tt>mvme68k</tt>.

<p>
J±dra s± kompilowane w oparciu o <a href="#Options">pliki konfiguracyjne
</a>, które znajduj± siê w katalogu 
<tt>/usr/src/sys/arch/&lt;<i>your platform</i>&gt;/conf</tt> 
Budowa j±dra polega na wykorzystaniu programu
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
do stworzenia i wype³nienia katalogu kompilacji, co zakoñczy siê w 
<tt>/usr/src/sys/arch/&lt;<i>your platform</i>&gt;/compile/&lt;<i>KernelName</i>&gt;</tt>.
W naszym przyk³adzie zak³adamy ¿e korzystasz z platformy i386:

<blockquote><pre>
# <b>cd /usr/src/sys/arch/i386/conf</b>
# <b>config GENERIC</b>
# <b>cd ../compile/GENERIC</b>
# <b>make clean && make depend && make</b>
<i>[...lots of output...]</i>
# <b>make install</b>
</pre></blockquote>

Zast±p "<tt>i386</tt>" w pierwszej linii nazw± twojej architektury.
Polecenie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=machine&amp;sektion=1">machine(1)</a>
powie ci jaka jest nazwa twojej aktualnej platformy, zatem oczywistym
uogólnieniem bêdzie u¿ycie polecenia "<tt>cd
/usr/src/sys/arch/`machine`/conf</tt>" zamiast pierwszej linii.

<p>
W tym punkcie, zrestartuj komputer by uruchomiæ to nowe j±dro.
Zwróæ uwagê, ¿e nowe j±dro powinno dzia³aæ zanim przejdziesz do
nastêpnego kroku, chocia¿ je¿eli pod±¿a³e¶ za rad±
<a href="#BldBinary">powy¿ej</a> dotycz±c± uaktualnienia do najbardziej
¶wie¿ego dostêpnego "snapshota", mo¿e to nie byæ a¿ tak istotne.
Czasem jednak, zmieniasz API, i stare j±dro nie bêdzie w stanie uruchamiaæ
nowych aplikacji, ale nowe j±dro bêdzie generalnie je wspieraæ.

<h4>Zmiana w opisanym wy¿ej procesie: drzewo ¼róde³ tylko do odczyty</h4>
Czasem mo¿esz chcieæ pewno¶æ ¿e twój katalog <tt>/usr/src/sys</tt>
pozostanie niezmieniony.
Mo¿esz to uzyskaæ postêpuj±c jak poni¿ej:

<blockquote><pre>
$ <b>cd <i>/somewhere</i></b>
$ <b>cp /usr/src/sys/arch/i386/conf/GENERIC .</b>
$ <b>config -s /usr/src/sys -b . GENERIC</b>
$ <b>make clean && make depend && make</b>
... lots of output ...
</pre></blockquote>

Zauwa¿, ¿e mo¿esz skompilowaæ j±dro nie bêd±c rootem, ale musisz nim byæ
by je zainstalowaæ.

<a name="BldUserland"></a>
<h3>5.3.5 - Kompilacja przestrzeni u¿ytkownika</h3>

Jest to charakterystyczny proces wykorzystywany w OpenBSD.
Metody wykorzystywane w innych systemach operacyjnych z którymi
mo¿esz byæ zaznajomiony, najprawdopodobniej nie zadzia³aj± w OpenBSD,
i roz¶mieszy ciê je¿eli spytasz dlaczego.

<p>
<ul>
<li>Clear your <tt>/usr/obj</tt> directory and rebuild symbolic links:
<blockquote><pre>
# <b>rm -rf /usr/obj/*</b>
# <b>cd /usr/src</b>
# <b>make obj</b>
</pre></blockquote>

Zauwa¿, ¿e wykorzystanie katalogu <tt>/usr/obj</tt> jest obowi±zkowe.
Niepowodzenie w tym kroku, zanim zostanie zbudowana reszta systemu
najprawdopodobniej pozostawi twoje drzewo <tt>src</tt> w z³ej postaci.

<p>
<li>Upewnij siê ¿e wszystkie stosowne katalogi zosta³y utworzone.
<blockquote><pre>
# <b>cd /usr/src/etc && env DESTDIR=/ make distrib-dirs</b>
</pre></blockquote>

<p>
<li>Skompiluj system:
<blockquote><pre>
# <b>cd /usr/src</b>
# <b>make build</b>
</pre></blockquote>

U¿ytki z "przestrzeni u¿ytkownika" zostan± skompilowane i zainstalowane we
w³a¶ciwej kolejno¶ci.
Jest to najbardziej czasoch³onny krok -- bardzo szybkie maszyny zdolne s±
wykonaæ go w czasie poni¿ej godziny, na maszynach bardzo wolnych mo¿e to
potrwaæ kilka dni.
Gdy ten krok zostanie zakoñczony, bêdziesz posiada³ na miejscu nowe binarki
w swoim systemie.

<p>
<li><b>Je¿eli kompilujesz wersjê <i>-current</i>:</b> Zaktualizuj <tt>/dev</tt> 
oraz <tt>/etc</tt>, ze zmianami podanymi w 
<a href="../../current.html">current.html</a>.
Je¿eli pod±¿asz za wersj± -stable po w³a¶ciwym procesie 
<a href="../../upgrade37.html">uaktualnienia</a> lub zainstalowaniu 
<a href="#BldBinary">w³a¶ciwych binarek startowychproper starting</a>,
ten krok nie jest ci potrzebny. 

</ul>

<a name="Release"></a>
<a name="BldRelease"></a> <!-- old tag -->
<h2>5.4 - Kompilacja wersji -release</h2>
<h3>Czym jest "wydanie" (ang. release) i dlaczego móg³bym chcieæ zrobiæ w³asne?</h3>
Wydanie jest kompletnym zestawem plików które mog± byæ wykorzystane
do zainstalowania OpenBSD na innym komputerze.
Je¿eli posiadasz tylko jeden komputer z dzia³aj±cym OpenBSD, naprawdê nie
masz najmniejszego powodu by tworzyæ wydanie, jako ¿e w <a href="#Bld">powy¿szym</a>
procesie kompilacji zrobi³e¶ wszystko czego potrzebujesz.
Jako przyk³adowy proces tworzenia wydania mo¿e s³u¿yæ proces kompilacji
<i>-stable</i> na szybkiej maszynie, a nastêpnie wykonanie wydania które
bêdzie instalowane na pozosta³ych maszynach w twoim biurze.

<p>
Proces tworzenia wydania wykorzystuje binarki utworzone w katalogu
<tt>/usr/obj</tt> w procesie opisanym powy¿ej, musisz zatem najpierw 
pomy¶lnie zakoñczyæ tworzenie, i nic nie mo¿e naruszaæ katalogu
<tt>/usr/obj</tt>.
Moment w którym to mo¿e byæ problematyczne jest w sytuacji gdy korzystasz z
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_mfs&amp;sektion=8">
dysku pamiêci</a> jako <tt>/usr/obj</tt> dla uzyskania nieco lepszej
wydajno¶ci podczas procesu budowania, nie powiniene¶ restartowaæ komputera
pomiêdzy krokami "build" a "release".

<p>
Tworzenie wydania wymaga dwóch katalogów roboczych, które bêdziemy nazywaæ
DESTDIR i RELEASEDIR.
Wszystkie pliki które s± czê¶ci± "czystej" instalacji OpenBSD bêd± kopiowane
do ich w³a¶ciwego miejsca przeznaczenia w katalogu DESTDIR.
Nastêpnie zostan± (s)tarowane(1) i umieszczone w RELEASEDIR.
Ostatecznie RELEASEDIR bêdzie zawiera³ kompletne wydanie OpenBSD.
Podczas tworzenia wykorzystywany jest tak¿e katalog <tt>/mnt</tt>,
zatem nie powinien byæ wykorzystywany do niczego innego podczas budowy.
W celach przyk³adowych wykorzystamy DESTDIR jako <tt>/usr/dest</tt>
oraz <tt>/usr/rel</tt> jako RELEASEDIR.


<p>
Proces tworzenia wydania wymaga dwóch narzêdzi które nie s± dostêpne w 
podstawowym OpenBSD, crunch oraz crunchgen(1), wykorzystywane do stworzenia
jednego wykonywalnego pliku tworzonego z kilku osobnych binariów.
Nazwa tego pojedyñczego pliku wykonywalnego jest wywo³ywana przez ustalenie
który komponent binarny jest wykonywany.
W ten sposób szereg osobnych plików programów jest upychany do ramdysku
j±dra który znajduje siê na dyskietkach startowych lub innych startowych mediach. 
<i>Narzêdzia te musz± byæ skompilowane przez rozpoczêciem procesu 
tworzenia</i>
Wystarczy by zbudowano je raz, jednak ludzie którzy czêsto zapominaj± o 
tym kroku, a te programy kompiluj± siê szybko, niektórzy wol± budowaæ
crunch oraz crunchgen za ka¿dym razem jako czê¶æ skryptów które wykorzystuj±
do tworzenia wydania.

<p>
Musisz posiadaæ uprawnienia root'a by stworzyæ wydanie.

<p>
<h3>Tworzenie wydania</h3>

Najpierw, je¿eli nie by³o to wcze¶niej wykonywane na danej maszynie
zbuduj crunch oraz crunchgen:
<blockquote><pre>
# <b>cd /usr/src/distrib/crunch && make obj depend all install</b>
</pre></blockquote>

Nastêpnie definiujemy zmienne ¶rodowiskowe DESTDIR i RELEASEDIR:
<blockquote><pre>
# <b>export DESTDIR=/usr/dest</b>
# <b>export RELEASEDIR=/usr/rel</b>
</pre></blockquote>

Teraz czy¶cimy DESTDIR i tworzymy katalogi je¿eli jest to konieczne:
<blockquote><pre>
# <b>test -d ${DESTDIR} && mv ${DESTDIR} ${DESTDIR}.old && rm -rf ${DESTDIR}.old &</b>
# <b>mkdir -p ${DESTDIR} ${RELEASEDIR}</b>
</pre></blockquote>

RELEASEDIR normalnie nie musi byc pusty przed rozpoczêciem tworzenia wydania,
jednak¿e, je¿eli nast±pi³y jakie¶ zmiany w plikach wydania lub ich nazwach,
stare pliki mog± pozostaæ za¶miecaj±c miejsce.
Mo¿esz zatem chcieæ wyczy¶ciæ ten katalog przez rozpoczêciem.

<p>

Przystêpujemy do tworzenia samego wydania:
<blockquote><pre>
# <b>cd /usr/src/etc</b>
# <b>make release</b>
</pre></blockquote>

Po tym jak wydanie jest gotowe, dobrym pomys³em jest je sprawdziæ by
mieæ pewno¶æ ¿e pliki tar pasuj± do tego co jest w DESTDIR.
Wyj¶cie z tego kroku powinno byæ naprawdê minimalne.

<blockquote><pre>
# <b>cd /usr/src/distrib/sets</b>
# <b>sh checkflist</b>
</pre></blockquote>

Zakoñczy³e¶ i sprawdzi³e¶ pliki wydania w katalogu RELEASEDIR.
Pliki te mog± byæ wykorzystane do instalacji lub uaktualnienia OpenBSD
na innych maszynach.

<p>
Miarodajne instrukcje na temat tworzenia wydania znajduj± siê w
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>.

<p>
Uwaga: Je¿eli zamierzasz rozpowszechniaæ pliki wynikowe przez HTTP
do wykorzystania przez skrypty aktualizacji, bêdziesz
potrzebowa³ dodaæ plik "index.txt", zawieraj±c± listê wszystkich plików
z twojego nowo utworzonego wydania.
<blockquote><pre>
# <b>/bin/ls -1 >index.txt</b>
</pre></blockquote>

<a name="Xbld"></a>
<h2>5.5 - Budowa ¶rodowiska X</h2>
X wykorzystuje inny proces tworzenia ni¿ reszta drzewa OpenBSD, poniewa¿ 
bazuje na imake zamiast na standardowym
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1">make(1)</a>.
W konsekwencji nie ma katalogu "obj", generowane binarki, s± ³±czone z kodem ¼ród³owym,
co mo¿e powodowaæ problemy (lub przynajmniej nadmierne "output") z cvs(1).
Rozwi±zaniem tego problemu jest wykorzystanie
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lndir&amp;sektion=1">lndir(1)</a>
do stworzenia "shadow directory" sk³adaj±cego siê z dowi±zañ symbolicznych
to aktualnego katalogu dla drzewa XF4.

<p>
<blockquote>
<b>Tylko i386:</b>
XF86Setup wykorzystywane do konfigurowania serwerów XF3 na platformie
i386 (i tylko na platformie i386) wymaga zainstalowanych
<a href="faq8.html#Packages">pakietów</a> "tcl" oraz "tk", przed
budow± X (mo¿na je znale¼æ w drzewie portów w <tt>/usr/ports/lang/tcl/8.4/</tt>
i <tt>/usr/ports/x11/tk/8.4/</tt>. 
Instaluj±c pakiet "tk" zainstalowany zostanie pakiet "tcl" jako zale¿ny).
Jak zwykle, instalacja pakietu jest znacznie szybsza ni¿ instalacja tych
aplikacji ze ¼róde³.
Niepowodzenie instalacji tych pakietów przed budow± X jest w jaki¶ sposób
frustruj±ce, jako ¿e system bêdzie pracowa³ jaki¶ czas zanim pojawi± siê b³êdy
</blockquote>

<p>
Kompiluj±c X z wykorzystaniem "shadow directory" katalogu <tt>/usr/Xbld</tt>
u¿yj poni¿szych poleceñ, kompiluj±c i instaluj±c nowe binarki we w³a¶ciwych
katalogach:

<blockquote><pre>
# <b>rm -rf /usr/Xbld</b>
# <b>mkdir -p /usr/Xbld</b>
# <b>cd /usr/Xbld </b>
# <b>lndir ../XF4</b>
[...lots of output...]
# <b>make build</b>
[...lots of output...]
</pre></blockquote>

<p>
<h3>Tworzenie X release</h3>
Jest podobne to tworzenia systemu g³ównego wydania.
Po pomy¶lnym zbudowaniu X, definiujesz DESTDIR oraz RELEASEDIR,
w tym samym celu co poprzednio.
RELEASEDIR mo¿e byæ tym samym katalogiem co RELEASEDIR w g³ównym systemie,
natomiast DESTDIR, bêdzie wyczyszczony i przebudowany w tym procesie.
Je¿eli wykonasz to ostro¿nie, nie bêdzie problemów, jednak u¿ycie osobnego
DESTDIR mo¿e byæ "bezpieczniejsze".

<p>
W ramach przyk³adu u¿yjemy  DESTDIR oraz RELEASEDIR odpowiednio w
<tt>/usr/Xbld/dest</tt> i <tt>/usr/Xbld/rel</tt>.
Musisz to wykonaæ po zakoñczeniu powy¿ej opisanego procesu.

<blockquote><pre>
# <b>export DESTDIR=/usr/Xbld/dest</b>
# <b>export RELEASEDIR=/usr/Xbld/rel</b>
# <b>cd /usr/Xbld</b>
# <b>rm -rf dest</b>
# <b>mkdir dest rel</b>
# <b>make release</b>
</pre></blockquote>

<p>
Je¿eli zamierzasz tworzyæ zarówno X jak i release X, mo¿esz wykorzystaæ
inny cel dla make(1), "b-r", które wykona zarówno budowê jak i instalacjê.
Cel "b-r" zak³ada, ¿e DESTDIR oraz RELEASEDIR s± podkatalogami 
"<tt>rel</tt>" i "<tt>dest</tt>" wewn±trz podkatalogu w którym nastêpuje
budowa:

<blockquote><pre>
# <b>rm -rf /usr/Xbld</b>
# <b>mkdir -p /usr/Xbld /usr/Xbld/dest /usr/Xbld/rel</b>
# <b>cd Xbld </b>
# <b>lndir ../XF4</b>
[...lots of output...]
# <b>make b-r</b>
[...lots of output...]
</pre></blockquote>			

<p>
<a name= "Why"></a>
<h2>5.6 - Dlaczego potrzebujê niestandardowego j±dra?</h2>

<p>
Wiele wskazuje na to, ¿e aktualnie nie potrzebujesz go.

<p>
Niestandardowe j±dro to takie j±dro, które jest tworzone na bazie pliku konfiguracyjnego innego,
ni¿ standardowy <tt>GENERIC</tt>.
Niestandardowe j±dro mo¿e bazowaæ na kodzie <a href="#Flavors"> wydañ <i>-release,
-stable (stabilnym)</i> lub <i>-current (bie¿±cym)</i></a>, podobnie jak j±dro <tt>GENERIC</tt>.
Podczas gdy kompilacja w³asnego j±dra <tt>GENERIC</tt> jest wspierana przez
zespó³ OpenBSD, kompilacja w³asnego, niestandradowego j±dra <i>nie</i> jest.

<p>
Standardowa konfiguracja j±dra OpenBSD (<tt>GENERIC</tt>) jest stworzona tak,
aby by³a u¿yteczna dla wiêkszo¶ci osób.
Prawdopodobieñstwo tego, ¿e uda Ci siê usprawniæ swój system poprzez
modyfikacjê j±dra jest o wiele mniejsze ni¿ to, ¿e uszkodzisz swój system.
Jest wiele osób, które twierdz±, ¿e musisz tworzyæ swoje j±dro
w celu osi±gniêcia optymalnej wydajno¶ci, ale to nie jest prawda w OpenBSD.
Jedynie najbardziej zaawansowani i znaj±cy siê na rzeczy u¿ytkownicy, uruchamiaj±cy bardzo wymagaj±ce
programy musz± martwiæ siê o niestandardowe j±dro lub nawet ca³y system.

<p>
Kilka powodów dla których mo¿esz chcieæ lub potrzebujesz stworzyæ niestandardowe j±dro:
<ul>
<li>Rzeczywi¶cie wiesz co robisz i potrzebujesz
OpenBSD na komputerze z ma³± ilo¶ci± RAMu
poprzez usuniêcie niepotrzebnych sterowników urz±dzeñ.
<li>Rzeczywi¶cie wiesz co robisz i chcesz usun±æ domy¶lne
ustawienia lub dodaæ nowe, których standardowo nie w³±czono
(i masz powód, aby to robiæ).
<li>Rzeczywi¶cie wiesz co robisz i chcesz uaktywniæ eksperymentalne
ustawienia.
<li>Rzeczywi¶cie wiesz co robisz i masz specjalne potrzeby, których nie
spe³nia <tt>GENERIC</tt>, i
nie zamierzasz pytaæ dlaczego to nie dzia³a (je¶li Ci siê nie uda).
</ul>

<p>

Oto kilka powodów dla których nie powiniene¶ posiadaæ w³asnego j±dra systemu:

<ul>
  <li>Tak naprawdê nie potrzebujesz go.
  <li>Nie uzyskasz szybszego systemu.
  <li>Jest du¿a szansa, ¿e Twój komputer bêdzie mniej niezawodny.
  <li>Nie otrzymasz ¿adnego wsparcia od twórców systemu.
  <li>Bêdziesz zmuszony odtworzyæ ka¿dy problem z j±drem <tt>GENERIC</tt>
  zanim programi¶ci zajm± siê Twoim raportem o b³êdzie.
  <li>U¿ytkownicy i programi¶ci bêd± siê z Ciebie ¶miaæ, kiedy popsujesz sobie system.
  <li>Niestandardowe opcje kompilatora zwykle u³atwiaj± ujawnienie
  b³êdów kompilatora, zamiast poprawiaæ wydajno¶æ systemu.
</ul>

<p>
Usuniêcie sterowników urz±dzeñ mo¿e przyspieszyæ proces uruchamiania siê systemu, jednak
mo¿e skomplikowaæ przywracanie systemu, podczas problemów ze sprzêtem, i
bardzo czêsto proces ten jest wykonywany b³êdnie.
Usuniêcie sterowników urz±dzeñ <i>nie</i> sprawi tego, ¿eby system uruchamia³ siê 
znacz±co szybciej, choæ samo j±dro jest mniejsze.
Usuniêcie procesów debugowania i sprawdzania b³êdów mo¿e spowodowaæ odczuwalny
wzrost wydajno¶ci, ale uniemo¿liwi rozwi±zanie problemów z systemem
je¶li co¶ pójdzie ¼le.
<p>
Przypominamy ponownie, twórcy systemu
zwykle ignoruj± raporty dotycz±ce specyficznych j±der systemów, chyba ¿e
problem powtarza siê równie¿ przy j±drze GENERIC. 
Pamiêtaj, ostrzegali¶my.

<p>
<a name= "Options"></a>
<h2>5.7 - Budowa standardowego j±dra</h2>
Zak³adamy, ¿e przeczyta³e¶ <a href="#Why">powy¿szy</a> tekst, i naprawdê
bawi ciê ból.

Zak³adamy tak¿e, ¿e posiadasz cel który nie mo¿e byæ osi±gniêty
ani przez <a href="#BootConfig">Boot time configuration (UKC>)</a> ani
<a href="#config">config(8)ing a GENERIC kernel</a>.
Je¿eli oba powy¿sze nie s± prawdziwe, powiniene¶ przyczepiæ siê do GENERIC.
Naprawdê.
			     
<p>
Generowanie j±dra OpenBSD jest kontrolowana przez pliki konfiguracyjne, które
domy¶lnie s± zlokalizowane w katalogu<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/conf/</tt>.
Wszystkie architektury posiadaj± plik <tt>GENERIC</tt>, który jest
wykorzystywany do generowania standardowego j±dra OpenBSD dla tej platformy.
Mog± tak¿e znajdowaæ siê tam inne pliki konfiguracyjne, które s± u¿ywane do
tworzenia j±der o konkretnym przeznaczeniu, na przyk³ad, dla systemów o ma³ej
ilo¶ci pamiêci RAM, bezdyskowych stacji roboczych, itp.

<p>
Pliki konfiguracyjne s± przetwarzane przez program
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>,
który tworzy i zape³nia katalog kompilacyjny - <tt>../compile</tt>
(w przypadku typowej instalacji), czyli w katalogu
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/compile/</tt>. config(8) tworzy tak¿e
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1">Makefile</a>,
oraz inne pliki niezbêdne do pomy¶lnego zbudowania j±dra.

<p>
Opcje konfiguracji j±dra umo¿liwiaj± umieszczenie w j±drze
pewnych funkcji rozszerzaj±cych funkcjonalno¶æ. Pozwalaj±
na wybór elementów, które bêd± wspierane (a które nie) -- np. dla
urz±dzeñ, których nie ma w systemie. Jest mnóstwo opcji, które pomog±
dostosowaæ j±dro do w³asnych potrzeb. W tym dokumencie przedstawimy tylko
niektóre z nich, te najczê¶ciej u¿ywane. Sprawd¼ stronê podrêcznika 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>,
aby uzyskaæ bardziej szczegó³ow± listê, a poniewa¿ zmienia siê ona od czasu do
czasu, powiniene¶ upewniæ siê, ¿e jest przegl±dasz podrêcznik z tej samej
wersji, której j±dro budujesz. Mo¿esz tak¿e przegl±dn±æ przyk³ad plików
konfiguracyjnych dla Twojej architektury.

<p>
<b>Nie umieszczaj ¿adnej opcji w swoim j±drze, chyba ¿e masz
powód ¿eby to zrobiæ! Nie edytuj pliku konfiguracyjnego j±dra <tt>GENERIC</tt>!!
</b>  Najbardziej przetestowany jest zawsze
zestaw opcji j±dra GENERIC. Zwykle jest to kombinacja opcji w
<tt>/usr/src/sys/arch/&lt;<i>arch</i>&gt;/conf/GENERIC</tt>
i <tt>/usr/src/sys/conf/GENERIC</tt> dostarczonych przez dru¿ynê OpenBSD
(np NIE edytowane). Zg³aszanie problemu na dostrajanym j±drze prawie zawsze
spowoduje, ¿e zostaniesz poproszony, aby spróbowaæ zreprodukowaæ problem
na j±drze GENERIC. Nie wszystkie opcje s± kompatybilne ze sob± nawzajem,
oraz wiele opcji jest wymaganych aby system dzia³a³. Nie ma gwarancji, ¿e
tylko dlatego, ¿e zdo³a³e¶ skompilowaæ dostrojone j±dro, bêdzie ono dzia³aæ.
Nie ma gwarancji, ¿e j±dro które daje siê konfigurowaæ (config(1)) pozwoli 
siê zbudowaæ.

<p>
Specyficzne konfiguracje dla poszczególnych platform: 
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/alpha/conf/">Pliki konfiguracyjne dla j±dra alpha</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/i386/conf/">Pliki konfiguracyjne j±dra i386</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/macppc/conf/">Pliki konfiguracyjne j±dra macppc</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc/conf/">Pliki konfiguracyjne j±dra sparc</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc64/conf/">Pliki konfiguracyjne j±dra sparc64</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/vax/conf/">Pliki konfiguracyjne j±dra vax</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/hppa/conf/">Pliki konfiguracyjne j±dra hppa</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/">Pozosta³e architektury</a>
</ul>

<p>
Gdy przyjrzyjmy siê bli¿ej tym plikom i wtedy zobaczymy na górze taki wpis:<br>
<pre>
   include "../../../conf/GENERIC"
</pre>
Co oznacza, ¿e odnosimy siê do konfiguracji zawartej w innym pliku konfiguracyjnym. Ten
plik zawiera opcje niezale¿ne od platformy sprzêtowej. Wiêc kiedy tworzysz w³asn± konfiguracjê j±dra
przegl±dnij tak¿e
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/conf/GENERIC">sys/conf/GENERIC</a>. 

<p>
Wszystkie opcje przedstawione poni¿ej powinny byæ umieszczane w pliku
konfiguracyjnym j±dra w nastêpuj±cym formacie:
<blockquote>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>name</i>
</blockquote>
lub
<blockquote><pre>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>name=value</i>
</pre></blockquote>

Na przyk³ad, aby wstawiæ opcje debugowania w j±dro, powiniene¶ dodaæ poni¿sz± liniê:
<pre>
     option      DEBUG
</pre>

Opcje w j±drze OpenBSD s± t³umaczone na opcje preprocesora kompilatora,
dlatego opcja taka jak DEBUG mog³aby byæ wprowadzona poprzez kompilacjê
z opcj± -DDEBUG. Co jest równoznaczne z <tt>#define DEBUG</tt>
w ka¿dym fragmencie j±dra.

<p>
Czasem mo¿esz chcieæ wy³±czyæ jak±¶ opcje, która jest ju¿ zdefiniowana,
zwykle w pliku "<tt>src/sys/conf/GENERIC</tt>". Mimo, i¿ móg³by¶ zmodyfikowaæ
kopie tego pliku, lepszym rozwi±zaniem by³oby wykorzystanie wyra¿enia
<i>rmoption</i>.  Na przyk³ad, je¶li naprawdê chcia³by¶ wy³±czyæ
wewnêtrzny debugger j±dra (<i>nie polecane!</i>), doda³by¶ liniê podobn±
do tej:
<pre>
   rmoption DDB
</pre>
w pliku konfiguracyjnym j±dra. <tt>option DDB</tt> jest zdefiniowana w
<tt>src/sys/conf/GENERIC</tt>, lecz powy¿sza linia <tt>rmoption</tt>
wy³±cza j±.

<p>
Ponownie, proszê zobacz
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
w celu uzyskania wiêkszej ilo¶ci informacji o tych opcjach. Zauwa¿ tak¿e, ¿e
wiele opcji posiada w³asne strony man -- zawsze przeczytaj wszystko
co jest dostêpne o danej opcji przed dodaniem lub usuniêciem jej z swojego
j±dra.

<p>
<h3>Tworzenie w³asnego j±dra</h3>

W tym przypadku zbudujemy j±dro które obs³uguje wieloportow± kartê szeregow±
na z³±czu ISA 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boca&amp;sektion=4">boca(4)</a>.
Karta ta nie znajduje siê w j±drze GENERIC ze wzglêdu na konflikty z innymi
sterownikami.

Innym powszechnym powodem by tworzyæ w³asne j±dro jest posiadanie ramy RAID,
która jest zbyt du¿a by posiadaæ j± w typowym j±drze.
S± dwie proste metody by zbudowaæ w³asne j±dro: skopiowanie pliku konfiguracyjnego
dla j±dra GENERIC i wyedytowanie go, lub stworzenie "nak³adaj±cego" pliku 
"zawieraj±cego" standardowe j±dro GENERIC oraz dodatkowe potrzebne opcje 
niedostêpne w GENERIC.
W naszym przypadku plik "nak³adaj±cy" bêdzie mia³ postaæ:

<blockquote><pre>
include "arch/i386/conf/GENERIC" 

boca0  at       isa? port 0x100 irq 10     # BOCA 8-port serial cards
pccom* at       boca? slave ?
</pre></blockquote>

Dwie linie dotycz±ce boca(4) zosta³y skopiowane z zakomentowanych
linii w <tt>GENERIC</tt>, z dostosowanym IRQ wed³ug potrzeby.
Do zalet korzystania z "nak³adaj±cego" pliku nale¿y automatyczne
uaktualnianie dowolnych niepowi±zanych zmian z dowolnymi innymi
uaktualnieniami w kodzie ¼ród³owym.
Wad± jest natomiast brak mo¿liwo¶ci usuwania urz±dzeñ (chocia¿ generalnie,
jest to i tak z³y pomys³).
  
<p>
Innym sposobem na wygenerowanie stosownego j±dra jest wykonanie kopii
standartowego <tt>GENERIC</tt>, nadanie jej innej nazwy, a nastêpnie
wyedytowanie potrzebnych fragmentów.
Wad± takiego rozwi±zania s± pó¼niejsze uaktualnienia konfiguracji GENERIC,
które nale¿y w³±czyæ do twojej kopii, lub bêdziesz musia³ ponownie
stworzyæ twój plik konfiguracyjny.

<p>
W ka¿dym przypadku, po stworzeniu stosownego pliku konfiguracyjnego
dla j±dra, u¿yj config(8) aby stworzyæ j±dro, tak jak to opisano
<a href="#BldKernel">powy¿ej</a>.

<p>
Pe³ne informacje dotycz±ce tworzenia w³asnego j±dra znajdziesz na stronie
manuala
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8#COMPILING+A">
afterboot(8)</a>.

<p>
<a name= "BootConfig"></a>
<h2>5.8 - Konfiguracja j±dra podczas startu systemu</h2>

<p>
Czasem podczas startu systemu mo¿e siê okazaæ, ¿e twoje j±dro znajduje
nowe urz±dzenia, ale byæ mo¿e na z³ym przerwaniu (IRQ). I mo¿liwe, ¿e 
bêdziesz musia³ u¿yæ tego urz±dzenia w³a¶nie teraz. Aby¶ nie musia³ 
przekompilowywaæ j±dra mo¿esz u¿yæ konfiguracji j±dra OpenBSD podczas 
startu systemu. Taka operacja rozwi±¿e twój problem tylko ten jeden raz.
Je¶li uruchomisz komputer ponownie, bêdziesz musia³ powtórzyæ t±
procedurê. Wiêc jest to tylko tymczasowa naprawa, i powiniene¶
usun±æ ten problem korzystaj±c z <a href="#config">config(8)</a>. Aby 
korzystaæ z konfiguracji podczas startu systemu j±dro twojego systemu 
musi posiadaæ wpis <strong>option BOOT_CONFIG</strong>, który jest 
zawarty w j±drze GENERIC.

<p>
Wiêkszo¶æ informacji w tym temacie mo¿e byæ znalezione w podrêczniku
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot_config&amp;sektion=8">boot_config(8)</a>.

<p>
Aby dostaæ siê do Konfiguracji J±dra przez U¿ytkownika (ang. UKC = User Kernel Config), podczas startu systemu u¿yj
opcji -c.

<blockquote><pre>
boot&gt; <strong>boot hd0a:/bsd -c</strong>
</pre></blockquote>

Lub zastosuj twoj± nazwê j±dra, które chcesz zastosowaæ. U¿ycie tego spowoduje pojawienie siê
znaku zachêty UKC. W tym miejscu mo¿esz wydawaæ komendy bezpo¶rednio do j±dra
okre¶laj±c urz±dzenia które chcesz zmieniæ, wy³±czyæ lub w³±czyæ.

<p>
Poni¿ej znajduje siê lista najczêstszych komend UKC.

<ul>
<li><tt>add <strong>device</strong></tt> - Dodaje urz±dzenie poprzez kopiowanie innego
<li><tt>change <strong>devno | device </strong></tt> - Modyfikuje jedno lub wiêcej urz±dzenie
<li><tt>disable <strong>devno | device </strong></tt> - Wy³±cza jedo lub wiêcej urz±dzenie
<li><tt>enable <strong>devno | device </strong></tt> - W³±cza jedno lub wiêcej urz±dzenie
<li><tt>find <strong>devno | device </strong></tt> - Znajduje jedno lub wiêcej urz±dzenie
<li><tt>help</tt> - Krótkie podsumowanie komend UKC
<li><tt>list</tt> - Wy¶wietlenie WSZYSTKICH znanych urz±dzeñ
<li><tt>exit/quit</tt> - Kontynuacja startu systemu
<li><tt>show <strong>[attr [val]]</strong></tt> - Pokazuje urz±dzenia z atrybutami i
  opcjonalnie z podan± warto¶ci±
</ul>

<p>
Kiedy ju¿ skonfigurujesz swoje j±dro, u¿yj komendy <tt>quit</tt> lub
<tt>exit</tt>, aby kontynuowaæ start systemu.
Nastêpnie powiniene¶ skorygowaæ na trwa³e ustawienia twojego j±dra
zgodnie z opisem w zawartym w <a href="faq5.html#config">U¿ycie
config(8) do zmiany swojego j±dra</a>.


<p>
<a name= "config"></a>
<h2>5.9 - Zastosowanie config(8) do zmian w skompilowanym j±drze</h2>
<p>
Parametry <b>-e</b> i <b>-u</b> polecenia
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
mog± byæ wyj±tkowo po¿yteczne i oszczêdz± czas na kompilacjê j±dra.
Parametr <b>-e</b> pozwala na wprowadzenie ustawieñ dla UKC (ang. User Kernel Config) stosowanych
przy starcie systemu. Zmiany te bêd± dzia³a³y przy nastêpnym uruchomieniu komputera.
Natomiast opcja <b>-u</b> pokazuje jakie zmiany zosta³y dokonane podczas
startu systemu, czyli te, wprowadzone po komendzie <b>boot -c</b> w menu UKC.


<p>
Poni¿szy przyk³ad dotyczy wy³±czanie urz±dzeñ ep* w
j±drze. Przez wzgl±d na bezpieczeñstwo powiniene¶ u¿ywaæ opcji <b>-o</b>, która zapisuje
zmiany do podanego pliku. Dla przyk³adu : <strong>config -e
-o bsd.new /bsd</strong> zapisze zmiany do bsd.new. Nasz przyk³ad
nie korzysta z opcji <b>-o</b>, dlatego zmiany s± po prostu ignorowane,
i nie s± zapisywane do pliku j±dra. Aby uzyskaæ wiêcej informacji
odnosz±cych siê do b³êdów i ostrze¿eñ przeczytaj stronê podrêcznika
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>.

<!--XXXver-->
<blockquote><pre>
$ <strong>sudo config -e /bsd</strong>
OpenBSD 3.7 (GENERIC) #50: Sun Mar 20 00:01:57 MST 2005
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
warning: no output file specified
Enter 'help' for information
ukc&gt; ?
        help                            Command help list
        add         dev                 Add a device
        base        8|10|16             Base on large numbers
        change      devno|dev           Change device
        disable     attr val|devno|dev  Disable device
        enable      attr val|devno|dev  Enable device
        find        devno|dev           Find device
        list                            List configuration
        lines       count               # of lines per page
        show        [attr [val]]        Show attribute
        exit                            Exit, without saving changes
        quit                            Quit, saving current changes
        timezone    [mins [dst]]        Show/change timezone
        nmbclust    [number]            Show/change NMBCLUSTERS
        cachepct    [number]            Show/change BUFCACHEPERCENT
        nkmempg     [number]            Show/change NKMEMPAGES
        shmseg      [number]            Show/change SHMSEG
        shmmaxpgs   [number]            Show/change SHMMAXPGS
ukc&gt; <strong>list</strong>
  0 audio* at sb0|sb*|gus0|pas0|sp0|ess*|wss0|wss*|ym*|eap*|eso*|sv*|neo*|cmpci*
|clcs*|clct*|auich*|autri*|auvia*|fms*|uaudio*|maestro*|esa*|yds*|emu* flags 0x0
  1 midi* at sb0|sb*|opl*|opl*|opl*|opl*|ym*|mpu*|autri* flags 0x0
  2 nsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  3 nsphyter* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|
vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep
*|ep*|ep* phy -1 flags 0x0
  4 qsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  5 inphy** at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  6 iophy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  7 eephy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
  8 exphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*
|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|e
p*|ep* phy -1 flags 0x0
[...snip...]
ukc&gt; <strong>disable ep</strong>
 67 ep0 disabled
 68 ep* disabled
 69 ep* disabled
155 ep0 disabled
156 ep0 disabled
157 ep* disabled
158 ep* disabled
210 ep* disabled
ukc&gt; <strong>quit</strong>
not forced
</pre></blockquote>

<p>
W powy¿szym przyk³adzie, wszystkie urz±dzenia ep* s± wy³±czane w j±drze i nie bêd±
badane. Czasami kiedy u¿yjesz menu UKC podczas startu,
poprzez komendê <b>boot -c</b>, chcia³by¶ aby te zmiany by³y zapisane na
sta³e. Wówczas nale¿y u¿yæ opcji <b>-u</b>.
W nastêpnym przyk³adzie, komputer startuje wykonuj±c menu UKC i
urz±dzenie wi(4) jest wy³±czane. Po zmianach dokonanych przy pomocy boot -c, które nie s±
sta³e, nale¿y je zapisaæ. Ten przyk³ad zapisuje
zmiany przeprowadzone komend± boot -c do nowego j±dra bsd.new.

<blockquote><pre>
$ <strong>sudo config -e -u -o bsd.new /bsd</strong>
OpenBSD 3.7 (GENERIC) #50: Sun Mar 20 00:01:57 MST 2005
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
Processing history...
105 wi* disabled
106 wi* disabled
Enter 'help' for information
ukc&gt; <strong>quit</strong>
</pre></blockquote>

<p>
<a name= "VerboseBoot"></a>
<h2>5.10 - Otrzymywanie dok³adniejszych informacji podczas startu systemu</h2>

Otrzymywanie dok³adniejszych informacji podczas startu systemu mo¿e byæ 
bardzo pomocne, gdy próbujesz ustaliæ powody problemów z bootowaniem. 
Je¶li nie mo¿esz wystartowaæ systemu z dyskietki i potrzebujesz 
dok³adniejszych informacji, po prostu ponownie uruchom komputer. Kiedy 
otrzymasz znak zachêty &quot;boot&gt;&quot;, wystartuj poprzez komendê 
boot -c. To doprowadzi Ciê do UKC&gt;, gdzie wykonaj:

<blockquote><pre>
UKC&gt; <strong>verbose</strong>
autoconf verbose enabled
UKC&gt; <strong>quit</strong>
</pre></blockquote>

<p>
Wówczas otrzymasz bardzo szczegó³owe komunikaty dotycz±ce w³±czaj±cego 
siê systemu.

<p>
<a name="buildprobs"></a>
<h2>5.11 - Najczêstsze problemy, sztuczki i pytania zwi±zane z 
kompilacj± i budowaniem j±dra</h2>

<a name="sig11"></a>
<h3>5.11.1 - Tworzenie zatrzymane przez b³±d "Signal 11"</h3>

<p>
Tworzenie OpenBSD i innych programów wprost ze ¼róde³ jest zadaniem, 
które zmusza sprzêt do wiêkszego wysi³ku, intensywnie wykorzystuje 
procesor, dysk i pamiêæ. Dlatego je¶li masz sprzêt, który nie jest w 
pe³ni sprawny, najbardziej prawdopodobnym momentem wyst±pienia objawów 
niepoprawnego dzia³ania jest w³a¶nie czas kompilacji. Sygna³ b³êdu nr 11 
jest <i>zwykle</i> spowodowany przez problemy ze sprzêtem, bardzo czêsto
s± to uszkodzenia pamiêci, ale mo¿e byæ tak¿e procesor, p³yta g³ówna lub 
problemy z ch³odzeniem. Twój system mo¿e byæ aktualnie bardzo stabilny, 
jednak nie umo¿liwi Ci kompilacji programów.

<p>
Prawdopodobnie najlepszym rozwi±zaniem problemu bêdzie naprawa b±d¼ 
wymiana elementów, które powoduj± problem, gdy¿ usterki mog± objawiaæ 
siê tak¿e w innych przypadkach w przysz³o¶ci.  Je¶li posiadasz sprzêt, 
który chcesz nadal stosowaæ, a nie powoduje innych problemów oprócz tych 
zwi±zanych z kompilacj±, po prostu zainstaluj "snapshota" lub wydanie 
"release".

<p>
Aby uzyskaæ wiêcej informacji na ten temat, zobacz
<a href="http://www.bitwizard.nl/sig11/">Sig11 FAQ</a>.

<a name="snake"></a>
<h3>5.11.2 - Instrukcja "make build" przerwana komunikatem "cannot open output file snake: is
a directory"</h3>

Powy¿szy komunikat jest spowodowany dwoma oddzielnymi b³êdami:
<ul>
<li><b>Drzewo CVS zosta³o ¶ci±gniête lub uaktualnione nieprawid³owo.</b>  Kiedy 
jest wykonywana operacja sprawdzania CVS, nale¿y stosowaæ opcjê "<tt>-P</tt>",
natomiast podczas uaktualniania drzewa przez CVS, nale¿y u¿yæ opcjê "<tt>-Pd</tt>"
zgodnie z dokumentacj±
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1"
>cvs(1)</a>,
co zosta³o opisane tak¿e <a href="#BldGetSrc">powy¿ej</a>.
U¿ycie powy¿szych opcji daje pewno¶æ, ¿e
katalogi s± dodawane i usuwane z ci±gle zmieniaj±cego siê drzewa OpenBSD.

<li><b>Nieprawid³owo stworzono katalog <tt>obj</tt> zanim podjêto proces
kompilacji.</b>  Kompilacja drzewa bez katalogu <tt>/usr/obj</tt>
nie jest wspierane.

</ul>
Wa¿ne jest, aby postêpowaæ zgodnie z instrukcjami podczas
<a href="#BldGetSrc">pobierania i uaktualniania</a> 
oraz <a href="#Bld">tworzenia</a> w³asnego drzewa.

<a name="ProbIPv6"></a>
<h3>5.11.3 - Mój pozbawiony IPv6 system nie dzia³a!</h3>
Tak.
Prosimy nie rób modyfikacji których konsekwencji nie rozumiesz 
w twoim podstawowym systemie.
Jedna "ma³a" zmiana w j±drze mo¿e mieæ bardzo powa¿ne skutki dla
ca³ej reszty systemu.
Prosimy przeczytaj jeszcze <a href="#Why">to</a> raz.

<a name="ProbObj"></a>
<h3>5.11.4 - Oops! Zapomnia³em utworzyæ katalogu <tt>/usr/obj</tt>!</h3>
Wykonuj±c "make build" zanim wykonasz "make obj", skoñczysz z 
plikami obiektowymi rozsianymi w twoim katalogu <tt>/usr/src</tt>.
Jest to bardzo ¼le.
Je¿eli chcesz unikn±æ ponownego pobierania ca³ego drzewa src, mo¿esz
spróbowaæ poni¿szego zestawu by pozbyæ siê plików obj:

<pre>
    # <b>cd /usr/src</b>
    # <b>find . -type l -name obj | xargs rm</b>
    # <b>make cleandir</b>
    # <b>rm -rf /usr/obj/*</b>
    # <b>make obj</b>
</pre>

<a name="ProbObjPt"></a>
<h3>5.11.5 - Umieszczenie <tt>/usr/obj</tt> na jego w³asnej partycji</h3>
Je¿eli czêsto budujesz system, mo¿esz stwierdziæ ¿e szybciej bêdzie je¿eli
umie¶cisz <tt>/usr/obj</tt> na osobnej partycji.
Oczywi¶cie tak jest korzystniej, zazwyczaj szybciej jest:
<pre>
    # <b>umount /usr/obj</b>
    # <b>newfs <i>YourObjPartition</i></b>
    # <b>mount /usr/obj</b>
</pre>
ni¿ "rm -rf /usr/obj/*".

<a name="ProbSKIPDIR"></a>
<h3>5.11.6 - Jak mogê unikn±æ tworzenia czê¶ci drzewa?</h3>
Mo¿esz czasem chcieæ nie budowaæ pewnych czê¶ci drzewa, zazwyczaj dlatego,
¿e zainstalowa³e¶ inne narzêdzie zamiast do³±czonego z pakietów, lub
chcesz mieæ "mniejsze" wydanie release z jakiegokolwiek powodu.
Rozwi±zaniem jest wykorzystanie opcji SKIPDIR w 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mk.conf&amp;sektion=5">/etc/mk.conf</a>.

<p>
Uwaga: istnieje mo¿liwo¶æ utworzenia w ten sposób uszkodzonego systemu
Skutki u¿ywania tej opcji nie s± wspierane przez projekt OpenBSD.

<a name="ProbMoreInfo"></a>
<h3>5.11.7 - Gdzie mogê siê dowiedzieæ wiêcej na temat procesu tworzenia ze ¼róde³?</h3>
Tutaj dostêpne s± inne materia³y:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;sektion=8#COMPILING+A">afterboot(8)</a>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mk.conf&amp;sektion=5">mk.conf(5)</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/Makefile"><tt>/usr/src/Makefile</tt></a>
<li><a href="../stable.html">Patch Branches</a> (<i>-stable</i>)
<li>(dla X) <tt>/usr/X11R6/README</tt> na twoim systemie

</ul>

<a name="NoSnaps"></a>
<h3>5.11.8 - Nie widzê ¿adnej wersji snapshot w FTP. Gdzie siê podzia³y?</h3>

<p>
Wersje snapshot mog± byæ usuwane kiedy staj± siê stare (lub nie jest ju¿ 
istotny) lub zbli¿a siê moment wydania nowej wersji <i>-release</i>.

<a name="NewCompiler"></a>
<h3>5.11.9 - Jak mogê za³adowaæ nowsz± wersjê kompilatora (<i>gcc</i>)?</h3>

Tak naprawdê powiniene¶ po prostu <a href="#BldBinary">zainstalowaæ najnowszy
snapshot</a>.

<p>
OpenBSD wspiera obecnie dwa kompilatory w drzewie, gcc v3.3.5 stosowana
na wiêkszo¶ci platform, lecz tak¿e gcc v.2.95.3 wykorzystywany na
kilku platformach na które nie zosta³ przeniesiony, lub mo¿e nie byæ
nigdy przeniesiony gcc3, ze wzglêdu na niedostateczne wsparcie lub
s³ab± wydajno¶æ.

<p>
Te dwa kompilatory znajduj± siê w osobnych czê¶ciach drzewa:
<ul>
<li>gcc3: <tt>/usr/src/gnu/usr.bin/gcc</tt>
<li>gcc2: <tt>/usr/src/gnu/egcs/gcc</tt>
</ul>

<p>
Poniewa¿ aktualizacja kompilatora jest trochê jak problem z kur± i jajkiem,
zmiany w drzewie kompilatora wymagaj± nieco dodatkowej uwagi.
Musisz zbudowaæ kompilator dwukrotnie -- najpierw musisz wygenerowaæ
nowy kod ale dzia³aj±cy z kodem wygenerowanym przez stary kompilator,
nastêpna budowa stworzy zupe³nie nowy kompilator.
Generalnie mo¿esz wykonaæ nastêpuj±c± procedurê:

<pre>
    <b>Je¿eli twoja platforma korzysta z gcc 2.95.3:</b>
    # rm -r /usr/obj/gnu/egcs/gcc/*
    # cd /usr/src/gnu/egcs/gcc
     <i>- or -</i>
    <b>Je¿eli twoja platforma korzysta z gcc 3.3.5:</b>
    # rm -r /usr/obj/gnu/usr.bin/gcc/*
    # cd /usr/src/gnu/usr.bin/gcc
									         
    <b>Procedura wspólna dla gcc v3.3.5 i gcc v2.95.3</b>
    # make -f Makefile.bsd-wrapper clean
    # make -f Makefile.bsd-wrapper obj
    # make -f Makefile.bsd-wrapper depend
    # make -f Makefile.bsd-wrapper
    # make -f Makefile.bsd-wrapper install
    # make -f Makefile.bsd-wrapper clean
    # make -f Makefile.bsd-wrapper depend
    # make -f Makefile.bsd-wrapper
    # make -f Makefile.bsd-wrapper install
</pre>

<p>
Nastêpnie wykonaj normalne <a href="#BldUserland">make build</a>.

<a name="UpdateEtc"></a>
<h3>5.11.10 - Jaki jest najlepszy sposób na aktualizacjê <tt>/etc</tt>, <tt>/var</tt>,
oraz <tt>/dev</tt>?</h3>

<p>Zgodnie z ustalon± polityk±, oprogramowanie w OpenBSD nie modyfikuje
plików w <tt>/etc</tt> automatycznie.
Oznacza to, ¿e <i>zawsze</i> nale¿y do administratora wykonanie
niezbêdnych modyfikacji w /etc.
Aktualizacje nie s± wyj±tkiem.
Chc±c zaktualizowaæ pliki w tych katalogach, najpierw okre¶l jakie zmiany
zasz³y w plikach podstawowych (dystrybucji), i nastêpnie rêcznie
wprowad¼ te zmiany.

<p>
Dla przyk³adu, by zorientowaæ siê jakie siê zmieni³y ostatnio, wykonaj

<pre>
    # cd /usr/src/etc
    # ls -lt |more
</pre>

<p>Chc±c zobaczyæ wszystkie zmiany w <tt>/etc</tt> pomiêdzy arbitralnymi
wersjami OpenBSD, mo¿esz wykorzystaæ <a href="../anoncvs.html">CVS</a>.
Przyk³adowo, zmiany pomiêdzy wersjami 3.6 i 3.7 ujawni polecenie:

<pre>
    # cd /usr/src/etc
    # cvs diff -u -rOPENBSD_3_6 -rOPENBSD_3_7
</pre>

By zobaczyæ ró¿nice pomiêdzy wersjami 3.7 a <i>-current</i> ("HEAD"), wykonaj:
<pre>
    # cd /usr/src/etc
    # cvs diff -u -rOPENBSD_3_7 -rHEAD
</pre>


Skrypt
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8">/dev/MAKEDEV</a>
nie jest uaktualniany automatucznie jako czê¶æ procesu tworzenia,
jednak¿e jest instalowany jako czê¶æ <a href="#BldBinary">uaktualnienia
binarnego</a>.
Jako generaln± zasad±, dobrym pomys³em jest wykonanie kopii (je¿eli jest
to wymagane) i uruchomienie tego skryptu w twoim drzewie ¼róde³ podczas 
aktualizacji:

<pre>
    # cd /dev
    # cp /usr/src/etc/etc.`machine`/MAKEDEV ./
    # ./MAKEDEV all
</pre>

<p>
Gdy ju¿ okre¶lone zosta³y zmiany, wprowad¼ je do lokalnego drzewa,
zachowuj±c ka¿d± zmianê lokalnej konfiguracji jak± mo¿esz wykonaæ.

<p>
Typowe zmiany <tt>/etc</tt> na które nale¿y zwróciæ uwagê pomiêdzy wersjami
release, zawieraj±:
        
<ul>
<li>Dodatki do <tt>/etc/protocols</tt> oraz <tt>/etc/services</tt></li>
<li>Nowe sysctls (zobacz <tt>/etc/sysctl.conf</tt>)</li>
<li>Zmiany w domy¶lnych zadaniach cron'a. Zobacz <tt>/etc/daily</tt>,
<tt>/etc/weekly</tt>, <tt>/etc/monthly</tt>, oraz <tt>/etc/security</tt>
<li>Wszystkie skrypty rc w³±cznie z netstart</li>
<li>Zmiany urz±dzeñ, patrz wcze¶niej
<li>Zmiany hierarchii plików w <tt>/etc/mtree</tt>, patrz
<a href="#Hierarchy">poni¿ej</a>
<li>Nowi u¿ytkownicy (<tt>/etc/passwd</tt>) i grupy (<tt>/etc/group</tt>)
</ul>

Zmiany te s± podsumowane w
<a href="upgrade37.html">upgrade37.html</a> (dla aktualizacji do 3.7-release)
lub <a href="current.html">current.html</a> (dla aktualizacji
do <i>-current</i>).

<a name="Hierarchy"></a>
<h3>5.11.11 - Czy istnieje jaka¶ prosta droga do stworzenia wszystkich zmian w hierarchii plików?</h3>

<p>
Od czasu do czasu, pliki lub katalogi s± dodawane lub usuwane z pliku
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hier&amp;sektion=7">hierarchy</a>.
Tak¿e, informacje o uprawnieniach dla czê¶ci systemu plików mog± siê zmieniaæ.
Jako najprostszym sposobem by mieæ pewno¶æ, ¿e twoja hierarchia jest aktualna
jest wykorzystanie narzêdzia
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">mtree(8)</a>.

<p>
Najpierw zdob±d¼ najnowsze ¼ród³a, nastêpnie wykonaj poni¿sze:

<pre>
    # cd /usr/src/etc/mtree
    # install -c -o root -g wheel -m 600 special /etc/mtree
    # install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
    # mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre>

<p>
Twoja hierarchia plików powinna byæ od teraz aktualna.


<p>
<font color= "#0000e0">
<a href= "index.html">[Spis tre¶ci]</a>
<a href= "faq4.html">[Sekcja 4 - Instalacja OpenBSD]</a>
<a href= "faq6.html">[Sekcja 6 - Sieæ]</a>
</font>

<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt= "[powrót]"></a>
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq5.html,v 1.125 ]<br>
$Translation: faq5.html,v 1.12 2005/09/23 00:57:12 pl-team Exp $<br>
-->
$OpenBSD: faq5.html,v 1.12 2005/09/28 19:46:32 saad Exp $
</small>
</body>
</html>
