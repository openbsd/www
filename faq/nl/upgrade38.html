<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD Upgrade Gids</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<meta name="resource-type" content="document">
<meta name="description"   content="the OpenBSD FAQ page">
<meta name="keywords"      content="openbsd,faq">
<meta name="distribution"  content="global">
<meta name="copyright"     content="This document copyright 2005 by OpenBSD">
</head>

<body bgcolor="#ffffff" text="#000000">
<a href="../../nl/index.html">
<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif" border="0">    
</a>
<p>
<font color="#0000e0">
<a href="../upgrade35.html">[3.4 -> 3.5]</a> |
<a href="../upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<h1><font color="#e00000">Upgrade Gids: 3.7 naar 3.8</font></h1>
<hr>

<i>Opmerking: Upgrades worden alleen ondersteund van één uitgave naar de
uitgave die er onmiddellijk op volgt.
Sla geen uitgaven over.</i>

<p>
Upgraden is een handige manier om uw OpenBSD systeem naar de meest recente
versie te brengen.
De resultaten zijn echter niet bedoeld om precies overeen te stemmen met
de resultaten van een wis-en-herlaad installatie.
Oude library-bestanden worden meer bepaald niet verwijderd tijdens het
upgrade-proces, aangezien ze vereist zouden kunnen zijn door oudere
toepassingen die op dit moment al dan niet geüpgraded kunnen worden.
Als u ECHT van al deze oude bestanden wenst af te raken, zou u waarschijnlijk
beter af zijn door vanaf nul te herinstalleren.

<h2>Vóór het upgraden...</h2>
Vóór het upgraden kiezen sommige gebruikers ervoor om alle
<a href="faq8.html#Packages">packages</a> te verwijderen en nieuwe versies
te installeren na de upgrade.
<p>
Om snel alle packages van uw systeem te verwijderen:
<blockquote><pre>
pkg_delete -q /var/db/pkg/*
</pre></blockquote>
Installeer na de upgrade de nieuwe versies van deze toepassingen.

<p>

Merk op dat in OpenBSD 3.8 de pkg tools nu het terplaatse updaten ondersteunen
met <code>pkg_add -r</code>.  De werking hiervan werd nagekeken met de meeste
packages, in het bijzonder met de CD packages beschikbaar in 3.6 of 3.7.
Enkele belangrijke punten zijn van toepassing:
<ul>
<li><code>pkg_add -r</code> doet geen globale updates, maar moet gezegd
worden welke packages te updaten.  Er kan een nieuwe optie
<code>pkg_add -u</code> gebruikt worden om de precieze lijst uit te zoeken
van packages die doorgespeeld moeten worden aan <code>pkg_add -r</code>.
<li><code>pkg_add -r -F update -F updatedepends -q list_of_new_pkgs</code>
zou in de meeste gevallen moeten werken.
<li>mozilla packages in 3.7 kunnen nu veilig geüpdated worden naar een 3.8
versie.
</ul>

<h2>Upgraden met een installatiemedium</h2>
De gemakkelijkste en veiligste manier om van binaire files te upgraden is
door te booten vanaf een installatiemedium en de upgrade-stappen te volgen,
die heel gelijkaardig zijn aan het <a href="faq4.html">installatieproces</a>.
Nadien doet u de <a href="#etcUpdates"><tt>/etc</tt> updates</a> hieronder.

<h2>Upgraden zonder installatiemedium</h2>
<i>Dit is niet het aanbevolen proces. Gebruik de methode met installatiemedium
indien überhaupt mogelijk!</i>

<p>
Soms moet men een machine upgraden wanneer men niet gemakkelijk het normale
upgrade-proces kan gebruiken.
Men kan dit gewoonlijk doen door nauwgezet een proces te volgen, gelijkaardig
aan een bron-gebaseerde upgrade:

<ul>
<li><b>Plaats installatiebestanden op een "goede" locatie</b>.
Zorg ervoor dat u voldoende ruimte hebt!

<li><b>Installeer nieuwe kernel(s)</b>
<blockquote><pre>
cd /<i>path</i>
rm /obsd ; ln /bsd /obsd && cp bsd /nbsd && mv /nbsd /bsd
cp bsd.rd bsd.mp /
</pre></blockquote>

Bemerk de extra stappen om over de primaire kernel te kopiëren: die worden
gedaan om te verzekeren dat er steeds een geldige kopie van de kernel op de
schijf staat, waarvan het het systeem kan booten, in het geval dat er zich
een erg slecht getimede stroomonderbreking of systeemcrash zou voordoen.

<li><b>Installeer nieuwe <tt>/etc/firmware</tt> bestanden:</b>
Wegens het feit dat enkele geuploade "firmware" stukken verplaatst werden
vanuit de kernel naar bestanden in de <tt>/etc/firmware</tt> directory,
zijn er een aantal drivers die zullen breken als er geen uploadbaar firmware
bestand beschikbaar is wanneer de nieuwe kernel boot.
Dit zal alleen gebruikers van enkele devices treffen, hoewel alle
gebruikers deze stap zonder problemen kunnen gebruiken.
Om de firmware bestanden uit te pakken uit <tt>base38.tgz</tt>, gebruikt u
het volgende als root:

<blockquote><pre>
cd /
tar xzpf /<i>path</i>/base38.tgz "*etc/firmware/*"
</pre></blockquote>

alvorens verder te gaan met de volgende stap.

<li><b>Herstart met de nieuwe kernel:</b>
Het zou verleidelijk kunnen zijn deze stap over te slaan, maar het zou nu
moeten gebeuren, aangezien de nieuwe kernel gewoonlijk wel oude userland
toepassingen zal draaien (zoals het binnenkort belangrijke <tt>reboot</tt>!),
maar vaak zal een nieuw userland NIET werken op de oude kernel.

<li><b>Sluit toepassingen af die problemen zouden kunnen veroorzaken in de
volgende stappen.</b>

<li><b>Installeer nieuwe userland toepassingen</b>
<blockquote><pre>
cd /
tar xzpf /<i>path</i>/base38.tgz
tar xzpf /<i>path</i>/comp38.tgz
tar xzpf /<i>path</i>/game38.tgz
tar xzpf /<i>path</i>/man38.tgz
tar xzpf /<i>path</i>/misc38.tgz
tar xzpf /<i>path</i>/xbase38.tgz
tar xzpf /<i>path</i>/xfont38.tgz
tar xzpf /<i>path</i>/xserv38.tgz
tar xzpf /<i>path</i>/xshare38.tgz
</pre></blockquote>
Opmerking: niet alle bestandensets zullen geïnstalleerd moeten worden voor
alle toepassingen, als u echter oorspronkelijk een bestandenset installeerde,
dan moet u hem nu zeker upgraden met de nieuwe bestandensets.
Merk ook op dat de bestanden in <tt>/etc</tt> hieronder afzonderlijk
behandeld worden, dus <tt>etc38.tgz</tt> en <tt>xetc38.tgz</tt> worden
hier NIET uitgepakt.

<li><b>Bijwerken van <tt>/dev</tt>.</b>
Het nieuwe
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8&amp;arch=i386">MAKEDEV</a>
bestand zal gekopieerd worden naar /dev door de installatie van
<tt>base38.tgz</tt>, zodat u eenvoudigweg het volgende moet doen:
<blockquote><pre>
cd /dev
./MAKEDEV all
</pre></blockquote>

<li><b>Upgrade <tt>/etc</tt> zoals hieronder</b>.

<li><b>Herstart</b>
</ul>

Tijdens dit proces zou
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&amp;sektion=8">sendmail(8)</a>
enkele foutboodschappen kunnen produceren zoals de volgende:
<pre>
    Nov 1 12:47:05 puffy sm-mta[16733]: filesys_update failed: No such file or dire
    ctory, fs=., avail=-1, blocksize=380204
</pre>
Deze boodschappen kunnen veilig genegeerd worden, of misschien wenst u
sendmail(8) af te sluiten tijdens het upgrade-proces.

<hr>
<p>
<a name="etcUpdates"></a>
<h2>Updates in <tt>/etc</tt></h2>

Of u nu upgradet door een installatiemedium te gebruiken en een formeel
"upgrade" proces te doen, of "ter plaatse" een binaire upgrade doet, er zijn
bepaalde manuele stappen die uitgevoerd moeten worden.

<a name="users"></a>
<h4>Nieuwe gebruikers en groepen</h4>
Een HostAP daemon werd toegevoegd, dus zijn er nieuwe gebruikers en groepen
nodig.

Voeg de volgende gebruikers en groepen toe als <i>root</i>, met
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>:

<blockquote><pre>
useradd -u86 -g=uid -c"HOSTAP Daemon" -d/var/empty -s/sbin/nologin _hostapd
</pre></blockquote>

Deze stap zal zowel de nieuwe gebruiker als zijn overeenkomstige groep
toevoegen.
Uw omgeving kan u toelaten die commando's te kopiëren/plakken.


<a name="apps"></a>
<h4>Userland Toepassingen</h4>

<a name="etcfiles"></a>
<h4><tt>/etc</tt> bestandswijzigingen</h4>
U zal de <tt>etc38.tgz</tt> bestanden willen uitpakken in een tijdelijke
directory:
<blockquote><pre>
cd /tmp
tar xzpf /<i>path</i>/etc38.tgz
</pre></blockquote>


Bestanden die waarschijnlijk kunnen gekopieerd worden van <tt>etc38.tgz</tt>
"zoals ze zijn":

<!--
<blockquote><pre>
changelist
daily
fbtab
moduli
netstart
ospfd.conf
rc
security
services
mtree/*
</pre></blockquote>

Merk op dat het mogelijk IS om deze bestanden lokaal te wijzigen, als dit
gedaan werd, zal handmatig samensmelten (merge) nodig zijn.
Hier zijn kopieer/plak lijnen om deze bestanden te kopiëren, in de
veronderstelling dat u <tt>etc38.tgz</tt> uitpakte op de hierboven
aanbevolen plaats:

<blockquote><pre>
cd /tmp/etc
cp changelist daily fbtab moduli netstart ospfd.conf rc security services /etc
cp mtree/* /etc/mtree/
</pre></blockquote>

<p>
Bestanden die handmatig samengesmolten moeten worden, met behoud van lokale
wijzigingen die er in werden aangebracht, indien ze gewijzigd werden
in vergelijking met de standaard bestanden, anders kopieert u ze ook
gewoon:

<blockquote><pre>
ftpusers
rc.conf
spamd.conf
sysctl.conf
mail/aliases
skel/.cshrc
skel/.profile
</pre></blockquote>
-->

Gebruik tenslotte
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">mtree(8)</a>
om nieuwe directories aan te maken:
<blockquote><pre>
mtree -qdef /etc/mtree/4.4BSD.dist -p / -u
</pre></blockquote>

<p>
<font color="#0000e0">
<a href="../upgrade35.html">[3.4 -> 3.5]</a> |
<a href="../upgrade36.html">[3.5 -> 3.6]</a> |
<a href="upgrade37.html">[3.6 -> 3.7]</a> |
<a href="index.html">[FAQ Index]</a>
</font>

<p>
<hr>
<a href="index.html"><img height="24" width="24" src="../../images/back.gif" border="0" alt="[terug]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: upgrade38.html,v 1.6 ]<br>
$Translation: upgrade38.html,v 1.2 2005/09/17 19:01:42 smestdag Exp $<br>
-->
$OpenBSD: upgrade38.html,v 1.1 2005/09/20 07:30:01 saad Exp $
</small>

</body>
</html>
