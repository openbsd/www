<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>5 - Neuerzeugen des Systems aus den Quelltexten</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta http-equiv="Content-Language" content="de">
<meta name= "description"   content= "Die OpenBSD FAQ Seiten - FAQ 5: OpenBSD aus dem eigenen Quelltext neu erzeugen">
<meta name= "keywords"      content= "openbsd,faq,quelltext,neuerzeugen">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2004 by OpenBSD.">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<body bgcolor= "#ffffff" text= "#000000">
<!-- Passes validator.w3.org.  Please keep it this way -->

<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif">
<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href= "faq4.html">[Zum Kapitel 4 - OpenBSD 3.5 Installationsanleitung]</a>
<a href= "faq6.html">[Zum Kapitel 6 - Netzwerk]</a>
</font>

<h1><font color="#e00000">5 - Das System aus dem Source-Code erzeugen</font></h1>
<hr>

<p>
<h3>Inhaltsverzeichnis</h3>
<ul>
<li><a href= "#Flavors">5.1 - OpenBSDs ,flavors'</a>
<li><a href= "#Why">5.2 - Warum brauche ich einen selbsterstellten Kernel?</a>
<li><a href= "#Options">5.3 - Kernelkonfigurationsdateien</a>
<li><a href= "#Building">5.4 - Einen eigenen Kernel kompilieren</a>
<li><a href= "#BootConfig">5.5 - Boot-time Konfiguration</a>
<li><a href= "#VerboseBoot">5.6 - Mehr Lognachrichten w&auml;hrend des
  Startens</a>
<li><a href= "#config">5.7 - Mittels config(8) deinen Kernel ver&auml;ndern</a>
<li><a href= "#buildprobs">5.8 - H&auml;ufige Probleme beim Kompilieren
  und Erzeugen des Systems</a>
   <ul>
   <li><a href="#sig11">5.8.1 - Das Kompilieren bricht mit einem "Signal 11"
      Fehler ab</a>
   <li><a href="#snake">5.8.2 - "make build" schl&auml;gt mit "cannot open
      output file snake: is a directory" fehl</a>
   </ul>
<li><a href="#BldRelease">5.9 - Wie erstelle ich ein OpenBSD Release?</a>
</ul>
<hr>
<br>


<a name="Flavors"></a>
<h2>5.1 - OpenBSDs ,flavors'</h2>
<!-- XXXversion - revise doodle -->
Es gibt drei ,flavors' von OpenBSD:
<ul>
<li><b>-release:</b> Die Version von OpenBSD, die alle 6 Monate auf CD
    ausgeliefert wird.
<li><b>-stable:</b>  Release und zus&auml;tzliche Patches, die f&uuml;r
    Sicherheit und Zuverl&auml;ssigkeit als notwendig erachtet werden.
<li><b>-current:</b> Die jetzt-im-Moment-aktuelle Version von OpenBSD, die
    sich in die n&auml;chste release-Version verwandeln wird.
</ul>

Grafisch sieht die Entwicklung dieser ,flavors' ungef&auml;hr so aus:

<blockquote>
<pre>
       ,------o-----------o----X                    3.2 Stable
       |      .           .
       |      .    ,------o---------o----X          3.3 Stable
       |      .    |      .         .
       |      .    |      .    ,----o----------o--&gt; 3.4 Stable
       |      .    |      .    |    .          .
       |      .    |      .    |    .    ,-----o--&gt; 3.5 Stable
       |      .    |      .    |    .    |     .
       |      .    |      .    |    .    |     .
 --&gt;3.2Rel-----&gt;3.3Rel-----&gt;3.4Rel-----&gt;3.5Rel----&gt; Current

          Zeit ---&gt;
</pre>
</blockquote>

<p>
Der Code tree wird alle sechs Monate in <i>-current</i>, <i>-release</i> und
<i>-stable</i> aufgeteilt -- <i>-release</i> wird zu einem festen Punkt
(einem &quot;Tag&quot;) in der Geschichte des source tree - der niemals
ge&auml;ndert wird, und genau der ist, der auch auf den
<a href="../../de/orders.html">CDs</a> und <a href="../../de/ftp.html">FTP
Servern</a> verf&uuml;gbar ist. <-i>-Current</i> dagen ist die Baustelle,
an der die aktive Arbeit gemacht wird, und die dann das n&auml;chste
<i>-release</i> von OpenBSD wird.

<p>
Der <i>-stable</i> (auch bekannt als der "Patch branch") basiert auf
<i>-release</i> und ist, wie man sehen kann, ein "branch" aus dem
Entwicklungspfad von OpenBSD. Wenn wichtige Korrekturen und Fixes
an <i>-current</i> vorgenommen werden, werden diese in die <i>-stable</i>
,branches' "zur&uuml;ckportiert".
In der obigen Illustration sind die vertikalen gepunkteten Linien
Bug Fixes, die in die <i>-stable</i> ,branches' eingef&uuml;gt werden. Du
wirst auch erkennen, dass der Lebenszyklus des <i>3.2-stable</i> ,branch'
mit Erscheinen des <i>3.4-release</i> beendet war und der <i>3.3-stable</i>
,branch' mit Erscheinen von <i>3.5-release</i> beendet war -- alte Versionen
werden typischerweise noch zwei "releases" lang weitergepflegt. Es braucht
nunmal Ressourcen und Zeit, &auml;ltere Versionen zu pflegen, und obwohl wir
das gerne tun w&uuml;rden, konzentrieren wir uns doch lieber auf neue
Funktionen. Der <i>-stable</i> ,branch' kann vom Design her sehr leicht aus
dem <i>-release</i> ,branch' der selben Version erzeugt werden (z.B. von
<i>3.5-release</i> zu <i>3.5-stable</i>).

<p>
Der <i>-stable</i> ,branch' ist <i>-release</i> plus Patches, die man
auf der <a href="../../de/errata.html">errata Seite</a> findet, und
ein paar einfachen Fixes, die keinen errata-Eintrag verdienen.
Normalerweise ist die Bedienung und der Betrieb von <i>-stable</i>
genauso wie der des <i>-release</i>, auf dem er basiert. Wenn die
<a href="http://www.openbsd.org/cgi-bin/man.cgi">Manual Seiten</a>
ge&auml;ndert werden m&uuml;ssen, wird es wahrscheinlich nicht in
<i>-stable</i> eingef&uuml;gt werden. Mit anderen Worten,
Unterst&uuml;tzung f&uuml;r neue Hardware wird NICHT in <i>-stable</i>
eingef&uuml;gt und neue Funktionen werden nur dann eingef&uuml;gt, wenn
das als sehr wichtig erachtet wird.

<p>
Warnung: <i>-current</i> ist ein sich bewegendes Ziel. Es &auml;ndert sich
fast min&uuml;tlich und kann sich genauso gut mehrere Male in der
Zeit &auml;ndern, die man braucht, um dem Source Code zu holen.
Wie vorher schon gesagt gibt es keinerlei Garantie, dass das System
kompiliert oder gar funktioniert (nat&uuml;rlich hoffen wir das immer).
Es ist absolut m&ouml;glich und nicht ungew&ouml;hnlich, dass man sich
den <i>-current</i> Source holt und er nicht kompiliert werden kann,
w&auml;hrend es f&uuml;nf Minuten sp&auml;ter wieder klappt.
<b>Wenn du damit nicht umgehen kannst, lass deine Finger von
<i>-current</i>.</b>

<p>
Die meisten Benutzer sollten also einfach <i>-stable</i> oder <i>-release</i>
benutzen. Da das jetzt klar ist, sollte man aber auch wissen, dass viele Leute
<i>-current</i> auf Produktionssystemen fahren, und das ist insofern wichtig,
weil es hilft, Bugs zu finden und neue Features zu testen. Wenn du aber
nicht wei&szlig;t, wie man sauber Probleme beschreibt, diagnostiziert oder
damit umgeht, rede dir (oder jemand anderem ) besser nicht ein,
du w&uuml;rdest "dem Projekt helfen", indem du <i>-current</i> benutzt.
"Es funktioniert nicht!" ist keine <a href="../../de/report.html#bugtypes">
n&uuml;tzliche Fehlermeldung</a>. "The recent changes to the pciide driver
broke compatibility with my Slugchip-based IDE interface, dmesg of working and
broken systems follow..." k&ouml;nnte dagegen durchaus ein sinnvoller
und n&uuml;tzlicher Bericht sein.

<p>
Es mag Zeiten geben, dass auch ein "normaler" Benutzer gerne "auf des Messers
Schneide" leben will und <i>-current</i> benutzt. Der h&auml;ufigste Grund
daf&uuml;r ist, dass er ein Ger&auml;t hat, was nicht von <i>-release</i>
unterst&uuml;tzt wird (und daher nat&uuml;rlich auch nicht von <i>-stable</i>),
oder er m&ouml;chte eine neue Funktion aus <i>-current</i> benutzen. In
diesem Fall hat er die Wahl zwischen <i>-current</i> oder dem Nichtbenutzen
seines Ger&auml;tes, und dann ist eben das Benutzen von <i>-current</i> oftmals
weniger schlimm. Man sollte dann aber auf keinen Fall ein H&auml;ndchenhalten
der Entwickler erwarten, falls es zu Problemen kommt.

<h3>Snapshots</h3>
Zwischen den formalen Ver&ouml;ffentlichungen neuer Versionen von OpenBSD
werden <i>Snapshots</i> &uuml;ber die <a href="../../de/ftp.html">FTP
Setien</a> verf&uuml;gbar gemacht. Wie der Name schon sagt, sind das Versionen
von Code, der gerade zu eben diesem Zeitpunkt aktuell war, als der
&Uuml;bersetzer des Snapshots sich eine Kopie des Source Code f&uuml;r eben
diese Plattform gemacht hat. Denke bitte daran, dass es auf einigen Plattformen
auch einige TAGE sein k&ouml;nnen, bis der Snapshot dann auch kompiliert und
zur Verf&uuml;gung gestellt wird. Es gibt auch keinerlei Garantien, dass die
Snapshots funktionsf&auml;hig oder auch nur installationsf&auml;hig sind.
Oftmals werden Snapshots dann erzeugt, wenn es eine &Auml;nderung gibt,
die getestet werden muss. Bei einigen Plattformen werden Snapshots
auf fast t&auml;glicher Basis erstellt, andere sind weniger
regelm&auml;&szlig;ig. Wenn du unbedingt <i>-current</i> benutzen willst, ist
ein aktueller Snapshot oft das einzige, was du dazu brauchst, und das Upgraden
auf den aktuellen Snapshot ist auch ein wunderbarer Ausgangspunkt, bevor du
versuchst <i>-current</i> zu erzeugen.

<p>
Manchmal wird gefragt, ob es einen Weg gibt, genau den Source Code zu
bekommen, der zur Erzeugung eines Snapshot eingesetzt wurde. Die Antwort
ist "Nein". Erstens ergibt sich daraus kein besonderer Vorteil. Zweitens
werden Snapshots nach Bedarf erzeugt, wenn die Zeit es erlaubt oder
es gen&uuml;gend Ressourcen gibt. Auf schnellen Plattformen k&ouml;nnten
z.B. mehrere Snapshots an einem Tag freigegeben werden. Auf den langsameren
kann das schon mal eine ganze Woche dauern. Und das Platzieren eines
"Tag" f&uuml;r jeden Snapshot in den Source Code ist nun wirklich
extrem unpraktisch.

<h3>Die Dinge in Balance halten</h3>
Es ist wichtig zu verstehen, dass OpenBSD ein Betriebssystem ist
und als ganzes gesehen werden muss, nicht ein Kernel mit einem
Schwanz an Applikationen, die drangeh&auml;ngt sind. Du musst sicherstellen,
dass dein Kernel, dein "Userland" (die unterst&uuml;tzenden Werkzeuge und
Dateien) und dein <a href="../../de/ports.html"><tt>Ports</tt></a> tree
alle synchronisiert sind, oder es werden unangenehme Dinge passieren.
Oder anders ausgedr&uuml;ckt (da es immer wieder Leute gibt, die das
versuchen), kannst du keine brandneuen <tt>Ports</tt> auf einem System laufen
lassen, das einen Monat alt ist oder einen Kernel aus <i>-current</i>
neu erzeugen und dann erwarten, dass er mit einem <i>release</i>-Userland
zusammenarbeitet. Ja, das hei&szlig;t, dass du dein System auf aktuellem Stand
halten musst, wenn du ein neues Programm laufen lassen willst, das z.B. erst
heute in den Ports tree eingef&uuml;gt wurde. Tut uns erneut leid, aber
OpenBSD hat nunmal nur sehr begrenzte Ressourcen, so dass wir sowas
nicht &auml;ndern k&ouml;nnen.

<p>
Man sollte verstehen, dass der Update-Prozess, wenn man ein
<a href="../upgrade-minifaq.html">Upgrade mittels Source</a> durchf&uuml;hrt,
<b>nur in eine Richtung unterst&uuml;tzt wird: Von &auml;lter zu neuer</b>,
und von <i>-stable</i> zu <i>-current</i>.  Du kannst kein <i>3.5-current</i>
(oder einen Snapshot) laufen lassen und dich dann entscheiden, dass dir
das zu gef&auml;hrlich ist, und einfach nach <i>3.5-stable</i>
zur&uuml;ckgehen. Du bist auf dich allein gestellt, wenn du einen anderen Weg
w&auml;hlst als den normalen und unterst&uuml;tzen, n&auml;mlich dein System
von Grund auf neu zu installieren; erwarte bitte keinerlei Hilfeleistung
vom OpenBSD Entwicklerteam.

<p>
Ja, das soll wirklich hei&szlig;en, dass du lang und breit dar&uuml;ber
nachdenken sollst, bevor du dich an <i>-current</i> wagst.


<p>
<a name="Why"></a>
<h2>5.2 - Warum brauche ich einen selbsterstellten Kernel?</h2>

<p>
Eigentlich brauchst du ihn vermutlich nicht.

<p>
Ein angepasster Kernel ist ein Kernel, der mit einer anderen
Konfigurationsdatei als der bereitgestellten <tt>GENERIC</tt>
Konfigurationsdatei erstellt wurde.
Ein angepasster Kernel kann auf <a href="#Flavors"><i>-release,
-stable</i> oder <i>-current</i></a> Code basieren, genauso wie
der <tt>GENERIC</tt> es tun kann.
W&auml;hrend das Kompilieren deines eigenen <tt>GENERIC</tt> Kernel
vom OpenBSD Team unterst&uuml;tzt ist, ist es das Kompilieren eines
selbst angepassten Kernels <i>nicht</i>.

<p>
Die standardm&auml;&szlig;ige OpenBSD Kernelkonfiguration (<tt>GENERIC</tt>)
ist daf&uuml;r ausgerichtet, f&uuml;r die meisten Leute einsetzbar zu sein.
Mehrere Leute haben beim Versuch, das System zu optimieren, ihr System
zerschossen, statt die Systemleistung zu verbessern.
Es gibt Leute, die meinen, dass du deinen Kernel anpassen musst, um
die optimale Leistung zu erhalten, doch das stimmt nicht f&uuml;r OpenBSD.
Nur die fortgeschrittensten und erfahrensten Anwender mit den
anspruchsvollsten Applikationen m&uuml;ssen sich Gedanken &uuml;ber einen
angepassten Kernel oder ein angepasstes System machen.

<p>
Einige Gr&uuml;nde warum du vielleicht einen angepassten Kernel erzeugen
m&ouml;chtest:
<ul>
  <li>Du wei&szlig;t tats&auml;chlich was du tust und m&ouml;chtest
      OpenBSD f&uuml;r einen Computer zurecht schneidern, der nur &uuml;ber
      sehr wenig RAM verf&uuml;gt, indem du Ger&auml;te Treiber entfernst,
      die du nicht ben&ouml;tigst.
  <li>Du wei&szlig;t tats&auml;chlich was du tust und m&ouml;chtest
      standardm&auml;&szlig;ig aktivierte Optionen oder Optionen, die
      (aus gutem Grund) normalerweise nicht aktiviert sind, aktivieren.
  <li>Du wei&szlig;t tats&auml;chlich was du tust und m&ouml;chtest
      experimentelle Optionen aktivieren.
  <li>Du wei&szlig;t tats&auml;chlich was du tust, eine
      spezielle Verwendung hast, die nicht von <tt>GENERIC</tt>
      bewerkstelligt werden k&ouml;nnte, und nicht nachfragen wirst, warum
      es nicht funktioniert, wenn etwas schief l&auml;uft.
</ul>

<p>
Einige Gr&uuml;nde, warum du keinen eigenen angepassten Kernel erzeugen
solltest:
<ul>
  <li>Im Normalfall musst du es nicht.
  <li>Du wirst kein schnelleres System erhalten.
  <li>Du wirst wahrscheinlich ein weniger vertrauensw&uuml;rdiges System
      erzeugen.
  <li>Du wirst keine Unterst&uuml;tzung der Entwickler erhalten.
  <li>Es wird von dir erwartet, dass du jegliches Problem mit einem
      <tt>GENERIC</tt> Kernel reproduzieren kannst, bevor Entwickler
      irgendeine Fehlermeldung ernst nehmen.
  <li>Anwender und Entwickler werden dich auslachen, wenn du dein System
      zerschie&szlig;t.
  <li>Angepasste Kompiler Optionen sind normalerweise besser darin,
      Kompiler Probleme hervorzurufen, statt die System Geschwindigkeit
      zu erh&ouml;hen.

</ul>

<p>
Das Entfernen von Ger&auml;te Treibern mag den Bootprozess von deinem
System beschleunigen, aber wird den Wiederherstellungsprozess erschweren,
wenn du ein Problem mit der Hardware hast, und wird meistens falsch
durchgef&uuml;hrt.
Das Entfernen der Ger&aulm;te Treiber <i>wird nicht</i> dazu beitragen,
dass dein System sp&uuml;rbar schneller wird, obwohl es einen kleineren
Kernel erzeugt.
,Debugging' Informationen und Fehler&uuml;berpr&uuml;fungsroutinen
zu entfernen kann das System sp&uuml;rbar beschleunigen, doch wird es
die Untersuchung eines Systems unm&ouml;glich machen, wenn etwas
schief geht.


<p>
Es sei an dieser Stelle noch einmal erw&auml;hnt, dass Entwickler
normalerweise Meldungen von Fehlern ignorieren, au&szlig;er wenn sie ebenfalls
mit einem <tt>GENERIC</tt> Kernel hervorgerufen werden k&ouml;nnen.
Du wurdest gewarnt.

<p>
<a name="Options"></a>
<h2>5.3 - Kernelkonfigurationsdateien</h2>
Die OpenBSD Kernel Generierung wird &uuml;ber Konfigurationsdateien verwaltet,
die sich standardm&auml;&szlig;ig im
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/conf/</tt> Verzeichnis befinden.
Alle Architekturen haben eine Datei, <tt>GENERIC</tt>, die verwendet wird,
um den Standard OpenBSD Kernel f&uuml;r diese Architektur zu erzeugen.
Dort k&ouml;nnen sich ebenfalls andere Konfigurationsdateien befinden, die
Kernel erzeugen, die andere Ziele verfolgen, zum Beispiel minimalen RAM,
,diskless workstations', etc.

<p>
Die Konfigurationsdatei wird von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
verarbeitet, das ein Kompilationsverzeichnis in <tt>../compile</tt> erstellt
und einrichtet; bei einer typischen Installation w&auml;re es in
<tt>/usr/src/sys/arch/<i>&lt;arch&gt;</i>/compile/</tt>.  config(8) erstellt
ebenfalls eine
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1">Makefile</a>
und weitere Dateien, die f&uuml;r eine erfolgreiche Erstellung des Kernels
notwendig sind.

<p>
Kernelkonfigurationsoptionen bieten dir die M&ouml;glichkeit, zus&auml;tzliche 
Unterst&uuml;tzung zu deinem Kernel hinzuzuf&uuml;gen. Dies erlaubt dir nur
die von dir gew&uuml;nschten Ger&auml;te zu unterst&uuml;tzen. Es gibt eine
Vielzahl von M&ouml;glichkeiten, deinen Kernel auf deine W&uuml;nsche
abzustimmen. Hier werden wir nur auf einige der am h&auml;ufigsten benutzten
M&ouml;glichkeiten eingehen. 
Siehe die
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=options&amp;apropos=0&amp;sektion=4&amp;format=html">options(4)</a>
Manual Seite f&uuml;r eine komplette Liste der Optionen und, da diese sich
von Zeit zu Zeit &auml;ndert, solltest du sicherstellen, dass du auch eine
Manual Seite f&uuml;r die gleiche Version von OpenBSD verwendest, das du
erzeugst. Du kannst auch die Beispiel-Konfigurationsdateien
zu Rate ziehen, die f&uuml;r deine Architektur zur Verf&uuml;gung
stehen.

<p>
<b>&Auml;ndere, entferne oder f&uuml;ge niemals Optionen hinzu, wenn du
keinen triftigen Grund dazu hast!</b>  Die einzige Kernelkonfiguration,
die vom OpenBSD Team unterst&uuml;tzt wird, ist der GENERIC Kernel, die
eine Kombination der Optionen in
<tt>/usr/src/sys/arch/&lt;<i>arch</i>&gt;/conf/GENERIC</tt> und
<tt>/usr/src/sys/conf/GENERIC</tt> ist, <i>so, wie sie vom OpenBSD Team
bereit gestellt worden sind</i> (d.h. NICHT ver&auml;ndert). Das Melden
eines Fehlers, der mit einem modifizierten Kernel zustande kam, resultiert
meistens darin, dass dir gesagt wird, dass du versuchen sollst, das Problem
mit einem GENERIC Kernel zu reproduzieren. Nicht alle Optionen sind
kompatibel untereinander und viele Optionen sind notwendig, damit das
System l&auml;uft. Es besteht keine Garantie, dass ein Kernel l&auml;uft,
nur weil du ihn kompilieren konntest.

<p>
Hier kannst du die plattform-spezifischen Konfigurationsdateien sehen:
<ul>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/alpha/conf/">alpha Kernel Konfgurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/i386/conf/">i386 Kernel Konfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/macppc/conf/">macppc Kernel Konfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc/conf/">sparc Kernel Konfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/sparc64/conf/">sparc64 Kernel Konfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/vax/conf/">vax Kernel Konfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/hppa/conf/">hppa Kernel Konfigurationsdateien</a>
<li><a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/arch/">Andere Architekturen</a>
</ul>

<p>
Wenn du diese Dateien genauer betrachtest, dann wird dir am Anfang
eine Zeile wie diese auffallen:<br>
<pre>
     include "../../../conf/GENERIC"
</pre>
Dies bedeutet, dass ein Verweis auf eine andere
Konfigurationsdatei vorhanden ist, eine, die plattform-unabh&auml;ngige
Optionen beinhaltet. Wenn du also deinen eigenen Kernel konfigurieren willst,
stelle sicher, dass du auch
<a href="http://www.openbsd.org/cgi-bin/cvsweb/src/sys/conf/GENERIC">/sys/conf/GENERIC</a>
beachtet hast. Dort <b>sind</b> Optionen enthalten, die <b>ben&ouml;tigt</b>
werden.
<p>
Kernelkonfigurationsoptionen sollten in deiner
Kernelkonfigurationsdatei im Format von:<br>
<blockquote>
<tt>option&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</tt><i>Name</i>
</blockquote>
angef&uuml;hrt sein.
Die Optionen im OpenBSD Kernel werden in Kompilerpr&auml;prozessoroptionen
&uuml;bersetzt, daher w&uuml;rde eine Option wie DEBUG den Quelltext mit der
Option -DDEBUG kompilieren, was einem <tt>#define DEBUG</tt> im Kernel
entspricht.

<p>
Ab und zu m&ouml;chtest du vielleicht Optionen deaktivieren, die bereits
definiert wurden, typischerweise in der "<tt>src/sys/conf/GENERIC</tt>"
Datei. Obwohl du eine Kopie dieser Datei ver&auml;ndern k&ouml;nntest, ist
das Verwenden der <i>rmoption</i> Angabe eine bessere Wahl. Falls du
zum Beispiel den in-kernel Debugger deaktivieren m&ouml;chtest
(<i>nicht empfohlen!</i>), w&uuml;rdest du eine Zeile wie diese:
<pre>
     rmoption DDB
</pre>
in deine Kernelkonfigurationsdatei hinzuf&uuml;gen.  <tt>option DDB</tt>
ist in <tt>src/sys/conf/GENERIC</tt> definiert, aber die oben angegebene
<tt>rmoption</tt> Zeile deaktiviert sie wieder.

<p>
Noch einmal, bitte siehe
<a href="http:/www.openbsd.org/cgi-bin/man.cgi?query=options&amp;sektion=4">options(4)</a>
f&uuml;r weitere Informationen &uuml;ber die Spezifikationen dieser
Optionen. Bedenke auch, dass viele dieser Optionen ihre eigenen Manual
Seiten haben -- lese immer alles, was &uuml;ber eine Option verf&uuml;gbar
ist, bevor du sie zu deinem Kernel hinzuf&uuml;gst oder aus ihm entfernst.




<p>
<a name="Building"></a>
<h2>5.4 - Einen eigenen Kernel kompilieren</h2>

<p>
Vollst&auml;ndige Instruktionen zum Kreieren deines eigenen Kernels
findest du hier in
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=afterboot&amp;apropos=0&amp;sektion=8&amp;format=html">
afterboot(8)</a>.

<p>
Um deinen eigenen Kernel von CD-ROM zu kompilieren, musst
du zun&auml;chst den Quelltext haben.
Der Source ist sowohl auf der
<a href="../../de/orders.html">offiziellen CD</a> (Disk 3) als auch auf den
<a href="../../de/ftp.html">FTP Seiten</a> zu finden. Das folgende Beispiel
nimmt an, dass die CD3 unter /mnt gemountet ist:

<blockquote>
<pre>
# <strong>cd /usr/src</strong>
# <strong>tar xvzf /mnt/src.tar.gz</strong>
</pre>
</blockquote>

<b>Hinweis:</b> Wenn du den Source vom FTP Server herunterl&auml;dst,
wirst du ZWEI Dateien finden, <i>src.tar.gz</i> und <i>sys.tar.gz</i>.
Das erste ist das Userland -- alles bis auf den Kernel, das zweite ist
der Kernel Source. Lade beide runter und entpacke sie wie oben
beschrieben, in den meisten F&auml;llen willst du sowieso beide haben.
Auf der CD-ROM sind die beiden Dateien zu einer zusammengefasst.

<p>
Am einfachsten ist es, mit einem GENERIC
Kernel zu beginnen. Dieser befindet sich unter
<tt>/usr/src/sys/arch/${arch}/conf/GENERIC</tt>,
wobei ${arch} deine Architektur ist. In diesem Verzeichnis
befinden sich auch weitere Beispiel-Konfigurationen.
Hier sind zwei Beispiele f&uuml;r das Kompilieren deines Kernels.
Das erste Beispiel behandelt das Kompilieren von einem
Source tree, der nur Leseberechtigung hat. Das zweite
Beispiel zeigt, wie es auf einem Source tree mit
Schreibberechtigung funktioniert.

<blockquote>
<pre>
# <strong>cd /irgendwo</strong>
# <strong>cp /usr/src/sys/arch/$ARCH/conf/EINEDATEI .</strong>
# <strong>vi SOMEFILE</strong>   <i>(um die &Aauml;nderungen zu machen, die du m&ouml;chtest)</i>
# <strong>config -s /usr/src/sys -b . EINEDATEI</strong>
</pre>
entweder gefolgt von:

<pre>
    # <strong>make depend</strong>
         <b><i>- ODER -</i></b>
    # <strong>make clean && make depend</strong>
# <strong>make</strong>
</pre>
</blockquote>

Du solltest '<tt>make depend</tt>' laufen lassen, sobald du irgendwelche
&Auml;nderungen an deinem Source tree (einschlie&szlig;lich Updates und
Patches) gemacht hast (in anderen Worten nahezu immer).
Wenn config dir mitteilt, dass du ebenfalls '<tt>make clean</tt>'
ausf&uuml;hren sollst, mache das, bevor du '<tt>make depend</tt>'
aufrufst.


<p>
Wenn du &Auml;nderungen an deinen Kernelkonfigurationsoptionen
gemacht hast und/oder &Auml;nderungen an deinem Source tree, solltest
du '<tt>make clean</tt>' anstelle des obigen '<tt>made depend</tt>'
benutzen. Es ist immer besser 'make clean' zu benutzen, obwohl das
in l&auml;ngeren Kompilerl&auml;ufen resultieren kann, da eben mehr
erzeugt wird.

<p>
Um einen Kernel von einem Source tree mit Schreibberechtigung zu
bauen, tue folgendes:

<blockquote>
<tt>
# <strong>cd sys/arch/$ARCH/conf</strong>
# <strong>vi IRGENDEINEDATEI</strong> (um deine gew&uuml;nschten &Auml;nderungen durchzuf&uuml;hren)
# <strong>config IRGENDEINEDATEI</strong> (hier mehr dar&uuml;ber:
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;apropos=0&amp;sektion=8&amp;format=html">config(8)</a>)
# <strong>cd ../compile/IRGENDEINEDATEI</strong>
# <strong>make</strong>
</tt>
</blockquote>

<p>
Wobei $ARCH f&uuml;r die von dir benutzte Architektur steht (z.B. i386). Du
Du kannst auch ein <strong>make depend</strong> durchf&uuml;hren, um die
Abh&auml;ngigkeiten f&uuml;r das n&auml;chste Kernelkompilieren zu schaffen.

<p>
Jetzt muss der Kernel noch an den richtigen Platz:

<blockquote>
<pre>
# <strong>cp /bsd /bsd.old</strong>
# <strong>cp /sys/arch/$ARCH/compile/IRGENDEINEDATEI/bsd /bsd</strong>
</pre>
</blockquote>

Um deinen alten Kernel zu starten, musst du nur

<blockquote>
<pre>
boot&gt; <strong>bsd.old</strong>
</pre>
</blockquote>

beim Starten eingeben und dein alter Kernel wird anstelle von /bsd geladen.

<p>
Manchmal wirst du auch neue Bootbl&ouml;cke installieren m&uuml;ssen, wenn du
einen Kernel gebaut hast. Um dies zu tun, siehe
<a href="../faq14.html#InstBoot">FAQ 14.8, Installieren von Bootblocks</a>.
Dies wird dir eine &Uuml;bersicht vom Gebrauch des OpenBSD Bootloaders geben.

<p>
<a name="BootConfig"></a>
<h2>5.5 - Boot-time Konfiguration</h2>

<p>
Manchmal findet der Kernel beim Booten dein Ger&auml;t, aber eventuell den
falschen IRQ. Und vielleicht brauchst du dieses Ger&auml;t sofort. Nun, ohne
den Kernel neu zu bauen, kannst du mit der OpenBSD eigenen Boot-time
Konfiguration dieses Problem l&ouml;sen. Dies wird aber dein Problem nur
einmal l&ouml;sen. Wenn du rebootest, dann musst du diese Prozedur
wiederholen. Daher ist dies nur als vor&uuml;bergehende L&ouml;sung
gedacht und du solltest das Problem durch das Neukompilieren deines eigenen
Kernels l&ouml;sen. Dein Kernel wird <strong>option BOOT_CONFIG</strong>
ben&ouml;tigen, die GENERIC bereits beinhaltet.

<p>
Den Gro&szlig;teil dieses Dokumentes kannst du in der Manual Seite
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot_config&amp;apropos=0&amp;sektion=8&amp;format=html">boot_config(8)</a>
finden.

<p>
Um in die Benutzerkernelkonfiguration (User Kernel Config) oder
UKC zu gelangen, musst du die -c Option beim Hochfahren verwenden.

<blockquote><pre>
boot&gt; <strong>boot hd0a:/bsd -c</strong>
</pre></blockquote>

Oder welchen Kernel du auch immer laden willst. So kommst du in die
UKC. Hier kannst du Befehle ausf&uuml;hren, die kernelspezifische Ger&auml;te
&auml;ndern oder deaktivieren.

<p>
Hier eine Liste der g&auml;ngigen Befehle in der UKC.

<ul>
<li><tt>add <strong>device</strong></tt> - F&uuml;ge ein Ger&auml;t durch Kopieren eines anderen hinzu
<li><tt>change <strong>devno | device </strong></tt> - &Auml;ndere ein oder mehrere Ger&auml;te
<li><tt>disable <strong>devno | device </strong></tt> - Deaktiviere ein oder mehrere Ger&auml;te
<li><tt>enable <strong>devno | device </strong></tt> -  Aktiviere ein oder mehrere Ger&auml;te
<li><tt>find <strong>devno | device </strong></tt> - Suche ein oder mehrere Ger&auml;te
<li><tt>help</tt> - Kurze Zusammenfassung dieser Befehle
<li><tt>list</tt> - Liste ALLE bekannten Ger&auml;te auf
<li><tt>exit/quit</tt> - Setze das Starten fort
<li><tt>show <strong>[attr [val]]</strong></tt> - Zeige alle Ger&auml;te mit Eigenschaft
	(attr) und optional mit einem spezifierten Wert (val)
</ul>

<p>
Wenn du einmal dein Ger&auml;t konfiguriert hast, dann steige
mit quit oder exit aus UKC aus und setze das Starten fort.
Nun solltest du deine Kernelkonfiguration korrigieren
und einen eigenen Kernel kompilieren.
Siehe <a href="faq5.html#Building">Einen eigenen Kernel kompilieren
</a> f&uuml;r weitere Hilfe.

<p>
<a name="VerboseBoot"></a>
<h2>5.6 - Mehr Lognachrichten w&auml;hrend des Startens</h2>

Mehr Lognachrichten w&auml;hrend des Startens zu bekommen kann sehr
hilfreich sein, wenn man Bootprobleme l&ouml;sen will.
Wenn du ein Problem hast und du zu wenig Informationen beim Starten
erh&auml;lst, dann gib beim Starten bei "boot&gt;" wieder "-c" ein,
um zur UKC zu gelangen, dann:

<blockquote>
<pre>
UKC&gt; <strong>verbose</strong>
autoconf verbose enabled
UKC&gt; <strong>quit</strong>
</pre>
</blockquote>

<p>
Nun wirst du extrem ausf&uuml;hrliche Meldungen beim Booten erhalten.

<p>
<a name="config"></a>
<h2>5.7 - Mittels config(8) deinen Kernel ver&auml;ndern</h2>
<p>
Die <b>-e</b> und <b>-u</b> Optionen von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a>
k&ouml;nnen sehr hilfreich sein und Zeit sparen, die du mit dem
Neukompilieren von Kerneln verschwenden w&uuml;rdest.
Die <b>-e</b> Option erlaubt dir die UKC auf einem laufenden System zu
benutzen. Die &Auml;nderungen werden dann beim n&auml;chsten Reboot wirksam.
Die <b>-u</b> Option testet, ob irgendwelche &Auml;nderungen
am laufenden Kernel w&auml;hrend des Bootens gemacht wurden.
D.h., ob du mittels <b>boot -c</b> die UKC beim Starten benutzt hast.

<p>
Das folgende Beispiel zeigt das Deaktivieren des ep* Ger&auml;tes im
Kernel. Zur Sicherheit musst du die
<b>-o</b> Option benutzen, die die &Auml;nderung in die angegebene Datei
schreibt. Z.B.: <strong>config -e -o bsd.new /bsd</strong> wird die
&Auml;nderungen in bsd.new schreiben. Das folgende Beispiel verwendet die
<b>-o</b> Option nicht, daher werden die &Auml;nderungen einfach ignoriert
und nicht in eine Kernelbin&auml;rdatei geschrieben.
F&uuml;r weitere Informationen &uuml;ber Fehler- und Warnmeldungen
siehe die
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8&amp;format=html">config(8)</a>
Manual Seite.

<blockquote><pre>
$ <strong>sudo config -e /bsd</strong>
OpenBSD 3.5 (GENERIC) #25: Thu Oct  3 19:51:53 MDT 2002
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
warning: no output file specified
Enter 'help' f&uuml;r information
ukc&gt; ?
        help                            Command help list
        add         dev                 Add a device
        base        8|10|16             Base on large numbers
        change      devno|dev           Change device
        disable     attr val|devno|dev  Disable device
        enable      attr val|devno|dev  Enable device
        find        devno|dev           Find device
        list                            List configuration
        lines       count               # of lines per page
        show        [attr [val]]        Show attribute
        exit                            Exit, mitout saving changes
        quit                            Quit, saving current changes
        timezone    [mins [dst]]        Show/change timezone
        nmbclust    [number]            Show/change NMBCLUSTERS
        cachepct    [number]            Show/change BUFCACHEPERCENT
        nkmempg     [number]            Show/change NKMEMPAGES
        shmseg      [number]            Show/change SHMSEG
        shmmaxpgs   [number]            Show/change SHMMAXPGS
ukc&gt; <strong>list</strong>
  0 audio* at sb0|sb*|gus0|pas0|sp0|ess*|wss0|wss*|ym*|eap*|eso*|sv*|neo*|cmpci*|clcs*|clct*|auich*|autri*|auvia*|fms*|uaudio*|maestro*|esa*|yds*|emu* flags 0x0
  1 midi* at sb0|sb*|opl*|opl*|opl*|opl*|ym*|mpu*|autri* flags 0x0
  2 nsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
  3 nsphyter* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
  4 qsphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
  5 inphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
  6 iophy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
  7 eephy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
  8 exphy* at aue*|xe*|ef*|gx*|stge*|bge*|nge*|sk*|ste*|sis*|sf*|wb*|tx*|tl*|vr*|ne0|ne1|ne2|ne*|ne*|ne*|dc*|dc*|rl*|fxp*|fxp*|xl*|xl*|ep0|ep0|ep0|ep*|ep*|ep*|ep*|ep* phy -1 flags 0x0
[...snip...]
--- more ---   
[snip]
ukc&gt; <strong>disable ep</strong>
 67 ep0 disabled
 68 ep* disabled
 69 ep* disabled
155 ep0 disabled
156 ep0 disabled
157 ep* disabled
158 ep* disabled
210 ep* disabled
ukc&gt; <strong>quit</strong>
not forced
</pre></blockquote>

<p>
Im obigen Beispiel werden alle ep* Ger&auml;te im Kernel deaktiviert und
auch nicht abgefragt. In einigen Situationen, in denen du die UKC beim
Booten mittels <b>boot -c</b> benutzt hast, willst du diese &Auml;nderungen
dauerhaft niederschreiben. Daf&uuml;r brauchst du die <b>-u</b> Option.
Im folgenden Beispiel wurde die UKC gestartet und das
wi(4) Ger&auml;t deaktiviert. Da diese &Auml;nderung mit boot -c NICHT
dauerhaft ist, m&uuml;ssen die &Auml;nderungen erst geschrieben werden. Dieses
Beispiel schreibt die &Auml;nderung in boot -c in eine neue
Kernelbin&auml;rdatei namens bsd.new.

<blockquote><pre>
$ <strong>sudo config -e -u -o bsd.new /bsd</strong>
OpenBSD 3.5 (GENERIC) #25: Thu Oct  3 19:51:53 MDT 2002
    deraadt@i386.openbsd.org:/usr/src/sys/arch/i386/compile/GENERIC
Processing history...
105 wi* disabled
106 wi* disabled
Enter 'help' for information
ukc&gt; <strong>quit</strong>
</pre></blockquote>

<p>
<a name="buildprobs"></a>
<h2>5.8 - H&auml;ufige Probleme beim Kompilieren und Erzeugen des Systems</h2>

<a name="sig11"></a>
<h3>5.8.1 - Das Kompilieren bricht mit einem "Signal 11" Fehler ab</h3>

<p>
OpenBSD und andere Programme vom Source aus erzeugen ist eine Aufgabe, die
die Hardware st&auml;rker beansprucht als die meisten anderen, da
intensive Verwendung der CPU, Festplatte und des Speichers vorliegt. Als
Ergebnis, wenn du Hardware hast, die einen Fehler hat, ist der
wahrscheinlichste Zeitpunkt, dass sich das Problem bemerkbar macht, beim
Kompilieren. Signal 11 Fehler sind <i>typischerweise</i> durch Hardware
Probleme verursacht, sehr h&auml;ufig Speicher Probleme, k&ouml;nnen aber
auch CPU, Mainboard oder Hitze Probleme sein. Dein System mag ansonsten
sogar sehr stabil sein, aber nicht in der Lage, Programme zu kompilieren.

<p>
Du wirst es vermutlich am besten finden, wenn du die Komponente, die die
Fehler verursacht, reparierst oder austauschst, da Probleme sich auf
andere Art und Weise in Zukunft zeigen k&ouml;nnten. Falls du Hardware
hast, die du wirklich verwenden willst und sie dir sonst keine weiteren
Probleme bereitet, installiere einfach einen Snapshot oder ein Release.

<p>
Siehe <a href="http://www.bitwizard.nl/sig11/">Sig11 FAQ</a> f&uuml;r
sehr viel mehr Informationen.

<a name="snake"></a>
<h3>5.8.2 - "make build" schl&auml;gt mit "cannot open output file snake:
is a directory" fehl</h3>

Dies ist das Resultat von zwei separaten Fehlern:
<ul>
<li><b>Du hast deinen CVS tree nicht ordentlich heruntergeladen oder
aktualisiert.</b> Wenn du eine CVS checkout Operation durchf&uuml;hrst,
musst du die "<tt>-P</tt>" Option verwenden; wenn du deinen Source tree
mit CVS aktualisierst, musst du die "<tt>-Pd</tt>" Option mit
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1"
>cvs(1)</a> verwenden,
so wie in der <a href="../de/anoncvs.html">AnonCVS Anleitung</a>, der
<a href="upgrade-minifaq.html">upgrade-minifaq</a> und der
<a href="faq8.html#CVS">FAQ</a> beschrieben steht. Diese Optionen stellen
sicher, dass neue Verzeichnisse im tree erstellt und entfernt werden,
jenachdem wie sich OpenBSD entwickelt.

<li><b>Du hast vor dem ,build' das <tt>obj</tt> Verzeichnis nicht
ordnungsgem&auml;&szlig; erstellt. Den tree ohne einem <tt>/usr/obj</tt>
Verzeichnis zu Erzeugen ist nicht unterst&uuml;tzt.

</ul>
Es ist wichtig, den Instruktionen sorgf&auml;ltig zu folgen, wenn du
deinen Source Code <a href="../de/anoncvs.html">herunterl&auml;dst und
aktualisierst</a> und deinen tree <a href="upgrade-minifaq.html">erzeugst</a>.

<a name="BldRelease"></a>
<h2>5.9 - Wie erstelle ich ein OpenBSD Release?</h2>
Nachdem du dein System erzeugt hast, kannst du die OpenBSD
<a href="faq4.html#FilesNeeded">Datei Sets</a> erstellen, die verwendet
werden k&ouml;nnen, um dein System auf einem anderen Computer zu
installieren.

<p>
Dies ist in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=release&amp;sektion=8">release(8)</a>
erkl&auml;rt.


<p>
<font color= "#0000e0">
<a href= "index.html">[FAQ Index]</a>
<a href="faq4.html">[Zum Kapitel 4 - OpenBSD 3.5 Installationsanleitung]</a>
<a href="faq6.html">[Zum Kapitel 6 - Netzwerk]</a>
</font>


<p>
<hr>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt= "[zur&uuml;ck]"></a> 
<a href= "mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: faq5.html,v 1.96 ]
<br>
$Translation: faq5.html,v 1.50 2004/09/27 13:44:20 jufi Exp $
<br>
</small>
<small>$OpenBSD: faq5.html,v 1.47 2004/09/27 13:58:26 jufi Exp $</small>
</body>
</html>
