<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
   <meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
   <title>Mini-FAQ über das Upgraden von OpenBSD - Alte Releases</title>
</head>
<body bgcolor="#FFFFFF" text="#000000" link="#23238E">


<h1>MINI-FAQ: OpenBSD upgraden - Alte Releases</h1>
<h2>Hier aufgeführte Releases: 2.3 bis 4.1</h2>

<blockquote>
<p>
Dieses Dokument enthält Einträge der Mini-FAQ über das Upgraden von
OpenBSD-Releases, die nicht mehr aktiv unterstützt werden. Lies die
Seite <a href="current.html">Der Entwicklung von <i>-current</i>
folgen</a>, um Informationen für das aktuelle Release zu erhalten.
</p>
</blockquote>


<h2>1.0: Allgemeine Fragen über das Upgrade</h2>

<p>
<a href="#1.1">
1.1: Wo finde ich Informationen über aktuellere OpenBSD-Releases?
</a>
</p>

<h2>Von 4.0 auf 4.1 upgraden</h2>
<ul>
<li><a href="#20060926">2006-09-26 - Wechsel auf gcc3 (alpha)</a>
<li><a href="#20061006">2006-10-06 - »flags S/SA keep state« ist in
pf.conf(5) impliziert</a>
<li><a href="#20061011">2006-10-11 - Disklabel weder in FreeBSD- noch
NetBSD-Partitionen</a>
<li><a href="#20061012">2006-10-12 - Bootet nicht von
NetBSD-Partitionen</a>
<li><a href="#20061029">2006-10-29 - Neuer Benutzer für ripd(8)</a>
<li><a href="#20061227">2006-12-27 - Flagday für ARM (zaurus/armish)</a>
<li><a href="#20070131">2007-01-31 - Neuer Benutzer für hoststated(8)</a>
<li><a href="#20070202">2007-02-02 - Accounting wird nun während des
Bootvorgangs anders (de)aktiviert</a>
<li><a href="#20070226">2007-02-26 - spamd: standardmäßig Greylisting;
Konfigurationsdatei in /etc/mail</a>
</ul>

<h2>Von 3.9 auf 4.0 upgraden</h2>
<ul>
<li><a href="#20060327">2006-03-27 - Neue iwi(4)-Firmware</a>
<li><a href="#20060518">2006-05-18 - spppcontrol(8) wurde entfernt</a>
<li><a href="#20060526">2006-05-26 - ipsecadm(8) wurde entfernt</a>
<li><a href="#20060621">2006-06-21 - dvmrpd(8) wurde hinzugefügt</a>
<li><a href="#20060625">2006-06-25 - wicontrol(8) wurde entfernt</a>
<li><a href="#20060727">2006-07-27 - neue Kompileroption</a>
</ul>

<h2>Von 3.8 auf 3.9 upgraden</h2>
<ul>
<li><a href="#20050927">2005-09-27 - Die Erzeugungsphase benötigt eine
neue Funktionalität von xargs</a>
<li><a href="#20051006">2005-10-06 - Änderungen an MAKEDEV(8) und
ksh(1)</a>
<li><a href="#20051116">2005-11-16 - Neue Version von ftp-proxy(8)</a>
<li><a href="#20051216">2005-12-16 - libresolv wurde entfernt</a>
<li><a href="#20060104">2006-01-04 - mac68k-Wechsel auf wsconcs(4)</a>
<li><a href="#20060113">2006-01-13 - Typenänderungen</a>
<li><a href="#20060131">2006-01-31 - XKB-Konfigurationsupdates</a>
<li><a href="#20060221">2006-02-21 - Aktualisierungen an
ipsec.conf(5)</a>
</ul>

<h2>Von 3.7 auf 3.8 upgraden</h2>
<ul>
<li><a href="#20050329">2005-03-29 - Flagday für die Verarbeitung von
    Exceptions (i386)</a>
<li><a href="#20050331">2005-03-31 - Flagday für mmap(2) (vax)</a>
<li><a href="#20050413">2005-04-13 - Neuer Benutzer und neue Gruppe:
    _hostapd</a>
<li><a href="#20050527">2005-05-27 - Aus pf <i>log-all</i> wird <i>log
    (all)</i></a>
<li><a href="#20050601">2005-06-01 - mmap wird nun vom rlimit
    datasize berücksichtigt</a>
<li><a href="#20050609">2005-06-09 - Konfigurationsänderung vom bgpd</a>
<li><a href="#20050802">2005-08-02 - Neue Funktionalitäten in
    crunchgen</a>
<li><a href="#20050806">2005-08-06 - LC_CTYPE-Locales erzeugen</a>
<li><a href="#20050927">2005-09-27 - Die Erzeugungsphase benötigt eine
    neue Funktionalität von xargs</a>
<li><a href="#20051006">2005-10-06 - Änderungen an MAKEDEV(8) und
    ksh(1)</a>
</ul>


<h2>Von 3.6 auf 3.7 upgraden</h2>
<a href="#20041027">2004-10-27 - Flagday für die Verarbeitung von
    Exceptions (amd64, cats, hppa, sgi, sparc64)</a><br>
<a href="#20041029">2004-10-29 - Wechsel auf gcc3 (macppc)</a><br>
<a href="#20041111">2004-11-11 - Verhaltensänderung vom bgpd</a><br>
<a href="#20041124">2004-11-24 - Neuer Benutzer und neue Gruppe:
    _ftp</a><br>
<a href="#20041230">2004-12-30 - Wechsel auf gcc3 (i386)</a><br>
<a href="#20050118">2005-01-18 - Neuer Benutzer und neue Gruppe:
    _ospfd</a><br>
<a href="#20050124">2005-01-24 - pfsync nimmt syncdev statt
    syncif</a><br>
<a href="#20050202">2005-02-02 - POSIX-konforme hexadezimale und oktale
    Konstanten in (k)sh</a><br>
<p>

    <h2>Von 3.5 auf 3.6 upgraden</h2>
    <p>
      <a href="#3.5.1">3.5.1: Unternummern des pty-Devices
	  geändert</a><br>
      <a href="#3.5.2">3.5.2: Neuer Benutzer und neue Gruppe namens
	  _dhcp</a><br>
      <a href="#3.5.3">3.5.3: Neuer Benutzer und neue Gruppe namens
	  _mopd</a><br>
      <a href="#3.5.4">3.5.4: Neuer Benutzer und neue Gruppe namens
	  _tftpd</a><br>
      <a href="#3.5.5">3.5.5: Neuer Benutzer und neue Gruppe namens
	  _rbootd</a><br>
      <a href="#3.5.6">3.5.6: cksum nach /bin verschoben</a><br>
      <a href="#3.5.7">3.5.7: Neuer Benutzer und neue Gruppe namens
	  _afs</a><br>
      <a href="#3.5.8">3.5.8: Neuer Benutzer und neue Gruppe namens
	  _ppp</a><br>
      <a href="#3.5.9">3.5.9: Neuer Benutzer und neue Gruppe namens
	  _ntp</a><br>
      <a href="#3.5.10">3.5.10: Flagday für
	  Versionserhöhung der Bibliotheken</a><br>
      <a href="#3.5.11">3.5.11: Änderungen in PF-Anker</a><br>
    </p>

    <h2>Von 3.4 auf 3.5 upgraden</h2>
    <p>
      <a href="#3.4.1">3.4.1: Unternummern des svnd-Devices
          geändert</a><br>
      <a href="#3.4.2">3.4.2: Neuer Benutzer und neue Gruppe namens
          _pflogd</a><br>
      <a href="#3.4.3">3.4.3: Interfacecloning</a><br>
      <a href="#3.4.4">3.4.4: Neuer Benutzer und neue Gruppe namens
          _bgpd</a><br>
      <a href="#3.4.5">3.4.5: Neue Version von join(1)</a><br>
      <a href="#3.4.6">3.4.6: Übersetzungsänderung von sudo</a><br>
      <a href="#3.4.7">3.4.7: Neuer Benutzer und neue Gruppe namens
          _tcpdump</a><br>
      <a href="#3.4.8">3.4.8: Änderungen an machdep.c (i386)</a><br>
      <a href="#3.4.9">3.4.9: Aktualisierte bsd.own.mk</a><br>
      <a href="#3.4.10">3.4.10: Wechsel auf gcc3 (sparc64)</a><br>
    </p>

    <h2>Von 3.3 auf 3.4 upgraden</h2>

    <p>
      <a href="#3.3.1">3.3.1: W^X-Unterstützung für i386</a><br>
      <a href="#3.3.2">3.3.2: Änderung am mquery-syscall</a><br>
      <a href="#3.3.3">3.3.3: i386-Flagday: Änderung an exe
		addr/MAXDSIZ</a><br>
      <a href="#3.3.4">3.3.4: Entfernung der
		KerberosIV-Authentikation</a><br>
      <a href="#3.3.5">3.3.5: Änderung an config</a><br>
      <a href="#3.3.6">3.3.6: Verwende __attribute__((bounded)) bei
		bestimmten Funktionen</a><br>
      <a href="#3.3.7">3.3.7: Neuer Benutzer und neue Gruppe namens
		_syslogd</a><br>
      <a href="#3.3.8">3.3.8: Verwende das Formatattribut __kprintf__
		in Kernelheader</a><br>
    </p>

    <h2>Von 3.2 auf 3.3 upgraden</h2>

    <p>
      <a href="#3.2.1">3.2.1: Neues Perl</a><br>
      <a href="#3.2.2">3.2.2: Neue Gruppen: _radius, _token und
		_shadow</a><br>
      <a href="#3.2.3">3.2.3: Wichtige Compileränderungen</a><br>
      <a href="#3.2.4">3.2.4: Neuer Benutzer und neue Gruppe namens
		_spamd</a><br>
      <a href="#3.2.5">3.2.5: Alias für ipv6-icmp</a><br>
      <a href="#3.2.6">3.2.6: Neue Gruppe namens _lkm</a><br>
      <a href="#3.2.7">3.2.7: Neue libpthread</a><br>
      <a href="#3.2.8">3.2.8: Linkeränderungen für
		ELF-Architekturen</a><br>
      <a href="#3.2.9">3.2.9: Entfernung von /var/at und Änderungen an
		Crontabs</a><br>
    </p>

<h2>Von 3.1 upgraden</h2>

    <p>
      <a href="#3.1.1">3.1.1: Neue Benutzer/Gruppen</a><br>
      <a href="#3.1.2">3.1.2: NNeue Gruppe für crontab(1) und
		at(1)</a><br>
      <a href="#3.1.3">3.1.3: Neue Binutils</a><br>
      <a href="#3.1.4">3.1.4: Neue S/Key-Konfiguration</a><br>
      <a href="#3.1.5">3.1.5: Neue Rechte für lp*</a><br>
      <a href="#3.1.6">3.1.6: atrun(8) wird nicht mehr benötigt</a><br>
      <a href="#3.1.7">3.1.7: nat.conf in pf.conf eingebunden</a><br>
      <a href="#3.1.8">3.1.8: Neuer fbtab-Eintrag für xdm
		benötigt</a><br>
      <a href="#3.1.9">3.1.9: Verwende __attribute__((sentinel)) mit
		bestimmten Funktionen</a><br>
    </p>

<h2>Von 3.0 upgraden</h2>

    <p>
      <a href="#3.0.1">3.0.1: Neues Schlüsselwort wird von mtree(8)
		unterstützt</a><br>
      <a href="#3.0.2">3.0.2: Entfernung von libdl auf
		ELF-Plattformen</a><br>
      <a href="#3.0.3">3.0.3: Neues Regressionframework</a><br>
      <a href="#3.0.4">3.0.4: Konfigurationsdateien von ssh nach
		/etc/ssh/ verschoben</a><br>
    </p>

<h2>Von 2.9 upgraden</h2>

    <p>
    <a href="#2.9.1">2.9.1: Neue Benutzer/Gruppen: <em>proxy</em>,
		<em>smmsp</em> und <em>popa3d</em></a><br>
      <a href="#2.9.2">2.9.2: Neuer Paketfilter: <em>pf</em></a><br>
      <a href="#2.9.3">2.9.3: Änderungen an <em>make</em></a><br>
      <a href="#2.9.4">2.9.4: Erzeugung bricht wegen KerberosV-Fehlern
		ab</a><br>
      <a href="#2.9.5">2.9.5: Neue Version von <em>sendmail</em></a><br>
      <a href="#2.9.6">2.9.6: <tt>/etc/primes</tt> verschoben</a>
    </p>

<h2>Von 2.8 upgraden</h2>

    <p>
      <a href="#2.8.1">2.8.1: Neue Gruppe namens <em>auth</em></a><br />

      <a href="#2.8.2">2.8.2: Neues
		<em>wscons</em>-Konsolensystem</a><br />

      <a href="#2.8.3">2.8.3: Kernelkompilierung schlägt wegen
		undefinierten Symbolen fehl</a>
    </p>

<h2>Von 2.7 upgraden</h2>

<p>
<a href="#2.7.1">
2.7.1: Welche großen Probleme treten beim Upgrade von 2.7 auf 2.8 auf?
</a>
</p>

<h2>Von 2.6 upgraden</h2>

<p>
<a href="#2.6.1">
2.6.1: Termcap-Einträge sind zu lang.
</a> <br />

<a href="#2.6.2">
2.6.2: Mein <em>pn</em>- (oder <em>mx</em>-, <em>al</em>-,
<em>ax</em>-) Device wird nicht mehr vom Kernel erkannt.
</a> <br />

<a href="#2.6.3">
2.6.3: Von gcc 2.95.1 auf 2.95.2 upgraden
</a> <br />

<a href="#2.6.4">
2.6.4: Kerberos upgraden.
</a> <br />

<a href="#2.6.5">
2.6.5: M4 upgraden.
</a> <br />

<a href="#2.6.6">
2.6.6: Sendmail upgraden.
</a> <br />

<a href="#2.6.7">
2.6.7: Nach dem Upgraden booten die Kernel nicht mehr, die
Unterstützung für <em>apm(8)</em> beinhalten.
</a> <br />

<a href="#2.6.8">
2.6.8: Standardgruppe des Benutzers <em>daemon</em> geändert

</a>
</p>


<h2>Von 2.5 upgraden</h2>

<p>
<a href="#2.5.1">
2.5.1: Welche großen Probleme treten beim Upgrade von 2.5 auf 2.6 auf?
</a> <br />
<a href="#2.5.2">
2.5.2: Wie upgrade ich von <em>gcc</em> auf <em>egcs</em>
</a>
</p>

<blockquote>
<p>
<a href="#2.5.2.1">2.5.2.1 - i386 und sparc werden nicht mehr per
	#define definiert</a><br />
<a href="#2.5.2.2">2.5.2.2 - Erzeugungsphase bricht bei xlint
	ab</a><br />
<a href="#2.5.2.3">2.5.2.3 - Coredump bei uthread_autoinit.c</a><br />
<a href="#2.5.2.4">2.5.2.4 - egcs scheint viel langsamer zu sein als
	gcc</a><br />
<a href="#2.5.2.5">2.5.2.5 - egcs generiert größeren Code als
	gcc</a><br />
<a href="#2.5.2.6">2.5.2.6 - Nach der Installation von egcs hatte ich
	nur noch wenig Plattenspeicher übrig</a><br />
<a href="#2.5.2.7">2.5.2.7 - Meine Erzeugungsphase bricht während
	libcurses ab</a><br />
<a href="#2.5.2.8">2.5.2.8 - make obj schlägt fehl</a>
</p>
</blockquote>

<p>
<a href="#2.5.3">
2.5.3: Mein <em>make build</em> bricht mit Fehlern über
<em>unimplemented syscall</em> ab
</a> <br />

<a href="#2.5.4">
2.5.4: Verweis auf das neue 2.6-Verzeichnis.
</a> <br />

<a href="#2.5.5">
2.5.5: Nach einem <strong>(U)</strong>pgrade schlägt das Entpacken
von <em>base26.tar.gz</em> mit einer Meldung fehl.
</a>
</p>

<h2>Von 2.4 upgraden</h2>

<p>
<a href="#2.4.1">
2.4.1: Änderungen an den Manualseiten
</a> <br />

<a href="#2.4.2">
2.4.2: Syntax von <em>cap_mkdb</em> wurde geändert
</a> <br />

<a href="#2.4.3">
2.4.3: Snake
</a>
</p>

<h2>Von 2.3 upgraden</h2>

<p>
<a href="#2.3.1">
2.3.1: Neuer Benutzer: <em>named</em>
</a> <br />

<a href="#2.3.2">
2.3.2:  Ich habe versucht, das System zu erzeugen, doch schlägt der
Prozess fehl, wenn <em>ssleay</em> kompiliert werden soll.
</a> <br />

<a href="#2.3.3">
2.3.3: Ich habe versucht, dass System zu erzeugen, doch schlägt der
Prozess fehl, wenn ich das System für die PowerPC-Architektur erstelle.
</a>
</p>


&nbsp;<hr width="30%">

<a name="1.0"></a>
<h2>1.0: Allgemeine Fragen über das Upgrade</h2>


<a name="1.1"></a>
<h3>
1.1: Wo finde ich Informationen über aktuellere OpenBSD-Releases?
</h3>
<p>
Lies die Seite <a href="current.html">Der Entwicklung von
<i>-current</i> folgen</a>.
</p>

<a name=4.0"></a>
<h2>Von 4.0 auf 4.1 upgraden</h2>
<a name="20060926"></a>
<h3>2006-09-26 - Wechsel auf gcc3 (alpha)</h3>
OpenBSD/alpha wechselte auf gcc3. Um upzugraden:
<pre>
    # rm -rf /usr/include/g++
    # cp /usr/src/share/mk/bsd.own.mk /usr/share/mk/
</pre>
Als nächstes muss <a href="faq5.html#NewCompiler">gcc3 übersetzt
werden</a> (im gcc3-Verzeichnis), dann der neue ld.so:
<pre>
    cd /usr/src/libexec/ld.so
    make clean
    make obj
    make depend
    make
    make install
</pre>

Übersetze nun den Kernel und das System wie
<a href="faq5.html#Bld">gewohnt</a>.
<p>

<a name="20061006"></a>
<h3>2006-10-06 - »flags S/SA keep state« ist in pf.conf(5)
impliziert</h3>
<i>flags S/SA keep state</i> ist nun Standard für pass-Regeln in
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5">pf.conf(5)</a>.
Des Weiteren wurden die beiden Optionen <i>no state</i> und <i>flags
any</i> so umgestellt, dass sie diesen Standard überschreiben. Aktuelle
Regelsätze können weiterhin geladen werden, doch wird sich ihr Verhalten
geringfügig ändern, da diese Standard restriktiver sind. Regelsätze, die
ohne Zustand filtern (<i>no state</i>) oder Zustände (states) für
Zwischenpakete erstellen müssen (<i>flags any</i>, sollten aktualisiert
werden, um ausdrücklich das gewünschte Verhalten zu erzielen.

<p>
Vor allem beim
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=enc&amp;sektion=4">enc0</a>-Interface
ist besondere Vorsicht geboten, da Floatingstates ein potentielles
Problem für die Filterung von IPsec-Traffic darstellen: Zustände,
müssen an ein Interface gebunden werden, um unverschlüsselten
Datenverkehr zu verhindern, sollte
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=isakmpd&amp;sektion=8">isakmpd(8)</a>
beendet werden. Daher sollten alle Regeln für das enc0-Interface
explizit mit <i>keep state (if-bound)</i> versehen werden.
<p>

<a name="20061011"></a>
<h3>2006-10-11 - Disklabel weder in FreeBSD- noch NetBSD-Partitionen</h3>
<i>FreeBSD- und NetBSD-DOS-MBR-Partitionen</i> werden nicht mehr
verwendet, um Disklabels abzulegen - daher werden sie auch nicht mehr
nach Disklabels durchsucht. Festplatten, auf denen sich nur FreeBSD-
oder NetBSD-DOS-MBR-Partitionen befinden, werden keine »a«-Partition
mehr im vorgetäuschten Disklabel auflisten. Das Disklabel solcher
Platten wird im Sektor 1 gespeichert und aus diesem geladen. Beim Laden
dieses Sektors könnte aber ein altes Disklabel gefunden werden. Verwende
fdisk(8), um den Partitionstyp auf OpenBSD (»A6«) umzustellen. Auf
diese Weise kannst du das bestehende Disklabel verwenden.

<p>

<a name="20061012"></a>
<h3>2006-10-12 - Bootet nicht von NetBSD-Partitionen</h3>
<i>amd64, i386, macppc und mvmeppc</i> versuchen nicht länger, von der
ersten NetBSD-Partition zu booten, wenn keine OpenBSD-Partition gefunden
wurde.
<p>

<a name="20061029"></a>
<h3>2006-10-29 - Neuer Benutzer für ripd(8)</h3>
<i>Ein neuer RIP-Daemon wurde eingebunden</i>. Für die Verwendung des
Daemons werden ein neuer Benutzer und eine neue Gruppe benötigt.

Für den folgenden Benutzer und die folgende Gruppe als <i>root</i>

mit
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>
hinzu:

<blockquote><pre>
# useradd -u88 -g=uid -c"RIP Daemon" -d/var/empty -s/sbin/nologin _ripd
</pre></blockquote>

Mit diesem Schritt werden sowohl der neue Benutzer als auch die zu
ihm gehörende Gruppe hinzugefügt. Eventuell kannst du in deiner
Arbeitsumgebung Copy&Paste für die Zeile verwenden.
<p>

<a name="20061227"></a>
<h3>2006-12-27 - Flagday für ARM (zaurus/armish)</h3>
<i>Der syscall-Mechanismus für arm wurde geändert</i>, wodurch
Binarys und Shared Librarys, die vor dem 7. November erzeugt wurden,
nicht länger funktionieren. Es ist notwendig, das System über einen
Snapshot zu aktualisieren, um diese ABI-Änderung zu überwinden.

<p>

<a name="20070131"></a>
<h3>2007-01-31 - Neuer Benutzer für hoststated(8)</h3>
<i>Ein HostState-Daemon wurde eingeführt</i>. Um diesen verwenden zu
könnnen, müssen ein neuer Benutzer und eine neue Gruppe erstellt
werden.

Führe als <i>root</i>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=useradd&amp;sektion=8">useradd(8)</a>
aus, um den folgenden Benutzer und die Gruppe hinzuzufügen:

<blockquote><pre>
# useradd -u89 -g=uid -c"HostState Daemon" -d/var/empty -s/sbin/nologin _hoststated
</pre></blockquote>

Mit diesem Schritt werden sowohl der neue Benutzer als auch die zu
ihm gehörende Gruppe hinzugefügt. Eventuell kannst du in deiner
Arbeitsumgebung Copy&Paste für die Zeile verwenden.

<p>

<a name="20070202"></a>
<h3>2007-02-02 - Accounting wird nun während des Bootvorgangs anders
(de)aktiviert</h3>
Um Accouting während des Bootvorgangs zu aktivieren, setze die neue
rc.conf-Variable »accouting=YES«. Das Vorhandensein der Datei
/var/account/acct führt nicht länger zum automatischen Start.
<p>

<a name="20070226"></a>
<h3>2007-02-26 - spamd: standardmäßig Greylisting; Konfigurationsdatei
in /etc/mail</h3>
<p>
Greylisting ist nun der standardmäßige Laufzeitmodus für spamd(8); die
Option <tt>-g</tt> ist überflüssig. Um Greylisting zu deaktiveren und
nur noch im Blacklistmodus zu laufen, muss die Option <tt>-b</tt>

übergeben werden. Mit der neuen Option <tt>-l</tt> wird angegeben, auf
welcher Adresse spamd lauschen soll.

<p>
spamd-setup(8) kann ebenfalls nur im Blacklistmodus laufen, indem die
neue Option <tt>-b</tt> übergeben wird.

<p>
Die spamd.conf(5)-Datei wurde von <tt>/etc</tt> in <tt>/etc/mail</tt>
verschoben.


<p>
Lies bitte die Manualseiten für
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8">spamd(8)</a>
und
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd-setup&amp;sektion=8">spamd-setup(8)</a>
um alle Details zu erfahren.




<a name="3.9"></a>
<h2>Von 3.9 auf 4.0 upgraden</h2>

<a name="20060327"></a>
<h3>2006-03-27 - Neue iwi(4)-Firmware</h3>
iwi(4) setzt nun die Firmwareversion 3.0 voraus. Aufgrund von
Lizenzproblemen kann die Firmware momentan nicht mit OpenBSD
ausgeliefert werden. Die Firmware kann als Package
<a href="http://damien.bergamini.free.fr/iwifw/OpenBSD/iwi-firmware-3.0.tgz">http://damien.bergamini.free.fr/iwifw/OpenBSD/iwi-firmware-3.0.tgz</a>

mit den pkg-Werkzeugen installiert werden.
<p>


<a name="20060518"></a>
<h3>2006-05-18 - spppcontrol(8) wurde entfernt</h3>
Die Konfiguration vom In-Kernel-PPP wird nun vollständig von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a>
unterstützt.
Das überholte Werkzeug
<em><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spppcontrol&amp;sektion=8&amp;manpath=OpenBSD+3.9">spppcontrol(8)</a></em>
wurde aus dem Tree entfernt.
Wirf einen Blick auf die beiden Manualseiten
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sppp&amp;sektion=4">sppp(4)</a>
und
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pppoe&amp;sektion=4">pppoe(4)</a>
wenn du Konfigurationsbeispiele sehen möchtest.
<p>
Bisher sah die /etc/hostname.pppoe0-Datei wie folgt aus:
<pre>
pppoedev ne0
!/sbin/ifconfig ne0 up
!/usr/sbin/spppcontrol \$if myauthproto=pap myauthname=testcaller \
        myauthkey=donttell
!/sbin/ifconfig \$if inet 0.0.0.0 0.0.0.1 netmask 0xffffffff
!/sbin/route add default 0.0.0.1
up
</pre>
Diese Datei sollte mit dem folgenden Beispiel ersetzt werden:
<pre>
inet 0.0.0.0 255.255.255.255 0.0.0.1 pppoedev ne0 \
	authproto pap authname testcaller authkey donttell up
!/sbin/route add default 0.0.0.1
</pre>
Das physikalische Interface muss ebenfalls auf UP gesetzt werden:
<pre>
# echo "up" > /etc/hostname.ne0
</pre>
<p>

<a name="20060526"></a>
<h3>2006-05-26 - ipsecadm(8) wurde entfernt</h3>
IPsec-Konfiguration wird nun vollständig von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsecctl&amp;sektion=8">ipsecctl(8)</a>
unterstützt. Das nun überflüssige
<em><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsecadm&amp;sektion=8&amp;manpath=OpenBSD+3.9">ipsecadm(8)</a></em>-Werkzeug
wurde daher aus dem Tree entfernt.
Wirf einen Blick auf die
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec.conf&amp;sektion=5">ipsec.conf(5)</a>-Manualseite
für Konfigurationsbeispiele.
<p>

<a name="20060621"></a>
<h3>2006-06-21 - dvmrpd(8) wurde hinzugefügt</h3>
Es wurde mit einem mrouted(8)-Ersatz begonnen und importiert. Damit
dieser (Hinweis: bisher nicht sonderlich funktionsreiche) neue
Daemon genutzt werden kann, muss der Benutzer _dvmrpd hinzugefügt
werden:<p>
<pre>
# useradd -u87 -g=uid -c"DVMRP Daemon" -d/var/empty -s/sbin/nologin _dvmrpd
</pre>

<a name="20060625"></a>
<h3>2006-06-25 - wicontrol(8) wurde entfernt</h3>
Drahtloskonfiguration für
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wi&amp;sektion=4">wi(4)</a>
wird nun vollständig von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a>
unterstützt. Das nun überflüssige
<em><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wicontrol&amp;sektion=8&amp;manpath=OpenBSD+3.9">wicontrol(8)</a></em>-Werkzeug
wurde aus dem Tree entfernt.

<p>

<a name="20060727"></a>
<h3>2006-07-27 - neue Kompileroption</h3>
Auf allen Plattformen wird der Kernel nun mit der vor kurzem
hinzugefügten Kompileroption <i>-Wstack-larger-than</i> erzeugt.
Bevor ein Kernel erzeugt werden kann, muss der Kompiler daher neu
erzeugt und installiert werden.

<p>
Folge den Anweisungen unter
<a href="faq5.html#NewCompiler">FAQ 5 - Wie führe ich ein Bootstrap für
eine neue Version des Kompilers (gcc) aus?</a> für weiterführende
Informationen.
<p>

<a name="3.8"></a>
<h2>Von 3.8 auf 3.9 upgraden</h2>
<p>
<a name="20050927"></a>
<h3>2005-09-27 - Die Erzeugungsphase benötigt eine neue Funktionalität
von xargs</h3>

Übersetze und installiere xargs(1).
<pre>
     # cd /usr/src/usr.bin/xargs && make obj && make && make install
</pre>
Führe dann make build aus.

<p>
<a name="20051006"></a>
<h3>2005-10-06 - Änderungen an MAKEDEV(8)</h3>

Änderungen wurden an MAKEDEV gemacht, um dessen Geschwindigkeit
deutlich zu verbessern. Diese Änderungen bauen auf den Änderungen auf,
die zuvor an ksh gemacht wurden. Installationsmedien, die vor diesem
Tag erstellt wurden, können daher nicht mehr verwendet werden.
<br>

<p>
<a name="20051116"></a>
<h3>2005-11-16 - Neue Version von ftp-proxy(8)</h3>

Der ftp-proxy wurde durch den Proxy ersetzt, der zuvor pftpx genannt
wurde. Der neue ftp-proxy läuft nun selbstständig und muss nicht mehr
von inetd.conf aus aufgerufen werden, wie das zuvor der Fall war.
<p>
Dies ist die Upgradeanleitung:
<p>
Beende den alten ftp-proxy, indem du eine neue /etc/inetd.conf
installierst oder einfach per Hand den Eintrag aus der /etc/inetd.conf
entfernst oder kommentierst.

<pre>
cp /usr/src/etc/inetd.conf /etc/inetd.conf
</pre>

Sende dann ein HUP-Signal an inetd mittels kill:
<p>
<pre>
kill -HUP `cat /var/run/inetd.pid`
</pre>

Starte den neuen ftp-proxy, indem du das neue
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc&amp;sektion=8"><i>/etc/rc</i></a>-Skript
und die neue
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rc.conf&amp;sektion=8"><i>/etc/rc.conf</i></a>
installierst und danach ftpproxy_flags="" in /etc/rc.conf.local
einträgst.

<pre>
cp /usr/src/etc/{rc,rc.conf} /etc
echo 'ftpproxy_flags=""' >> /etc/rc.conf.local
</pre>

Alternativ dazu kann er gestartet werden, indem einfach
/usr/sbin/ftp-proxy in /etc/rc.local aufgerufen wird.
<p>

Der neue Proxy verwendet
<a href="../pf/de/anchors.html"><i>Anker</i></a>, um Datenverbindungen
zu erlauben. Das bedeutet, dass
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf.conf&amp;sektion=5"><i>/etc/pf.conf</i></a>
angepasst werden muss. In der NAT-Sektion benötigt man:
<p>

<pre>
nat-anchor "ftp-proxy/*"
rdr-anchor "ftp-proxy/*"
</pre>

Diese sind notwendig selbst wenn du sonst kein NAT verwendest. Die
folgende Regel, die eventuell schon für den alten ftp-proxy eingetragen
wurde, muss bleiben:
<pre>
rdr pass on $int_if proto tcp from $lan to any port 21 -> \
    127.0.0.1 port 8021
</pre>

In dieser Regelsektion wird Folgendes benötigt:

<pre>
anchor "ftp-proxy/*"
</pre>

Regeln, die dem Proxy erlauben, FTP-Kontrollverbindungen
(Zielport 21/tcp) aufzubauen, müssen bleiben. Regeln, die
FTP-Datenverbindungen erlauben, werden nicht länger benötigt. Derartige
Regeln können Begriffe wie »user proxy« oder »to port > 49151«
enthalten.

Die übergebenen Kommandoparameter müssen auf ähnliche Weise
sorgfältig überprüft werden, da sich einige geändert haben könnten.
Siehe in der Manualseite von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8">ftp-proxy</a>
nach.
<p>

Ein Fall muss besonders hervorgehoben werden: wenn du alte Clients hast,
die auf Datenverbindungen im aktiven Modus aufbauen (20/tcp als
Quellport), muss der Parameter -r übergeben werden (den alten Proxy
musste man in diesem Fall mit »-u root« aufrufen).
<p>
Führe ftp-proxy mit »-d -D7« aus, wenn du Probleme hast und untersuchen
möchtest, was gerade passiert.

<p>
<a name="20051216"></a>
<h3>2005-12-16 - libresolv wurde entfernt</h3>

Du musst libresolv von deiner Maschine entfernen, da sie nicht länger
installiert wird.
<pre>
     # rm /usr/lib/libresolv*
</pre>

<p>
<a name="20060104"></a>
<h3>2006-01-04 - mac68k-Wechsel auf wscons(4)</h3>
Vor dem Reboot mit dem neuen Kernel müssen Systemdateien für
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=wscons&amp;sektion=4">wscons(4)</a>
aktualisiert werden.

<pre>
     # cp /usr/src/etc/etc.mac68k/MAKEDEV /dev
     # cd /dev &amp;&amp; sh ./MAKEDEV wscons
</pre>

<p>
Ändere in <tt>/etc/ttys</tt> das getty <em>ttye0</em> in <em>ttyC0</em>
und reboote nun mit dem neuen Kernel.
</p>

<p>
<a name="20060113"></a>
<h3>2006-01-13 - Typenänderungen</h3>
Bevor ein »make build« aufgerufen werden kann, muss der Kompiler neu
übersetzt und installiert werden. Sollte dies nicht geschehen, kann
libstdc++ nicht erzeugt werden.

<p>
Folge den Instruktionen, die in <a href="faq5.html#NewCompiler">FAQ
5 - Wie führe ich ein Bootstrap für eine neue Version des Kompilers
aus?</a> aufgeführt werden, um weitere Details zu erfahren.

<a name="20060131"></a>
<h3>2006-01-31 - XKB-Konfigurationsupdates</h3>
Mit der Einbindung von X.Org 6.9 hat sich die XKB-Konfiguration
geändert, so dass Änderungen in /etc/X11/xorg.conf nötigt sind. Die
wichtigsten Änderungen sind:
<ul>
<li>Das <b>us_intl</b>-Layout wurde mit der <b>alt-intl</b>-Variante
des <b>us</b>-Layouts ersetzt.
Aktualisiere die verwendete Konfigurationsdatei:
<pre>
      Option "XkbLayout" "us"
      Option "XkbVariant" "alt-intl"
</pre>
<li>Die Layouts <b>de_CH</b> und <b>fr_CH</b> wurden gegen das
<b>ch</b>-Layout mit den Varianten <b>de</b> und <b>fr</b>
ausgewechselt:
<pre>
      Option "XkbLayout" "ch"
      Option "XkbVariant" "de"
</pre>
</ul>
<p>

<a name="20060221"></a>
<h3>2006-02-21 - Aktualisierungen an ipsec.conf(5)</h3>
Wenn <b>ike rules</b> keine Parameter für den Hauptmodus (main mode)
beinhalten, dann wird
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsecctl&amp;sektion=8">ipsecctl(8)</a>
nun AES statt 3DES als Verschlüsselung für den Hauptmodus wählen.
Um mit Peers arbeiten zu können, die -stable verwenden, müssen diese
Werte in ihre
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ipsec.conf&amp;sektion=5">ipsec.conf(5)</a>-Dateien
eingefügt werden, damit sie sich dem neuen Standard anpassen:
<pre>
        main auth hmac-sha1 enc aes
</pre>
<p>


<a name="3.7"></a>
<h2>Von 3.7 auf 3.8 upgraden</h2>


<p>
<a name="20050329"></a>
<h3>2005-03-29 - Flagday für die Verarbeitung von Exceptions (i386)</h3>

OpenBSD/i386 wurde auf die DWARF-basierte Verarbeitung von Exceptions
umgestellt. Um upzugraden musst du zunächst
<a href="faq5.html#NewCompiler">gcc3 übersetzen und installieren</a> und
dann eine neue Version der libstdc++ installieren:
<pre>
     # cd /usr/src/gnu/lib/libstdc++
     # make -f Makefile.bsd-wrapper cleandir
     # make -f Makefile.bsd-wrapper obj
     # make -f Makefile.bsd-wrapper
     # make -f Makefile.bsd-wrapper install
</pre>

<p>


<a name="20050331"></a>
<h3>2005-03-31 - Flagday für mmap(2) (vax)</h3>

Die Begrenzung des virtuellen Speichers hat sich für OpenBSD/vax
geändert. Die Tatsache, dass OpenBSD/vax statisch gelinkt wird, setzt
eine spezielle Vorgehensweise voraus. Die folgenden Schritte müssen
befolgt werden, um ein brauchbares System zu erzeugen.
<ul>
<li>Aktualisiere deinen Source-Tree
<li>Erzeuge und installiere einen neuen Kernel; starte aber noch nicht
    neu
<li>Übersetze und installiere eine neue libc.
<pre>
     # cd /usr/src/lib/libc && make depend && make && env NOMAN=1 make install
</pre>
<li><a href="faq5.html#NewCompiler">Übersetze und installiere gcc2</a>
<li>Übersetze und installiere ein neues make:
<pre>
     # cd /usr/src/usr.bin/make && make depend && make && make install
</pre>
<li>Übersetze und installiere neue binutils:
<pre>
    # cd /usr/src/gnu/usr.bin/binutils
    # make -f Makefile.bsd-wrapper depend
    # make -f Makefile.bsd-wrapper
    # make -f Makefile.bsd-wrapper install
</pre>
<li>Starte neu.
<li>Erzeuge und installiere das System wie gewohnt:
<pre>
    # cd /usr/src && make build
</pre>
</ul>

<p>
<a name="20050413"></a>
<h3>2005-04-13 - Neuer Benutzer und neue Gruppe: _hostapd</h3>
Der neue, privilegiengetrennte HostAP-Daemon benötigt einen neuen
Benutzer und eine neue Gruppe mit dem Namen _hostapd. Füge den Benutzer
und die Gruppe hinzu, indem du

<pre>
    useradd -u86 -g=uid -c"HostAP Daemon" -d/var/empty -s/sbin/nologin _hostapd
</pre>
als root ausführst.


<p>
<a name="20050527"></a>
<h3>2005-05-27 - Aus pf <i>log-all</i> wird <i>log (all)</i></h3>

Das pf.conf(5)-Schlüsselwort <i>log-all</i> wurde entfernt. Die neue
Syntax für diese Funktionalität ist nun <i>log (all)</i>.


<p>
<a name="20050601"></a>
<h3>2005-06-01 - mmap wird nun vom rlimit datasize berücksichtigt</h3>

Anonyme Speicherallokierung mittels mmap(2) wird nun bei der Auswertung
der Ressourcenbegrenzung für die Datengröße von Prozessen
berücksichtigt. Daraus folgt, dass Prozesse nun scheinbar mehr Speicher
als sonst in Anspruch nehmen; die alten Ressourcenbegrenzungen könnten
somit zu klein sein. Um das Problem mit den Ressourcenbegrenzungen zu
lösen, aktualisiere die <tt>/etc/login.conf</tt>:
<pre>
     # cd /usr/src/etc
     # cp login.conf /etc
</pre>
Melde dich danach ab und und wieder an.


<p>
<a name="20050609"></a>
<h3>2005-06-09 - Konfigurationsänderung vom bgpd</h3>

Die bgpd.conf(5)-Schlüsselwörter <i>network connected [set ...]</i> und
<i>network static [set ...]</i> sind veraltet. Sie sollten jeweils mit
<i>network inet connected [set ...]</i> und <i>network inet static [set
...]</i> ausgetauscht werden.


<p>
<a name="20050802"></a>
<h3>2005-08-02 - Neue Funktionalitäten in crunchgen</h3>

Eine Aktualisierung von crunchgen(1) fand statt, um zusätzliche
Bibliotheksverzeichnisse zu verarbeiten. Starte unbedingt neu und
installiere wieder crunchgen, bevor du ein Release oder eines der
Installationsmedien erstellst.


<p>
<a name="20050806"></a>
<h3>2005-08-06 - LC_CTYPE-Locales erstellen</h3>

Übersetze und installiere mklocale(1).
<pre>
     # cd /usr/src/usr.bin/mklocale && make obj && make depend && make && make install
</pre>
Führe danach make build aus.



<a name="3.6"></a>
<h2>Von 3.6 auf 3.7 upgraden</h2>

<a name="20041029"></a>
<h3>2004-10-29 - Wechsel auf gcc3 (macppc)</h3>
OpenBSD/macppc wurde auf gcc3 umgestellt.
Um upzugraden, Folgendes ausführen:
<pre>
    # rm -rf /usr/include/g++
</pre>

Als nächstes muss <a href="faq5.html#NewCompiler">gcc3 erzeugt
werden</a> (unter Verwendung des gcc3-Verzeichnisses) und danach
wie <a href="faq5.html#Bld">gewöhnlich</a> der Kernel und das System.

<a name="20041111"></a>
<h3>2004-11-11 - Verhaltensänderung vom bgpd</h3>
Das neue <i>rde route-age [evaluate|ignore]</i> änderte das Verhalten
vom bgpd. Bisher war <i>evaluate</i> der implizierte Standard; jetzt
ist es <i>ignore</i>. Die Auswertung des Routenalters wird nicht im
RFC 1771 bestimmt. Das resultiert nun in nicht deterministischen
Entscheidungen im Vorzug für stabiliere Verbindungen.


<a name="20041124"></a>
<h3>2004-11-24 - Neuer Benutzer und neue Gruppe: _ftp</h3>
Der FTP-Daemon wird überarbeitet, um Privilegientrennung zu verwenden.
Aus diesem Grund ist ein neuer Benutzer und eine neue Gruppe mit dem
Namen _ftp notwendig. Füge den Benutzer und die Gruppe hinzu, indem du

<pre>
    useradd -u84 -g=uid -c"FTP Daemon" -d/var/empty -s/sbin/nologin _ftp
</pre>
als root aufrufst.


<a name="20041230"></a>
<h3>2004-12-30 - Wechsel auf gcc3 (i386)</h3>
OpenBSD/i386 wurde auf gcc3 umgestellt.
Um upzugraden, führe Folgendes aus:

<pre>
    # rm -rf /usr/include/g++
</pre>

Als nächstes muss <a href="faq5.html#NewCompiler">gcc3 erzeugt
werden</a> (unter Verwendung des gcc3-Verzeichnisses) und danach
wie <a href="faq5.html#Bld">gewöhnlich</a> der Kernel und das System.

<p>

<a name="20050118"></a>
<h3>2005-01-18 - Neuer Benutzer und neue Gruppe: _ospfd</h3>
Der bald erscheinende ospf-Daemon benötigt seinen eigenen Benutzer und
seine eigene Gruppe namens _ospfd.
Füge sie hinzu, indem du

<pre>
    useradd -u85 -g=uid -c"OSPF Daemon" -d/var/empty -s/sbin/nologin _ospfd
</pre>
als root ausführst.


<a name="20050124"></a>
<h3>2005-01-24 - pfsync nimmt syncdev statt syncif</h3>
Wenn das
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfsync&amp;sektion=4">pfsync</a>-Device
konfiguriert wird, so muss syncdev statt dem veralteten Schlüsselwort
syncif genutzt werden.


<a name="20050202"></a>
<h3>2005-02-02 - POSIX-konforme hexadezimale und oktale Konstanten in
(k)sh</h3>
Sowohl
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sh&amp;sektion=1">sh(1)</a>
als auch
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ksh&amp;sektion=1">ksh(1)</a>
interpretieren nun C-ähnliche hexadezimale (0x...) und oktale (0...)
Konstanten in arithmetischen Ausdrücken. Daraus folgt, dass das
MAKEDEV-Skript aktualisiert werden muss:
<pre>
     # cp /usr/src/etc/etc.`machine`/MAKEDEV /dev
</pre>

<p>


<p>
    <a name="3.5"></a>
    <h2>
      Von 3.5 auf 3.6 upgraden
    </h2>

    <a name="3.5.1"></a>
    <h3>
      3.5.1: Unternummern des pty-Devices geändert (2004-04-11)
    </h3>
    <p>
      Die Unternummern des Devices
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pty&amp;sektion=4">pty</a>
      wurde geändert, um die maximale Anzahl der Pseudoterminals von 256
      auf 992 zu erhöhen, so dass du eine aktualisierte
      <tt>/dev/MAKEDEV</tt> ausführen musst, bevor der neue Kernel
      gebootet werden kann:
        <ul>
	  <li>Aktualisiere deinen Source-Tree
	  <li>Übersetze und installiere einen neuen Kernel
	  <li>Erzeuge das restliche System (<em>make build</em>)
	  <li>Kopiere das neue MAKEDEV-Skript in das
	      <tt>/dev</tt>-Verzeichnis und erstelle die neuen
	      pty-Devices.
<pre>
     # cp /usr/src/etc/etc.`machine`/MAKEDEV /dev
     # cd /dev && ./MAKEDEV pty0
</pre>
	  <li>Boote den neuen Kernel
	  <li>Entferne die alten pty-Devices, die nicht länger genutzt
	      werden:
<pre>
     # cd /dev && rm -f [pt]ty[rq]*
</pre>
	  <li>Oder aber auf Folgendes auf der VAX-Plattform:
<pre>
     # cd /dev && rm -f [pt]tyr*
</pre>
        </ul>

    <a name="3.5.2"></a>
    <h3>
      3.5.2: Neuer Benutzer und neue Gruppe namens _dhcp (2004-04-12)
    </h3>
    <p>Die etlichen dhcp-bezogenen Daemons werden überarbeitet, um ihre
      Privilegien fallenzulassen oder Privilegientrennung zu verwenden.
      Aus diesem Grund werden ein neuer Benutzer und eine neue Gruppe
      namens _dhcpd benötigt. Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 77 _dhcp
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _dhcp:*:77:77::0:0:DHCP programs:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.3"></a>
    <h3>
      3.5.3: Neuer Benutzer und neue Gruppe namens _mopd (2004-04-14)
    </h3>
    <p>Der <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mopd&amp;sektion=8"
      >mopd(8)</a>-Daemon lässt nun seine Privilegien nach der
      Initialisierung fallen und benötigt einen neuen Benutzer und eine
      neue Gruppe namens _mopd. Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 78 _mopd
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _mopd:*:78:78::0:0:MOP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.4"></a>
    <h3>
      3.5.4: Neuer Benutzer und neue Gruppe namens _tftpd (2004-04-17)
    </h3>
    <p>Der <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tftpd&amp;sektion=8"
      >tftpd(8)</a>-Daemon lässt nun seine Privilegien nach der
      Initialisierung fallen und benötigt einen neuen Benutzer und eine
      neue Gruppe namens _tftpd statt wie bisher nobody. Füge die Gruppe
      hinzu, indem du
<pre>
  # groupadd -g 79 _tftpd
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _tftpd:*:79:79::0:0:TFTP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.5"></a>
    <h3>
      3.5.5: Neuer Benutzer und neue Gruppe namens _rbootd (2004-04-30)
    </h3>
    <p>Der <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=rbootd&amp;sektion=8"
      >rbootd(8)</a>-Daemon lässt nun seine Privilegien nach der
      Initialisierung fallen und verwendet danach die Rechte vom
      Benutzer _rbootd und der Gruppe _rbootd. Füge die Gruppe
      hinzu, indem du
<pre>
  # groupadd -g 80 _rbootd
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _rbootd:*:80:80::0:0:rbootd Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.6"></a>
    <h3>
      3.5.6: cksum verschoben (2004-05-02)
    </h3>
    <p>Das Werkzeug
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cksum&amp;sektion=1">cksum(1)</a>
      wurde von <tt>/usr/bin</tt> nach <tt>/bin</tt> verschoben.
      Nachdem ein <em>make build</em> erfolgreich ausgeführt wurde, führe
      Folgendes als root aus:
<pre>
  # rm -f /usr/bin/cksum /usr/bin/sum
</pre>
    <p>

    <a name="3.5.7"></a>
    <h3>
      3.5.7: Neuer Benutzer und neue Gruppe namens _afs (2004-05-06)
    </h3>
    <p>Der <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=afsd&amp;sektion=8"
      >afsd(8)</a>-Daemon ist bald so weit, dass seine Privilegien
      getrennt werden können. Ein neuer Benutzer und eine neue Gruppe
      namens _afs werden hierfür benötigt. Füge die Gruppe hinzu, indem
      du
<pre>
  # groupadd -g 81 _afs
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _afs:*:81:81::0:0:afs Daemon:/var/empty:/sbin/nologin
</pre>
    <p>Du musst den Besitzer des Caches ändern, indem du Folgendes
      ausführst:
<pre>
  # chown -R _afs:_afs /var/spool/afs
</pre>
    <p>

    <a name="3.5.8"></a>
    <h3>
      3.5.8: Neuer Benutzer und neue Gruppe namens _ppp (2004-05-06)
    </h3>
    <p>Das <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pppoe&amp;sektion=8"
      >pppoe(8)</a>-Program lässt nun seine Privilegien fallen und läuft
      mit den Rechten des Benutzers _ppp und der Gruppe _ppp weiter.
      Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 82 _ppp
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _ppp:*:82:82::0:0:PPP utilities:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.9"></a>
    <h3>
      3.5.9: Neuer Benutzer und neue Gruppe namens _ntp (2004-05-30)
    </h3>
    <p>Das bald erscheinende Programm
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ntpd&amp;sektion=8">ntpd(8)</a>
      benötigt einen neuen Benutzer und eine neue Gruppe namens _ntp.
      Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 83 _ntp
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _ntp:*:83:83::0:0:NTP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.5.10"></a>
    <h3>
      3.5.10: Flagday für Versionserhöhung der Bibliotheken (2004-07-13)
    </h3>
    <p>Bibliotheks- und Systeminterfaceänderungen machten es notwendig,
        eine Erhöhung aller Obernummern jeder einzelnen Bibliothek
	durchzuführen. Die folgenden Schritte müssen befolgt werden,
	um ein brauchbares System zu erhalten.
	 <ul>
          <li>Aktualisiere deinen Source-Tree
	  <li>Übersetze einen neuen Kernel
	  <li>Installiere den neuen Kernel und starte neu
	  <li>Installiere neue Headerdateien:
<pre>
     # cd /usr/src && make obj && make cleandir && make includes
</pre>
	  <li>Übersetze und installiere eine neue Version der libc
<pre>
     # cd /usr/src/lib/libc && make depend && make && env NOMAN=1 make install
</pre>
	  <li>Übersetze und installiere das System wie gewohnt
<pre>
     # cd /usr/src && make build
</pre>
	 </ul>
    <p>

    <a name="3.5.11"></a>
    <h3>
      3.5.11: Änderungen in PF-Anker (2004-08-07)
    </h3>
    <p>Anwender von authpf sollten ihre Ankerregel im
        Hauptregelsatz von
<pre>
     anchor authpf
</pre>
	in
<pre>
     anchor "authpf/*"
</pre>
	abändern.
    <p>

    <a name="3.4"></a>
    <h2>
      Von 3.4 auf 3.5 upgraden
    </h2>

    <a name="3.4.1"></a>
    <h3>
      3.4.1: Unternummern des svnd-Devices geändert (2003-10-10)
    </h3>
    <p>
      Die Unternummern des Devices
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=svnd&amp;sektion=4">svnd</a>
      wurden geändert, so dass du eine aktualisierte
      <tt>/dev/MAKEDEV</tt> nach der Installation des neuen Kernels
      ausführen musst:
        <ul>
	  <li>Aktualisiere deinen Source-Tree
	  <li>Übersetze einen neuen Kernel
	  <li>Kopiere das neue MAKEDEV-Skript in das dev-Verzeichnis,
	      entferne die existierenden svnd(4)- und rsvnd-Devices
	      und erstelle neue:
<pre>
     # cp /usr/src/etc/etc.`machine`/MAKEDEV /dev
     # cd /dev
     # rm svnd* rsvnd*
     # ./MAKEDEV vnd
</pre>
          <li>Setze die Erzeugungs- und Releasephase wie gewohnt fort.
        </ul>

      Dies betrifft alle, die svnd-Devices verwenden; dazu gehören auch
      alle, die <tt>make release</tt> ausführen.
    <p>

    <a name="3.4.2"></a>
    <h3>
      3.4.2: Neuer Benutzer und neue Gruppe namens _pflogd (2003-10-23)
    </h3>
    <p>Der <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pflogd&amp;sektion=8"
      >pflogd(8)</a>-Daemon läuft nun im privilegiengetrennten Modus und
      benötigt einen neuen Benutzer und eine neue Gruppe namens _pflogd.
      Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 74 _pflogd
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _pflogd:*:74:74::0:0:pflogd privsep:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.4.3"></a>
    <h3>
      3.4.3: Interfacecloning (2003-12-07)
    </h3>
    <p>Viele Pseudonetzwerktreiber (wie zum Beispiel
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gif&amp;sektion=4">gif(4)</a>,
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=lo&amp;sektion=4">lo(4)</a> und
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tun&amp;sektion=4">tun(4)</a>)
      wurden verschoben, um Cloning zu unterstützten, d.&nbsp;h. die
      Erstellung und Entfernung von Devices je nach Bedarf. Wenn du auf
      diese Interfaces angewiesen bisst, so musst du aktualisierte
      Versionen von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ifconfig&amp;sektion=8">ifconfig(8)</a>
      und
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=netstart&amp;sektion=8">netstart(8)</a>
      übersetzen und installieren, bevor du mit deinem neuen Kernel
      neustartest.

    <p>Übersetze und installiere zunächst deinen neuen Kernel wie
      gewühnt und führe dann Folgendes aus:
      <pre>
  # cd /usr/src && make includes
  # cd sbin/ifconfig
  # make obj depend
  # make
  # make install
  # cp /usr/src/etc/netstart /etc
      </pre>
      Starte nun deine Maschine neu und setze die Übersetzung des
      neuen Userlands fort.
    <p>

    <a name="3.4.4"></a>
    <h3>
       3.4.4: Neuer Benutzer und neue Gruppe namens _bgpd (2003-12-17)
    </h3>
    <p>Der neue <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bgpd&amp;sektion=8"
      >bgpd(8)</a>-Daemon läuft nun im privilegiengetrennten Modus und
      benötigt einen neuen Benutzer und eine neue Gruppe namens _bgpd.
      Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 75 _bgpd
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _bgpd:*:75:75::0:0:BGP Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.4.5"></a>
    <h3>
	3.4.5: Neue Version von join(1) (2003-12-28)
    </h3>
    <p>Das Kommando
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=join&amp;sektion=1">join(1)</a>
    wurde aktualisiert, so dass es dem POSIX-Standard beim Schreiben von
    nicht zutreffenden Zeilen folgt. Hieraus folgt, dass
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=security&amp;sektion=8">security(8)</a>
    aktualisiert werden muss:
     <pre>
  # cp /usr/src/etc/security /etc
     </pre>
    <p>

    <a name="3.4.6"></a>
    <h3>
	3.4.6: Übersetzungsänderung von sudo (2004-01-15)
    </h3>
    <p>Die Art und Weise, wie das Kommando
    <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sudo&amp;sektion=8">sudo(8)</a>
    übersetzt wird, wurde geändert. Ein Nebeneffekt hiervon ist, dass du
    Folgendes ausführen musst:
     <pre>
  # rm -f /usr/obj/usr.bin/sudo/*
     </pre>
    bevor du erfolgreich ein »make build« aufrufen kannst. Wenn du
    diesen Schritt nicht ausführst, wird die Erzeugungsphase während dem
    Versuch, Objektverzeichnisse zu erstellen, abbrechen.
    <p>

    <a name="3.4.7"></a>
    <h3>
      3.4.7: Neuer Benutzer und neue Gruppe namens _tcpdump (2004-01-19)
    </h3>
    <p>Das <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tcpdump&amp;sektion=8"
      >tcpdump(8)</a>-Kommando läuft nun im privilegiengetrennten Modus
      und benötigt einen neuen Benutzer und eine neue Gruppe namens
      _tcpdump. Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 76 _tcpdump
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _tcpdump:*:76:76::0:0:tcpdump:/var/empty:/sbin/nologin
</pre>

    <p>
    <a name="3.4.8"></a>
    <h3>
      3.4.8: Änderungen an machdep.c (i386) (2004-02-01)
    </h3>

    <p>
    Eine Änderung an <tt>machdep.c</tt> setzt voraus, dass binutils
    neu erzeugt wird, bevorder Kernel kompiliert werden kann. Dies
    betrifft nur i386.

<pre>
  # cd /usr/src/gnu/usr.bin/binutils
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>

    <p> Du kannst nun den Kernel und das restliche System wie in
    der Sektion <a href="#1.5">1.5</a> beschrieben neu erzeugen.

    <p>
    <a name="3.4.9"></a>
    <h3>
      3.4.9: Aktualisierte bsd.own.mk (2004-02-20)
    </h3>

    <p>
    Du musst <tt>/usr/share/mk/bsd.own.mk</tt> aktualisieren, um
    die USE_GCC3-Definition zu haben:

<pre>
    # cd /usr/src/share/mk
    # make install
</pre>

    <p>
    <a name="3.4.10"></a>
    <h3>
      3.4.10: Wechsel auf gcc3 (sparc64) (2004-02-20)
    </h3>

    <p>
    OpenBSD/sparc64 wurde auf gcc3 umgestellt.
    Um upzugraden, führe Folgendes aus:

<pre>
    # rm -rf /usr/include/g++
</pre>
    Als nächstes muss <a href="#1.8">gcc3 erzeugt werden</a> (unter
    Verwendung des gcc3-Verzeichnisses) und danach wie
    <a href="#1.5">gewöhnlich</a> der Kernel und das System.


    <a name="3.3"></a>
    <h2>
      Von 3.3 auf 3.4 upgraden
    </h2>

    <a name="3.3.1"></a>
    <h3>
      3.3.1: W^X-Unterstützung für i386 (2003-04-16)
    </h3>

    <p>Um die »Schreibbar oder ausführbar«- (Writable xor eXecute)
      Unterstützung für i386 zu aktivieren, wurde OpenBSD/i386 vom
      a.out-Binaryformat auf das ELF-Binaryformat umgestellt. Die
      Flexibilität von ELF ermöglicht bessere Kontrolle über das
      Layout der Binary, wodurch die Unterstützung für W^X
      ermöglicht wurde. Kompatibilität für a.out existiert nur in
      begrenzter Form. Staische a.out-Binarys werden wie bisher
      funktionieren; dynamische a.out-Binary aber WERDEN NICHT
      UNTERSTÜTZT.
    </p>
    <p>QUELLTEXT-UPGRADES VON a.out -&gt; ELF WERDEN NICHT UNTERSTÜTZT.
      INSTALLIERE EINEN SNAPSHOT, so dass du mit diesem vom Quelltext
      aus das System neu erzeugen kannst. Dies betrifft nur i386; andere
      Architekturen sind von dieser Änderung NICHT betroffen.
    </p>

    <a name="3.3.2"></a>
    <h3>
      3.3.2: Änderung am mquery-syscall (2003-04-28)
    </h3>

    <p>Die Parameter für den mquery-Systemaufruf wurden geändert, so
      dass sie mit denen von mmap() übereinstimmen. Diese Änderung
      setzt voraus, dass das System in der richtigen Reihenfolge
      upgegradet wird:

      <pre>
      1. Erzeuge und boote den neuen Kernel.
      2. (cd /usr/src && sudo make includes)
      3. (cd /usr/src/libexec/ld.so && make && sudo make install)
      4. »make build«
      </pre>

      Nur i386 verwendet mquery, so dass andere Architekturen
      dieser bestimmten Erzeugungsreihenfolge nicht folgen müssen.

    <a name="3.3.3"></a>
    <h3>
      3.3.3: i386-Flagday: Änderung an exe addr/MAXDSIZ (2003-05-05)
    </h3>

    <p>Um MAXDSIZ zu ermöglichen, wieder auf 1 G geändert zu werden,
      musste die Basisadresse aller Binarys von 0 auf 0x1c000000
      geändert werden. Die Kombination dieser Änderungen erfordert
      eine Aktualisierung vom Snapshot. Das Aktualisieren anhand
      des Quelltextes wird nicht unterstützt. Dies betrifft nur i386.
    </p>

    <a name="3.3.4"></a>
    <h3>
      3.3.4: Entfernung der KerberosIV-Authentikation (2003-05-13)
    </h3>

    <p>KerberosIV-basierte Authentifikation wurde entfernt. Dies
       bedeutet, dass du alle Referenzen auf <tt>krb4</tt> in
       <tt>/etc/login.conf</tt> entfernen musst.
    </p>

    <a name="3.3.5"></a>
    <h3>
      3.3.5: Änderung an <tt>config</tt> (2003-05-23)
    </h3>

    <p>Das Verschieben von swapgeneric.c benötigte eine Änderung an
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>.
      Bevor du einen neuen Kernel erzeugen kannst, musst du zunächst
      eine aktualisierte config(8) übersetzen und installieren:
<pre>
  # cd /usr/src/usr.sbin/config
  # make clean
  # make obj
  # make
  # make install
</pre>
      Wende nun <tt>config</tt> für deine Kernelkonfiguration an und
      führe <tt>make depend</tt> im Kompiliationsverzeichnis deines
      Kernels aus, wie es <a href="#1.5">weiter oben</a> beschrieben
      wurde.

   <a name="3.3.6"></a>
   <h3>
    3.3.6: Verwende __attribute__((bounded)) bei bestimmten Funktionen
    (2003-06-26)
   </h3>

   <p>
     Von nun an wird __attribute__((bounded)) verwendet, um falsche
     Funktionsargumente abzufangen, die Pufferlängen als einen ihrer
     Parameter haben.
     <br><br>Du musst gcc wie in der Sektion <a href="#1.8">1.8</a>
     der Mini-FAQ beschrieben neu erzeugen, bevor du mit
     <tt>make build</tt> fortfahren kannst.
   </p>

    <a name="3.3.7"></a>
    <h3>
      3.3.7: Neuer Benutzer und neue Gruppe namens _syslogd (2003-07-31)
    </h3>
    <p>Der <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=syslogd&amp;sektion=8"
      >syslogd(8)</a>-Daemon läuft nun im privilegiengetrennten Modus
      und benötigt einen neuen Benutzer und eine neue Gruppe namens
      _syslogd. Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 73 _syslogd
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _syslogd:*:73:73::0:0:Syslog Daemon:/var/empty:/sbin/nologin
</pre>
    <p>

    <a name="3.3.8"></a>
    <h3>
      3.3.8: Verwende das Formatattribut __kprintf__ in Kernelheader
      (2003-08-23)
    </h3>
    <p>
      Ein neues Formatattribut namens __kprintf__ wird nun in
      Kernelheaderdateien verwendet, damit gcc die Formaterweiterungen
      von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=printf&amp;sektion=9">printf(9)</a>
      im Kernel erkennt.
      <br><br>Du musst gcc gemäß der Sektion <a href="#1.8">1.8</a> der
      Mini-FAQ neu erzeugen, bevor du mit <tt>make build</tt> fortfahren
      kannst. Du musst gcc nur ein einziges Mal aus den current-Sourcen
      übersetzen, um ebenfalls das __bounded__-Attribut zu unterstützen;
      dies wird in der Sektion <a href="#3.3.6">3.3.6</a> beschrieben.
    </p>

    <a name="3.2"></a>
    <h2>
      Von 3.2 auf 3.3 upgraden
    </h2>

    <a name="3.2.1"></a>
    <h3>
      3.2.1: Neues Perl (2002-11-05)
    </h3>

    <p>Perl wurde auf Version 5.8.0 aktualisiert.<br>
      In Perl 5.8.0 wurde die API der XS-Module aufgrund der Änderung
      von stdio in PerlIO (siehe die Manualseite von perldelta für
      weitere Informationen) geändert. Dies bedeutet, dass alle
      XS-Module (Perls .so-Dateien), die du installiert hast, neu
      erzeugt werden <strong>müssen</strong>. Wenn du Fehler wie zum
      Beispiel <em>Undefined symbol "perl_get_sv"</em> erhalten hast,
      dann ist genau das der Grund dafür. Wenn die einzigen Module, die
      du installier hast, aus Packages stammen oder über das Portssystem
      installiert wurden, so kannst du dein System nach XS-Modulen
      durchsuchen, indem du Folgendes aufrufst:
      <pre>
	# grep '\.so' /var/db/pkg/p5-*/+CONTENTS | cut -d: -f1 | sort -u
      </pre>
      Du kannst dann die problematischen Module mittels
      <em>pkg_delete -f</em> entfernen und sie dann vom Ports-Tree aus
      neu übersetzen und installieren.

    <a name="3.2.2"></a>
    <h3>
      3.2.2: Neue Gruppen: _radius, _token und _shadow (2002-11-21)
    </h3>
    <p>Einige neue Gruppen wurden hinzugefügt:
      <ul>
      <li>Die <em>_radius</em>-Gruppe verwaltet den schreibgeschützten
          Zugriff auf die Datei <tt>/etc/raddb/servers</tt>.
      <li>Die <em>_toekn</em>-Gruppe verwaltet den schreibgeschützten
          Zugriff auf die Token-Datenbanken, die von
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokeninit&amp;sektion=8">tokeninit(8)</a>,
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokenadm&amp;sektion=8">tokenadm(8)</a> und
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login_token&amp;sektion=8">login_token(8)</a>
	  genutzt werden.
      <li>Die <em>_shadow</em>-Gruppe verwaltet den schreibgeschützten
          Zugriff auf die Shadowpasswortdatenbank.
      </ul>

      Du musst diese Gruppen anlegen und die Rechte einige Dateien
      anpassen, bevor du »make build« ausführen kannst. Die folgenden
      Kommandos (ausgeführt als root) werden diese Aufgabe erledigen:
	<pre>
	  # groupadd -g 63 _radius
	  # chgrp _radius /etc/raddb /etc/raddb/servers
	  # chmod g+x /etc/raddb
	  # chmod g+r /etc/raddb/servers

	  # groupadd -g 64 _token
	  # chgrp _token /etc/activ.db /etc/crypto.db /etc/snk.db
	  # chmod 0640 /etc/activ.db /etc/crypto.db /etc/snk.db

	  # groupadd -g 65 _shadow
	  # chgrp _shadow /etc/spwd.db
	  # chmod 0640 /etc/spwd.db
	</pre>

      Kümmere dich nicht um Fehlermeldungen, die sagen, dass eine Datei
      nicht gefunden werden konnte. Diese Fehlermeldungen sagen nur aus,
      dass du keine <em>token</em>- oder
      <em>radius</em>-Authentifizierung eingerichtet hast.

    <a name="3.2.3"></a>
    <h3>
      3.2.3: Wichtige Compileränderungen (2002-12-02)
    </h3>
    <p>Die Stackprotectionerweiterung
      <a href="http://www.trl.ibm.com/projects/security/ssp">propolice</a>
      wurde in den
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc-local&amp;sektion=1"
      >gcc</a> eingebunden. Dies setzt eine etwas andere
      Upgradevorgehensweise als sonst voraus:
      <ul>
      <li>Erzeuge noch <b>keinen</b> neuen Kernel.
      <li>Erzeuge noch <b>keinen</b> neuen gcc.
      <li>Übersetze und installiere einen neuen ld.so-Dynamiklader,
        wenn dein System Shared Librarys einsetzt.
        <pre>
	  # cd /usr/src
	  # make obj
          Für ELF-Plattformen (alpha, macppc, sparc, sparc64):
          # cd /usr/src/libexec/ld.so
          # make depend &amp;&amp; make &amp;&amp; make install
	  Für a.out-Plattformen (amiga, hp300, i386, mac68k, mvme68k):
          # cd /usr/src/gnu/usr.bin/ld/rtld
          # make depend &amp;&amp; make &amp;&amp; make install
	</pre>
      <li>Übersetze und installiere eine neue libc, indem du den ersten
        Schritten von <i>make build</i> folgst.
	<pre>
          # cd /usr/src/include
	  # make prereq &amp;&amp; make includes
	  # cd /usr/src/lib/libc
	  # make depend &amp;&amp; make NOMAN=1 &amp;&amp; make NOMAN=1 install
	</pre>
	Beachte, dass wenn dein Compiler zu alt ist, er nicht in der Lage
	sein wird, libc zu übersetzen. In diesem Fall musst du ein
	Binaryupgrade mit einem Snapshot machen.
      <li>Übersetze und installiere gcc, wie in Sektion
        <a href="#1.8">1.8</a> beschrieben.
      <li>Du kannst nun einen Kernel kompilieren.
        Stelle sicher, dass du
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
        >config</a> erneut aufrufst, um eine Kernel-Makefile anzulegen.
      <li>Reboote mit dem neuen Kernel und führe ein <i>make build</i>
        aus, um die Vorzüge des Stackschutzes zu genießen.
      </ul>

    <a name="3.2.4"></a>
    <h3>
      3.2.4: Neuer Benutzer und neue Gruppe namens _spamd (2002-12-24)
    </h3>
    <p>Ein neuer Benutzer und eine neue Gruppe namens _spamd wurden für
      den
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8"
      >spamd(8)</a>-Daemon hinzugefügt. Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 62 _spamd
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _spamd:*:62:62::0:0:Spam daemon:/var/empty:/sbin/nologin
</pre>

    <a name="3.2.5"></a>
    <h3>
      3.2.5: Alias für ipv6-icmp (2002-12-30)
    </h3>

    <p>Ein neuer Alias (<em>icmp6</em>) für ipv6-icmp wurde zur
      <tt>/etc/protocols</tt> hinzugefügt. Wenn du das
      <em>icmp6</em>-Alias nutzen möchtest (wird in den
      Regressiontests für
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8">pfctl(8)</a>
      verwendet), musst du die <em>ipv6-icmp</em>-Zeile in
      <tt>/etc/protocols</tt> ändern, indem du das Schlüsselwort
      <em>icmp6</em> vor der Raute (#) hinzufügst. Die Zeile sollte
      dann wie folgt aussehen:
    </p>
<pre>
  ipv6-icmp 58    IPv6-ICMP icmp6 # ICMP for IPv6
</pre>

    <a name="3.2.6"></a>
    <h3>
      3.2.6: Neue Gruppe namens _lkm (2003-01-05)
    </h3>

    <p>Die <em>_lkm</em>-Gruppe verwaltet den Zugriff auf
	  <tt>/dev/lkm</tt>.
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=modstat&amp;sektion=8">modstat(8)</a>
	  ist nun setgid _lkm.
    <p>
      Du musst diese Gruppe hinzufügen und die Rechte von
      <tt>/dev/lkm</tt> anpassen, bevor du ein »make build« durchführen
      kannst. Die folgenden Kommandos (ausgeführt als root) werden diese
      Aufgabe erledigen:
<pre>
  # groupadd -g 61 _lkm
  # chgrp _lkm /dev/lkm
</pre>

    <a name="3.2.7"></a>
    <h3>
      3.2.7: Neue libpthread (2003-01-14)
    </h3>

    <p>Sowohl <em>libc_r</em> als auch <em>libnpthread</em> wurden
    entfernt und mit <em>libpthread</em> ersetzt. Programme, die
    Threads verwenden, sollten weiterhin mit der Option
    <em>-pthread</em> kompiliert werden können; der Kompiler wird sich
    darum kümmern.

    <p>Bevor du <em>libc_r</em> und <em>libnpthread</em> entfernst,
    müssen Applikationen mit <em>libpthread</em> neu erzeugt werden.
    Die hierfür empfohlene Befehlsreihenfolge ist:

    <ol>
      <li>
        <p>Erzeuge gcc gemäß Sektion <a href="#1.8">1.8</a>.
      <li>
        <p>Bereite das System gemäß Sektion <a href="#1.5">1.5</a> vor.
      <li>
        <p>Bereite alle Ports vor, die Threads verwenden.
      <li>
        <p>Entferne alle ungenutzten Bibliotheken:
<pre>
  # rm /usr/lib/libc_r* /usr/lib/libnpthread*
</pre>
    </ol>

    <a name="3.2.8"></a>
    <h3>
      3.2.8: Linkeränderungen für ELF-Architekturen (2003-01-17)
    </h3>

    <p>Binutils/ld wurde geändert, um ELF-Binarys mit einer neuen
    Sicherheitsfunktionalität auszurüsten. Statt der Datensektion der
    Binarys und Shared Librarys zu erlauben, als ausführbar vom
    Linker markiert zu werden, hat sich das Layout so geändert, dass
    nur die passenden Sektionen des Programmimages als ausführbar
    markiert werden können. Diese Änderung betrifft nur ELF-basierte
    Architekturen: alpha, sparc, sparc64 und macppc.
    <p>
    Es wird empfohlen, dass binutils vor dem Rest des Systems neu
    erzeugt wird.
    <p>
<pre>
  # cd /usr/src/gnu/usr.bin/binutils
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>
    <p>
    Erzeuge das System dann gemäß der Sektion <a href="#1.5">1.5</a>
    neu.

    <a name="3.2.9"></a>
    <h3>
      3.2.9: Entfernung von /var/at und Änderungen an Crontabs
      (2003-02-19)
    </h3>

    <p>Der Inhalt von <tt>/var/at</tt> wurde in <tt>/var/cron</tt>
    eingebunden, da <em>at</em> ebenfalls bereits in <em>cron</em>
    eingegliedert wurde. Des Weiteren wurden die Allow- und Denydateien
    von <em>cron</em> in cron.allow und cron.deny umbenannt, um
    POSIX zu entsprechen und auch die Konsistenz mit at.allow und
    at.deny zu bewahren.
    <p>
    Erzeuge zuerst dein System gemäß Sektion <a href="#1.5">1.5</a> neu,
    verschiebe die exististierenden Dateien und starte dann cron
    wie folgt neu:
    <p>
<pre>
  # mv /var/at/* /var/cron
  # mv /var/cron/jobs /var/cron/atjobs
  # mv /var/cron/allow /var/cron/cron.allow
  # mv /var/cron/deny /var/cron/cron.deny
  # rm -rf /var/at
  # kill `cat /var/run/cron.pid`
  # /usr/sbin/cron
</pre>
    <p>
    Ignoriere alle Warnungen über fehlende Allow- oder Denydateien.
    Nicht alle hier aufgelisteten Dateien befinden sich in der
    Standardinstallation.
    <p>
    Wenn du nicht bereits eine cron.deny-Datei hast (sie wurde vor
    OpenBSD 3.3 nicht installiert) musst du <em>crontab</em> als
    normaler Benutzer aufrufen (also nicht als Administrator).
<pre>
  # install -c -o root -g crontab -m 660 /dev/null /var/cron/cron.deny
</pre>


    <a name="3.2"></a>
    <h2>
      Von 3.2 upgraden
    </h2>

    <a name="3.2.1"></a>
    <h3>
      3.2.1: Neues Perl (2002-11-05)
    </h3>

    <p>Perl wurde auf Version 5.8.0 aktualisiert.<br>
      In Perl 5.8.0 wurde die API der XS-Module aufgrund der Änderung
      von stdio in PerlIO (siehe die Manualseite von perldelta für
      weitere Informationen) geändert. Dies bedeutet, dass alle
      XS-Module (Perls .so-Dateien), die du installiert hast, neu
      erzeugt werden <strong>müssen</strong>. Wenn du Fehler wie zum
      Beispiel <em>Undefined symbol "perl_get_sv"</em> erhalten hast,
      dann ist genau das der Grund dafür. Wenn die einzigen Module, die
      du installier hast, aus Packages stammen oder über das Portssystem
      installiert wurden, so kannst du dein System nach XS-Modulen
      durchsuchen, indem du Folgendes aufrufst:
      <pre>
	# grep '\.so' /var/db/pkg/p5-*/+CONTENTS | cut -d: -f1 | sort -u
      </pre>
      Du kannst dann die problematischen Module mittels
      <em>pkg_delete -f</em> entfernen und sie dann vom Ports-Tree aus
      neu übersetzen und installieren.

    <a name="3.2.2"></a>
    <h3>
      3.2.2: Neue Gruppen: _radius, _token und _shadow (2002-11-21)
    </h3>
    <p>Einige neue Gruppen wurden hinzugefügt:
      <ul>
      <li>Die <em>_radius</em>-Gruppe verwaltet den schreibgeschützten
          Zugriff auf die Datei <tt>/etc/raddb/servers</tt>.
      <li>Die <em>_toekn</em>-Gruppe verwaltet den schreibgeschützten
          Zugriff auf die Token-Datenbanken, die von
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokeninit&amp;sektion=8">tokeninit(8)</a>,
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tokenadm&amp;sektion=8">tokenadm(8)</a> und
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login_token&amp;sektion=8">login_token(8)</a>
	  genutzt werden.
      <li>Die <em>_shadow</em>-Gruppe verwaltet den schreibgeschützten
          Zugriff auf die Shadowpasswortdatenbank.
      </ul>

      Du musst diese Gruppen anlegen und die Rechte einige Dateien
      anpassen, bevor du »make build« ausführen kannst. Die folgenden
      Kommandos (ausgeführt als root) werden diese Aufgabe erledigen:
	<pre>
	  # groupadd -g 63 _radius
	  # chgrp _radius /etc/raddb /etc/raddb/servers
	  # chmod g+x /etc/raddb
	  # chmod g+r /etc/raddb/servers

	  # groupadd -g 64 _token
	  # chgrp _token /etc/activ.db /etc/crypto.db /etc/snk.db
	  # chmod 0640 /etc/activ.db /etc/crypto.db /etc/snk.db

	  # groupadd -g 65 _shadow
	  # chgrp _shadow /etc/spwd.db
	  # chmod 0640 /etc/spwd.db
	</pre>

      Kümmere dich nicht um Fehlermeldungen, die sagen, dass eine Datei
      nicht gefunden werden konnte. Diese Fehlermeldungen sagen nur aus,
      dass du keine <em>token</em>- oder
      <em>radius</em>-Authentifizierung eingerichtet hast.

    <a name="3.2.3"></a>
    <h3>
      3.2.3: Wichtige Compileränderungen (2002-12-02)
    </h3>
    <p>Die Stackprotectionerweiterung
      <a href="http://www.trl.ibm.com/projects/security/ssp">propolice</a>
      wurde in den
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=gcc-local&amp;sektion=1"
      >gcc</a> eingebunden. Dies setzt eine etwas andere
      Upgradevorgehensweise als sonst voraus:
      <ul>
      <li>Erzeuge noch <b>keinen</b> neuen Kernel.
      <li>Erzeuge noch <b>keinen</b> neuen gcc.
      <li>Übersetze und installiere einen neuen ld.so-Dynamiklader,
        wenn dein System Shared Librarys einsetzt.
        <pre>
	  # cd /usr/src
	  # make obj
          Für ELF-Plattformen (alpha, macppc, sparc, sparc64):
          # cd /usr/src/libexec/ld.so
          # make depend &amp;&amp; make &amp;&amp; make install
	  Für a.out-Plattformen (amiga, hp300, i386, mac68k, mvme68k):
          # cd /usr/src/gnu/usr.bin/ld/rtld
          # make depend &amp;&amp; make &amp;&amp; make install
	</pre>
      <li>Übersetze und installiere eine neue libc, indem du den ersten
        Schritten von <i>make build</i> folgst.
	<pre>
          # cd /usr/src/include
	  # make prereq &amp;&amp; make includes
	  # cd /usr/src/lib/libc
	  # make depend &amp;&amp; make NOMAN=1 &amp;&amp; make NOMAN=1 install
	</pre>
	Beachte, dass wenn dein Compiler zu alt ist, er nicht in der Lage
	sein wird, libc zu übersetzen. In diesem Fall musst du ein
	Binaryupgrade mit einem Snapshot machen.
      <li>Übersetze und installiere gcc, wie in Sektion
        <a href="#1.8">1.8</a> beschrieben.
      <li>Du kannst nun einen Kernel kompilieren.
        Stelle sicher, dass du
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8"
        >config</a> erneut aufrufst, um eine Kernel-Makefile anzulegen.
      <li>Reboote mit dem neuen Kernel und führe ein <i>make build</i>
        aus, um die Vorzüge des Stackschutzes zu genießen.
      </ul>

    <a name="3.2.4"></a>
    <h3>
      3.2.4: Neuer Benutzer und neue Gruppe namens _spamd (2002-12-24)
    </h3>
    <p>Ein neuer Benutzer und eine neue Gruppe namens _spamd wurden für
      den
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=spamd&amp;sektion=8"
      >spamd(8)</a>-Daemon hinzugefügt. Füge die Gruppe hinzu, indem du
<pre>
  # groupadd -g 62 _spamd
</pre>
      als root ausführst, und erstelle den Benutzereintrag unter
      Verwendung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>:
<pre>
  _spamd:*:62:62::0:0:Spam daemon:/var/empty:/sbin/nologin
</pre>

    <a name="3.2.5"></a>
    <h3>
      3.2.5: Alias für ipv6-icmp (2002-12-30)
    </h3>

    <p>Ein neuer Alias (<em>icmp6</em>) für ipv6-icmp wurde zur
      <tt>/etc/protocols</tt> hinzugefügt. Wenn du das
      <em>icmp6</em>-Alias nutzen möchtest (wird in den
      Regressiontests für
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8">pfctl(8)</a>
      verwendet), musst du die <em>ipv6-icmp</em>-Zeile in
      <tt>/etc/protocols</tt> ändern, indem du das Schlüsselwort
      <em>icmp6</em> vor der Raute (#) hinzufügst. Die Zeile sollte
      dann wie folgt aussehen:
    </p>
<pre>
  ipv6-icmp 58    IPv6-ICMP icmp6 # ICMP for IPv6
</pre>

    <a name="3.2.6"></a>
    <h3>
      3.2.6: Neue Gruppe namens _lkm (2003-01-05)
    </h3>

    <p>Die <em>_lkm</em>-Gruppe verwaltet den Zugriff auf
	  <tt>/dev/lkm</tt>.
	  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=modstat&amp;sektion=8">modstat(8)</a>
	  ist nun setgid _lkm.
    <p>
      Du musst diese Gruppe hinzufügen und die Rechte von
      <tt>/dev/lkm</tt> anpassen, bevor du ein »make build« durchführen
      kannst. Die folgenden Kommandos (ausgeführt als root) werden diese
      Aufgabe erledigen:
<pre>
  # groupadd -g 61 _lkm
  # chgrp _lkm /dev/lkm
</pre>

    <a name="3.2.7"></a>
    <h3>
      3.2.7: Neue libpthread (2003-01-14)
    </h3>

    <p>Sowohl <em>libc_r</em> als auch <em>libnpthread</em> wurden
    entfernt und mit <em>libpthread</em> ersetzt. Programme, die
    Threads verwenden, sollten weiterhin mit der Option
    <em>-pthread</em> kompiliert werden können; der Kompiler wird sich
    darum kümmern.

    <p>Bevor du <em>libc_r</em> und <em>libnpthread</em> entfernst,
    müssen Applikationen mit <em>libpthread</em> neu erzeugt werden.
    Die hierfür empfohlene Befehlsreihenfolge ist:

    <ol>
      <li>
        <p>Erzeuge gcc gemäß Sektion <a href="#1.8">1.8</a>.
      <li>
        <p>Bereite das System gemäß Sektion <a href="#1.5">1.5</a> vor.
      <li>
        <p>Bereite alle Ports vor, die Threads verwenden.
      <li>
        <p>Entferne alle ungenutzten Bibliotheken:
<pre>
  # rm /usr/lib/libc_r* /usr/lib/libnpthread*
</pre>
    </ol>

    <a name="3.2.8"></a>
    <h3>
      3.2.8: Linkeränderungen für ELF-Architekturen (2003-01-17)
    </h3>

    <p>Binutils/ld wurde geändert, um ELF-Binarys mit einer neuen
    Sicherheitsfunktionalität auszurüsten. Statt der Datensektion der
    Binarys und Shared Librarys zu erlauben, als ausführbar vom
    Linker markiert zu werden, hat sich das Layout so geändert, dass
    nur die passenden Sektionen des Programmimages als ausführbar
    markiert werden können. Diese Änderung betrifft nur ELF-basierte
    Architekturen: alpha, sparc, sparc64 und macppc.
    <p>
    Es wird empfohlen, dass binutils vor dem Rest des Systems neu
    erzeugt wird.
    <p>
<pre>
  # cd /usr/src/gnu/usr.bin/binutils
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>
    <p>
    Erzeuge das System dann gemäß der Sektion <a href="#1.5">1.5</a>
    neu.

    <a name="3.2.9"></a>
    <h3>
      3.2.9: Entfernung von /var/at und Änderungen an Crontabs
      (2003-02-19)
    </h3>

    <p>Der Inhalt von <tt>/var/at</tt> wurde in <tt>/var/cron</tt>
    eingebunden, da <em>at</em> ebenfalls bereits in <em>cron</em>
    eingegliedert wurde. Des Weiteren wurden die Allow- und Denydateien
    von <em>cron</em> in cron.allow und cron.deny umbenannt, um
    POSIX zu entsprechen und auch die Konsistenz mit at.allow und
    at.deny zu bewahren.
    <p>
    Erzeuge zuerst dein System gemäß Sektion <a href="#1.5">1.5</a> neu,
    verschiebe die exististierenden Dateien und starte dann cron
    wie folgt neu:
    <p>
<pre>
  # mv /var/at/* /var/cron
  # mv /var/cron/jobs /var/cron/atjobs
  # mv /var/cron/allow /var/cron/cron.allow
  # mv /var/cron/deny /var/cron/cron.deny
  # rm -rf /var/at
  # kill `cat /var/run/cron.pid`
  # /usr/sbin/cron
</pre>
    <p>
    Ignoriere alle Warnungen über fehlende Allow- oder Denydateien.
    Nicht alle hier aufgelisteten Dateien befinden sich in der
    Standardinstallation.
    <p>
    Wenn du nicht bereits eine cron.deny-Datei hast (sie wurde vor
    OpenBSD 3.3 nicht installiert) musst du <em>crontab</em> als
    normaler Benutzer aufrufen (also nicht als Administrator).
<pre>
  # install -c -o root -g crontab -m 660 /dev/null /var/cron/cron.deny
</pre>

    <a name="3.1"></a>
    <h2>
      Von 3.1 upgraden
    </h2>

    <a name="3.1.1"></a>
    <h3>
      3.1.1: Neue Benutzer/Gruppen
    </h3>

    <p>Einige neue Benutzer/Gruppen wurden hinzugefügt.
      Für die Unterstützung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=authpf&amp;sektion=8"
      >authpf(8)</a> wird eine neue Gruppe benötigt. Auch für die
      Unterstützung von
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sshd&amp;sektion=8">sshd(8)</a>s
      Funktionalität der Privilegientrennung wurde ein neuer Benutzer und
      eine neue Gruppe namens <em>sshd</em> dem System hinzugefügt. Weitere
      neue Benutzer für Systemdienste wurden hinzugefügt; sie haben einen
      vorangesetzten Unterstrich. Füge die folgenden Benutzer mittels
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>
      hinzu:
    </p>
<pre>
  sshd:*:27:27::0:0:sshd privsep:/var/empty:/sbin/nologin
  _portmap:*:28:28::0:0:portmap:/var/empty:/sbin/nologin
  _identd:*:29:29::0:0:identd:/var/empty:/sbin/nologin
  _rstatd:*:30:30::0:0:rpc.rstatd:/var/empty:/sbin/nologin
  _rusersd:*:32:32::0:0:rpc.rusersd:/var/empty:/sbin/nologin
  _fingerd:*:33:33::0:0:fingerd:/var/empty:/sbin/nologin
  _x11:*:35:35::0:0:X server:/var/empty:/sbin/nologin
</pre>

    <p>Füge die folgenden Gruppen in <tt>/etc/group</tt> hinzu:</p>

<pre>
  sshd:*:27:
  _portmap:*:28:
  _identd:*:29:
  _rstatd:*:30:
  _rusersd:*:32:
  _fingerd:*:33:
  _sshagnt:*:34:
  _x11:*:35:
  authpf:*:72:
</pre>

    <a name="3.1.2"></a>
    <h3>
      3.1.2: Neue Gruppe für crontab(1) und at(1)
    </h3>

    <p>
      Das
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">
      crontab(1)</a>- und das
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=at&amp;sektion=1">
      at(1)</a>-Kommando sind nicht länger setuid root; sie sind nun setgid
      <em>crontab</em>.

    <p>
      Bevor du »make build« ausführen kannst, musst du die Gruppe
      <em>crontab</em>-Gruppe hinzufügen. Ergänze deine
      <tt>/etc/group</tt>-Datei um folgende Zeile:</p>

<pre>
  crontab:*:66:
</pre>

<p>
      Das »make build« wird einige - aber nicht alle - Rechte für dich
      aktualisieren. Nachdem »make build« abgeschlossen wurde, musst du
      folgende Befehle manuell ausführen (unter der Annahme, dass du
      <tt>/bin/csh</tt> verwendest):
</p>

<pre>
  # chgrp crontab /var/at/at.{allow,deny} /var/cron/{allow,deny}
  # chmod 0640 /var/at/at.{allow,deny} /var/cron/{allow,deny}
  # foreach f ( /var/cron/tabs/* )
	  set u=`basename $f`
 	  chown $u:crontab $f
    end
</pre>

<p>
      Beachte, dass du vermutlich nicht alle Allow/Denydateien hast;
      das ist kein Problem.
</p>

    <a name="3.1.3"></a>
    <h3>
      3.1.3: Neue Binutils
    </h3>

<p>
Eine neue Version der binutils (2.11.2) wurde in den Tree eingebunden;
eine Aktualisierung von <em>libiberty</em> ist notwendig. Um diese
Bibliothek zu erzeugen, befolge folgende Schritte:
</p>

<pre>
  # cd /usr/src/gnu/egcs/libiberty
  # make -f Makefile.bsd-wrapper cleandir
  # make -f Makefile.bsd-wrapper obj
  # make -f Makefile.bsd-wrapper depend
  # make -f Makefile.bsd-wrapper
  # make -f Makefile.bsd-wrapper install
</pre>

    <a name="3.1.4"></a>
    <h3>
      3.1.4: Neue S/Key-Konfiguration
    </h3>

    <p>
      Die alte S/Key-Datenbankdatei <tt>/etc/skeykeys</tt> wurde mit
      dem Verzeichnis <tt>/etc/skey</tt> ausgetauscht. In diesem
      Verzeichnis stellt jede Datei einen Eintrag dar, die dem
      Benutzer gehört, der von ihr beschrieben wird. Du kannst
      <tt>/etc/skeykeys</tt> in das neue Format konvertieren, indem
      du Folgendes (als root) ausführst:
    </p>
<pre>
  # skeyinit -C
  # mv /etc/skeykeys /etc/skeykeys.OLD
</pre>

<p>
      Beachte, dass alle Programme von Drittanbietern, die S/Key direkt
      ansprechen, neu erzeugt werden müssen.
</p>

    <a name="3.1.5"></a>
    <h3>
      3.1.5: Neue Rechte für lp*
    </h3>

    <p>
      Das Spoolverzeichnis, das von lpd genutzt wird, muss ein
      Gruppenschreibreicht für die Gruppe daemon haben, damit lpr auf
      die Spooldateien zugreifen kann. Außerdem müssen die Dateien im
      Spoolverzeichnis dem Benutzer daemon und der Gruppe daemon
      gehören. Dies kann wie folgt erreicht werden:
    </p>
<pre>
 # find /var/spool/output /var/spool/lpd -type d \
	-execdir chgrp daemon {} \; -execdir chmod g+rwx {} \;
 # find /var/spool/output /var/spool/lpd -type f \
	-execdir chown daemon:daemon {} \;
</pre>

    <a name="3.1.6"></a>
    <h3>
      3.1.6: atrun(8) wird nicht mehr benötigt
    </h3>

    <p>
      Das Kommando
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=atrun&amp;sektion=8">atrun(8)</a>
      wird nicht mehr benötigt. Seine Funktionalität wurde in
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cron&amp;sektion=8">cron(8)</a>
      eingebunden. Du solltest den <tt>/usr/libexec/atrun</tt>-Job aus
      roots crontab mit dem folgenden Befehl (aufgerufen als root)
      entfernen:
    </p>
    <pre>
      # crontab -e
    </pre>

    <p>
    Du möchtest eventuell auch die Verzeichnisse
    <tt>/usr/libexec/atrun</tt>, <tt>/usr/share/man/cat8/atrun.0</tt>
    und <tt>/var/at/spool</tt> entfernen.
    </p>

    <a name="3.1.7"></a>
    <h3>
      3.1.7: nat.conf in pf.conf eingebunden
    </h3>

    <p>
        Die Datei <tt>/etc/nat.conf</tt> wurde nun in
	<tt>/etc/pf.conf</tt> eingebunden. Du musst die NAT-Regeln in
	der pf.conf zwischen den Scrubregeln und den Filterregeln
	einfügen.
    </p>
    <p>
        Außerdem hat
        <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pfctl&amp;sektion=8">pfctl(8)</a>
	eine neue Option (-f), um die Regelsätze zu laden; die Optionen
	-R und -N haben jetzt andere Bedeutungen. Lies unbedingt die
	Manualseite und aktualisiere deine <tt>/etc/rc</tt>.
    </p>

    <a name="3.1.8"></a>
    <h3>
     3.1.8: Neuer fbtab-Eintrag für xdm benötigt
    </h3>

    <p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=login&amp;sektion=1">
login(1)</a> setzt voraus, dass /dev/wsmouse dem neuen _x11-Benutzer
gehört, der notwendig ist, damit xdm auf vielen Architekturen seine
Privilegien abgeben kann. Die Änderung an <tt>/etc/fbtab</tt> ist
plattformunabhängig. Die Datei wird mit folgenden Aufrufen erstellt
(unter der Annahme, dass die Quellen sich in /usr/src befinden):
    </p>
<pre>
  # cat /usr/src/etc/fbtab.head > /etc/fbtab
  # cat /usr/src/etc/etc.`uname -m`/fbtab >> /etc/fbtab
  # cat /usr/src/etc/fbtab.tail >> /etc/fbtab
</pre>
<p>
Wenn du selbst angepasste Einträge in der <tt>/etc/fbtab</tt> hast,
musst du sie manuell in die neue Datei einbinden.
</p>
   <a name="3.1.9"></a>
   <h3>
     3.1.9: Verwende __attribute__((sentinel)) mit bestimmten
     Funktionen
   </h3>

   <p>
     Um vor der Verwendung bestimmter
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=exec&amp;sektion=3">
exec(3)</a>-Funktionen
     ohne terminierendem NULL-Pointer zu warnen, wurde
     __attribute__((sentinel)) eingefügt.
     <br><br>Du musst gcc gemäß der Sektion
     <a href="#1.8">1.8</a> der Mini-FAQ neu erzugen, bevor
     du mit <tt>make build</tt> fortfahren kannst.
   </p>

    <a name="3.0"></a>
    <h2>
      Von 3.0 upgraden
    </h2>

    <a name="3.0.1"></a>
    <h3>
      3.0.1: Neues Schlüsselwort wird von mtree(8) unterstützt
    </h3>

    <p>
      Du musst eine neue Version des
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">
      mtree(8)</a>-Werkzeuges übersetzen und installieren, bevor ein
      »make build« erfolgreich durchgeführt werden kann.
    </p>
<pre>
  # cd /usr/src/usr.sbin/mtree
  # make cleandir
  # make obj
  # make depend
  # make
  # make install
</pre>

    <a name="3.0.2"></a>
    <h3>
      3.0.2: Entfernung von libdl auf ELF-Plattformen
    </h3>

    <p>
      ELF-basierte Plattformen (alpha, macppc und sparc64) verwenden
      libdl nicht mehr. Das Upgrade eines libdl-Systems auf ein
      Nicht-libdl-System kann am besten mit diesen Schritten
      durchgeführt werden:
    </p>

    <ul>
      <li>
	<p>Kompiliere dein System neu:</p>
<pre>
  # cd /usr/src
  # make build
</pre>
      </li>

      <li>
	<p>
	  Wenn dein »make build« erfolgreich abgeschlossen wurde,
	  kannst du den nächsten Schritt durchführen: libdl entfernen.
	  Beachte, dass Packages, die gegen libdl gelinkt wurden,
	  hiernach neuinstalliert werden müssen. Wenn du für diesen
	  Schritt noch nicht bereit bist, überspringe ihn erst einmal.
	  Snapshots mit korrekten Packages werden zur Verfügung
	  gestellt.
	</p>
<pre>
  # rm -f /usr/lib/libdl.* /usr/lib/libdl_pic.a
</pre>
	</li>
      <li>
	<p>
	  Generiere deinen Cache für Shared Librarys neu, wenn
	  libdl entfernt wurde:
	</p>
	
<pre>
  # ldconfig -R
</pre>
      </li>
    </ul>

    <a name="3.0.3"></a>
    <h3>
      3.0.3: Neues Regressionframework
    </h3>

    <p>
      Eine neue Infrastruktur für Regressiontests wurde eingeführt;
      außerdem wurde <tt>bsd.regress.mk</tt> hinzugefügt. Du musst diese
      Datei installiere, bevor du <em>make obj</em> aufrufst.
    </p>

<pre>
  # cd /usr/src/share/mk
  # make install
</pre>

    <a name="3.0.4"></a>
    <h3>
      3.0.4: Konfigurationsdateien von ssh nach /etc/ssh/ verschoben
    </h3>

    <p>
      Du musst zuerst /etc/ssh erstellen; siehe dafür Sektion
      <a href="#1.13">1.13</a>.
    </p>

    <p>
      Kompiliere dein System neu:
    </p>
<pre>
  # cd /usr/src
  # make build
</pre>

    <p>
      Verschiebe deine /etc/ssh*_*-Dateien in das neu erstellte
      /etc/ssh/-Verzeichnis.
    </p>
<pre>
  # cd /etc
  # mv ssh*_* ssh/
</pre>

    <p>
      Du musst deine
      <a href="http://www.openbsd.org/cgi-bin/cvsweb/src/etc/rc.diff?r1=1.188&amp;r2=1.189">
      <tt>rc</tt>-Skripte entsprechend anpassen</a>, damit diese
      Änderungen auch dort wiedergespiegelt werden.
    </p>

    <p>
      Aktualisiere deine <tt>HostKey</tt>-Zeilen in deiner sshd_config,
      damit sie auf den neuen Ort zeigen. Zum Beispiel:
    </p>
<pre>
  HostKey /etc/ssh_host_key
</pre>

    <p>sollte wie folgt geändert werden:</p>

<pre>
  HostKey /etc/ssh/ssh_host_key
</pre>

    <p>
      Starte danach deinen sshd-Daemon neu.
    </p>

    <a name="2.9"></a>
    <h2>Von 2.9 upgraden</h2>

    <a name="2.9.1"></a>
    <h3>2.9.1: Neue Benutzer/Gruppen: <em>proxy</em>, <em>smmsp</em> und
      <em>popa3d</em>.</h3>

    <p>
      Mit der Einbindung vom Paketfilter
      <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">
      pf(4)</a> als Firewallpackage und seiner
      <a href=
	 "http://www.openbsd.org/cgi-bin/man.cgi?query=ftp-proxy&amp;sektion=8"
	 >ftp-proxy(8)</a>-Umgebung, wurden zuerst ein neuer Benutzer
      und eine neue Gruppe mit dem Namen <em>proxy</em> dem System
      hinzugefügt. Um diese zusätzlichen Programme unterstützen zu
      können, muss der folgende Benutzer mittels
      <a href=
	 "http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">
	vipw(8)</a>:
      eingetragen werden:</p>

<pre>
proxy:*:71:71::0:0:Proxy Services:/nonexistent:/sbin/nologin
</pre>

    <p>Füge ebenfalls die Gruppe <em>proxy</em> in die /etc/group
    ein:</p>

<pre>
proxy:*:71:
</pre>

    <p>Zweitens wird als Teil des Sendmail-8.12-Upgrades sendmail nicht
      mehr setuid root ausgeführt. Sowohl ein neuer Benutzer als auch
      eine neue Gruppe namens <em>smmsp</em> wurden dem System
      hinzugefügt. Füge eine Zeile wie die folgende in deine
      <tt>/etc/group</tt> ein:</p>

<pre>
smmsp:*:25:
</pre>

    <p>Führe dann
      <a href=
	 "http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">
	 vipw(8)</a> aus und trage die folgende Zeile für den
         <em>smmsp</em>-Benutzer ein:</p>

<pre>
smmsp:*:25:25::0:0:Sendmail Message Submission Program:/nonexistent:/sbin/nologin
</pre>

    <p>Stelle sicher, dass diese Zeile vor der ersten <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=yp&amp;sektion=8">
      yp(8)</a>-Einstellungszeile steht.</p>

    <p>Zu guter letzt wurden ein neuer Benutzer und eine neue Gruppe
      für den popa3d-Server von Solar Designer hinzugefügt, der als Teil
      des Basissystems ausgeliefert wird. Füge die Folgende Zeile in
      <tt>/etc/group</tt> ein:</p>

<pre>
popa3d:*:26:
</pre>

    <p>Verwende dann <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">
      vipw(8)</a>, um Folgendes einzutragen</p>
<pre>
popa3d:*:26:26::0:0:POP3 server:/var/empty:/sbin/nologin
</pre>

    <a name="2.9.2"></a>
    <h3>2.9.2: Neuer Paketfilter: <em>pf</em></h3>

    <p>Das IPF-Firewallpackage, das Teil früherer OpenBSD-Releases
    war, wurde mit einer völlig neuen Suite mit dem Namen <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=pf&amp;sektion=4">
      pf(4)</a> ausgetauscht. Das bedeutet, dass viele Änderungen
    gemacht werden müssen.</p>

    <p>Erstens: <em>pf</em> baut auf einer neuen Devicedatei auf.
      Um sicherzustellen, dass dieses spezielle Device erstellt
      wird, führe Folgendes aus:</p>

<pre>
  # cd /dev
  # cp /usr/src/etc/etc.`machine`/MAKEDEV ./
  # ./MAKEDEV all
</pre>

    <p>Zweitens: einige Dateisystemänderungen fanden statt. Als
      Referenz soll diese Liste der Binarys dienen, die ersetzt
      wurden:</p>

<pre>
ALT:
/sbin/ipf /sbin/ipfstat /sbin/ipnat /usr/sbin/ipfs
/usr/sbin/ipftest /usr/sbin/ipmon /usr/sbin/ipresend
/usr/sbin/ipsend /usr/sbin/iptest
NEU:
/sbin/pfctl
/usr/libexec/ftp-proxy
</pre>

    <p>Ähnlich verhält es sich mit den Devices:</p>

<pre>
ALT: /dev/ipl /dev/ipnat /dev/ipstate /dev/ipauth
NEU: /dev/pf
</pre>

    <p>Und schlussendlich die Filterkonfigurationsdateien:</p>

<pre>
ALT: /etc/ipf.rules /etc/ipnat.rules
NEU: /etc/pf.conf /etc/nat.conf
</pre>
    <p>Die alten Beispielkonfigurationsdateien für ipfilter können
      entfernt werden:
    </p>
<pre>
  # rm -rf /usr/share/ipf
</pre>

    <p>Ein Mechanismus für das sichere Aktivieren von <em>pf</em>
      wurde in die Dateien <tt>/etc/rc</tt> und <tt>/etc/rc.fon</tt>
      eingebunden. Du musst diese Dateien aktualisieren, damit sie
      den neuen Einhängemechanismus beinhalten. Wenn du möchtest,
      dass <em>pf</em> aktiviert wird, setze PF=YES in
      <tt>/etc/rc.conf</tt>.</p>

    <a name="2.9.3"></a>
    <h3>2.9.3: Änderungen an <em>make</em></h3>

    <p>Es wurden Änderungen an <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=make&amp;sektion=1">
      make(1)</a> und seinen Datendateien gemacht, welche Probleme
      in der Erzeugungsphase hervorrufen können. Diese kennzeichnen
      sich normalerweise dadurch, dass Fehler in <em>bsd.own.mk</em>
      während dem Erzeugen entstehen. Um diese Probleme zu umgehen,
      solltest du zuerst die Datendateien aktualisieren:</p>
<pre>
  # cd /usr/src/share/mk
  # make install
</pre>

    <p>Übersetze und installiere danach das neue make.</p>

<pre>
  # cd /usr/src/usr.bin/make
  # make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make
  # make install
</pre>

    <p>Fahre nun mit deinem Upgrade fort.</p>

    <a name="2.9.4"></a>
    <h3>2.9.4: Erzeugung bricht wegen KerberosV-Fehlern ab</h3>

    <p>Bevor du das gesamte System übersetzen kannst, musst du zunächst
      KerberosV übersetzen.</p>

    <p>Zuerst sei gesagt, dass es ein neues
      KerberosV-Konfigurationsverzeichnis in <em>/etc</em> gibt.
      Wenn du es nicht bereits gemacht hast, verwende die <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">
        mtree(8)</a>-Prozedur gemäß <a href="#1.13">Sektion
	1.13</a>, um es zu erstellen:</p>

    <p>Erzeuge nun KerberosV</p>

<pre>
  # cd /usr/src/kerberosV
  # make obj
  # cd lib/roken
  # make
  # cd ../../usr.bin/asn1_compile
  # make
  # make install
</pre>

    <p>Du musst eventuell auch deine <tt>/etc/login.conf</tt>
      aktualisieren, damit sie die Tatsache wiederspiegelt, dass die
      Datei <tt>/usr/libexec/auth/login_krb-or-pwd</tt> in
      <tt>login_krb<strong>4</strong>-or-pwd</tt> umbenannt wurde.</p>

    <a name="2.9.5"></a>
    <h3>2.9.5: Neue Version von <em>sendmail</em></h3>

    <p>Die Version von <a href=
      "http://www.openbsd.org/cgi-bin/man.cgi?query=sendmail&amp;sektion=8">
      sendmail(8)</a> ist nun 8.12. Da diese Version von
      <em>sendmail</em> nicht mehr mit setuid root läuft,
      entstanden signifikante Änderungen.</p>

    <ol>
      <li>Sowohl ein neuer Benutzer als auch eine neue Gruppe
        (<em>smmsp</em>) wurden hinzugefügt. Falls du es noch nicht
	getan hast, folge den Anweisungen in <a href="#2.9.1">Sektion
        2.9.1</a>, um sie anzulegen.</li>

      <li>Einige Änderungen fanden an der Dateihierarchie statt;
        einschließlich eines neuen Verzeichnisses namens
	<tt>/var/spool/clientmqueue</tt> und neuen Rechten für
	<tt>/var/spool/mqueue</tt>. Diese Änderungen können anhand der
        <a href=
        "http://www.openbsd.org/cgi-bin/man.cgi?query=mtree&amp;sektion=8">
	mtree(8)</a>-Prozedur gemäß <a href="#1.13">Sektion 1.13</a>
	durchgeführt werden.</li>

      <li>
        <p>Füge Folgendes zur <a href=
          "http://www.openbsd.org/cgi-bin/man.cgi?query=crontab&amp;sektion=1">
	  crontab(1)</a> von root hinzu. Diese Zeile ist notwendig, da
	  <em>sendmail</em> nicht länger setuid root läuft und sich
	  daher darauf verlässt, dass dieser Teil richtig ausgeführt
	  wurde:</p>

<pre>
# sendmail clientmqueue runner
*/30    *       *       *       *       /usr/sbin/sendmail -L sm-msp-queue -Ac -q
</pre>

      </li>

      <li>
        <p>Upgrade sendmail:</p>

<pre>
  # cd /usr/src/gnu/usr.sbin/sendmail
  # make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>

        <p><strong>Hinweis:</strong> Die Dateien <tt>submit.cf</tt> und
	  <tt>localhost.cf</tt> wurden in dein
	  <tt>/etc/mail</tt>-Verzeichnis installiert. Die erste der
	  beiden Dateien (<tt>submit.cf</tt>) - in der
	  Sendmaildokumentation wird sie als Clientkonfigurationsdatei
	  beschrieben - wird von den MUAs verwendet, die E-Mails lokal
	  über sendmail versenden wollen. Aufgrund der Rechteänderungen,
	  die weiter oben erläutert wurden, werden keine root-Rechte
	  benötigt; die sendmail-Binary ist set-groupid für die Gruppe
	  smmsp. Die zweite Datei (<tt>localhost.cf</tt>) ist eine
	  OpenBSDfizierte Datei, die sendmail so ausführt, dass nur auf
	  dem Localhost-Interface Mails vom lokalen Host akzeptiert
	  werden, nicht aber Verbindungen vom Netzwerk (was du aber
	  sehr wahrscheinlich möchtest, wenn du z.&nbsp;B. <a href=
          "http://www.openbsd.org/cgi-bin/man.cgi?query=smtpd&amp;sektion=8">
	  smtpd(8)</a> auf dem SMTP-Port deines Interfaces lauschen
          lassen möchtest, das für andere Rechner erreichbar ist).
	  Wirf einen Blick in die Datei <tt>SECURITY</tt> im
	  Verzeichnis
	  <tt>/usr/src/gnu/usr.sbin/sendmail/sendmail</tt>, wenn
	  du weitere Informationen benötigst.</p>

        <p>Dir wird dringend dazu geraten, dass du deine
	  Sendmailkonfigurationsdateien in <tt>/etc/mail</tt>
	  generierst und aktualisierst. Du kannst funktionierende
	  Konfigurationsdateien in
	  <tt>/usr/share/sendmail/cf</tt> vorfinden. Beachte, dass
	  localhost.cf aus openbsd-localhost.mc generiert wird.</p>
      </li>

      <li>
        <p>Wenn du sendmail ohne die Option <tt>-bd</tt> in
          <tt>/etc/rc.conf</tt> einträgst - dies ist die
	  Einstellung der Standardinstallation - wirst du
	  die Datei <tt>localhost.cf</tt> verwenden. Editiere
	  <tt>rc.conf</tt>, damit folgende Zeile genutzt wird:</p>
<pre>
# For normal use: "-L sm-mta -bd -q30m"
sendmail_flags="-L sm-mta -C/etc/mail/localhost.cf -bd -q30m"
</pre>
      </li>

      <li>
        <p>Sobald deine Konfigurationsdatei bereit ist, beende
	  das bereits laufende sendmail mit <a href=
         "http://www.openbsd.org/cgi-bin/man.cgi?query=kill&amp;sektion=1">
	    kill(1)</a>:</p>
<pre>
  kill `sed 1q /var/run/sendmail.pid`
</pre>

        <p>Starte das neue sendmail mit den passenden Optionen,
	  z.&nbsp;B.:</p>
<pre>
  /usr/sbin/sendmail -L sm-mta -bd -q30m
</pre>

	<p>für eine Konfiguration, die E-Mails von anderen
	  Rechnern akzeptiert, oder</p>

<pre>
  /usr/sbin/sendmail -L sm-mta -C/etc/mail/localhost.cf -bd -q30m
</pre>

        <p>damit nur lokale E-Mails akzeptiert werden.</p>
	
        <p><strong>Hinweis:</strong> die Option <tt>-bd</tt> wird
	  nun in beiden Fällen benötigt.</p>
      </li>
    </ol>

    <p>Das neue <em>sendmail</em> sollte nun laufen.</p>

    <a name="2.9.6"></a>
    <h3>2.9.6: <tt>/etc/primes</tt> verschoben</h3>

    <p><tt>/etc/primes</tt> wurde in <tt>/etc/moduli</tt> umbenannt.
      Benenne sie einfach um oder kopiere die neue Datei aus
      <tt>/usr/src/etc</tt>.</p>


<a name="2.8"></a>
<h2>Von 2.8 upgraden</h2>


<a name="2.8.1"></a>
<h3>2.8.1: Neue Gruppe namens <em>auth</em></h3>

<p>Eine neue Gruppe namens <em>auth</em> mit der gid 11
wurde dem System hinzugefügt. Schreibe eine Zeile wie die
folgende in deine <tt>/etc/group</tt>:</p>

<pre>
  auth:*:11:
</pre>

<a name="2.8.2"></a>
<h3>2.8.2: Neues <em>wscons</em>-Konsolensystem</h3>

<p>Der <em>pcvt</em>-Konsolentreiber wurde gegen das
<em>wscons</em>-Konsolensystem ausgetauscht. Bevor wscons
eingesetzt werden kann, musst du neue wscons-bezogene
Gerätedateien erstellen. Stelle sicher, dass du das neueste
MAKEDEV installierst hast, und erstelle alle Gerätedateien:</p>

<pre>
 # cp /usr/src/etc/etc.i386/MAKEDEV /dev/MAKEDEV
 # cd /dev
 # ./MAKEDEV all
</pre>

<p>Wenn du X verwendest, dann musst du die Pointer-Sektion deiner
<em>XF86Config</em>-Datei so ändern, dass sie Folgendes enthält:</p>

<pre>
    Protocol    "wsmouse"
    Device      "/dev/wsmouse"
</pre>

<a name="2.8.3"></a>
<h3>2.8.3: Kernelkompilierung schlägt wegen undefinierten Symbolen
fehl</h3>

<p>Das Programm
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=config&amp;sektion=8">config(8)</a>
wurde aktualisiert. Das Erzeugen mit dem alten <em>config</em> wird
Fehler wie die folgenden verursachen:</p>
<pre>
  Undefined symbol `_pdevnames_size' referenced
  Undefined symbol `_pdevnames' referenced
</pre>

<p>Um diese zu beheben, kompiliere und installiere das neue
<em>config</em>:</p>
<pre>
  # cd /usr/src/usr.sbin/config
  # make clean &amp;&amp; make depend &amp;&amp; make
  # make install
</pre>

<p>Kompiliere nun einen neuen Kernel wie zuvor.</p>


<a name="2.7"></a>
<h2>
Von 2.7 upgraden
</h2>

<a name="2.7.1"></a>
<h3>
2.7.1: Welche großen Probleme treten beim Upgrade von 2.7 auf 2.8 auf?
</h3>

<p>
Signifikante gcc-Änderungen wurden vollzogen, die das Erstellen von
<em>libc</em>-Bibliotheken, die auf sich selbst verweisen, zu einfach
gemacht haben. Aus diesem Grund sollten Upgrades genau so durchgeführt
werden, wie hier beschrieben:
</p>

<ol>
<li><a href="faq5.html#ProbObj">Entferne Objektdateien</a> aus deinem
Source-Tree und lade 2.8-Quelltext herunter.</li>

<li>
<p>
Übersetze und instaliere einen neuen Linker. Dies <strong>muss</strong>
vor einer vollständigen Erzeugung des <em>gcc</em>s gemacht werden.
</p>
<pre>
  $ cd /usr/src/gnu/usr.bin/ld
  $ make clean &amp;&amp; make obj &amp;&amp; make
  $ sudo make install
</pre>
</li>
<li> Übersetze und installiere den neuen <em>gcc</em>. Verwende die
     <a href="faq5.html#NewCompiler">BOOTSTRAP</a>-Prozedur, um Dinge
     zu beschleunigen.
</li>

<li>
<p> Übersetze einen neuen Kernel. Installiere ihn aber noch nicht </p>
<pre>
  $ cd /usr/src/sys/arch/`machine`/conf
  $ config GENERIC
  $ cd ../compile/GENERIC
  $ make clean &amp;&amp; make depend &amp;&amp; make
</pre>
</li>

<li><p> Aufgrund einiger libc-Änderungen könnte es vorkommen, dass dein
   System beim Hochfahren hängt; Abhilfe schafft der
   <tt>/etc/resolv.conf</tt>-Eintrag <em>lookup file bind</em>. Füge
   diese Zeile ein, wenn es für deine Maschine notwendig ist.</p>
<pre>
  # echo &quot;lookup file bind&quot; &gt;&gt; /etc/resolv.conf
</pre>
</li>
<li> Instaliere den neuen Kernel und starte neu
<pre>
  # cd /usr/src/sys/arch/`machine`/compile/GENERIC
  # mv /bsd /bsd.old
  # mv bsd /bsd
  # chown root.wheel /bsd
  # shutdown -r now
</pre>
<p>
(Wenn dieser Schritt fehlschlägt, dann kannst du das System
wiederherstellen, indem du den alten Kernel (bsd.old) über den
<tt>boot&gt;</tt>-Prompt bootest.)</p>
</li>
<li>
<p>Übersetze und installiere das neue make (und Supportdateien).
     Überspringe nicht den »<tt>make depend</tt>«-Schritt.
</p>
<pre>
  $ cd /usr/src/usr.bin/make
  $ make clean &amp;&amp; make obj &amp;&amp; make depend &amp;&amp; make
  $ sudo make install
  $ cd /usr/src/share/mk
  $ sudo make install
</pre>
</li>

<li>
<p>Installiere den aktuellsten <em>mtree</em> und stelle sicher, dass
     die notwendige Verzeichnisstruktur vorliegt.</p>
<pre>
  $ cd /usr/src/etc/mtree
  $ sudo install -c -o root -g wheel -m 444 4.4BSD.dist /etc/mtree
  $ sudo mtree -qdef /etc/mtree/
</pre>
</li>

<li> Führe make build aus
<pre>
  # cd /usr/src &amp;&amp; make build
</pre>
</li>

<li> <a href="faq5.html#UpdateEtc">Aktualisiere <tt>/etc</tt>,
	<tt>/var</tt> und <tt>/dev/MAKEDEV</tt></a> manuell.

</li>
</ol>

<a name="2.6"></a>
<h2>
Von 2.6 upgraden
</h2>

<a name="2.6.1"></a>
<h3>
2.6.1: Termcap-Einträge sind zu lang.
</h3>

<p>
Es gibt eine neue <tt>termcaps.master</tt>-Datei. Du musst die
Dateien <tt>terminfo</tt> und <tt>termcaps</tt> mit der aktuellen
Version von
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=tic&amp;sektion=1">tic(1)</a>
generieren. Wenn du mittels <em>make build</em> upgradest, dann wird
die richtige Version von tic(1) automatisch für dich aufgerufen. Wenn
nicht, dann wirst du den folgenden Fehler erhalten:
</p>

<pre>
    terminfo.src is corrupt! You need to update /usr/bin/tic
</pre>

<p>
In diesem Fall musst du entweder tic(1) neu übersetzen und installieren
(stelle sicher, dass du die aktuelle Version von <tt>libcurses</tt>
verwendest) oder erzeuge einfach die Version von tic(1) in deinem
Source-Tree.
</p>

<a name="2.6.2"></a>
<h3>
2.6.2: Mein <em>pn</em>- (oder <em>mx</em>-, <em>al</em>-, <em>ax</em>-)
Device wird nicht mehr vom Kernel erkannt.
</h3>

<p> (Hinweis: <em>pn</em> wird für das einfache Verständnis im folgenden
Text verwendet. Es steht für <em>pn</em>, <em>mx</em>, <em>al</em>
oder <em>ax</em> [jenachdem, welches gerade zutrifft].)
</p>

<p>
Diese vier Treiber wurde mit einem vereinheitlichten <em>dc</em>-Treiber
ausgetauscht. Du musst alle Vorkommnisse von <em>pn*</em>, <em>mx</em>,
<em>al</em> und <em>ax</em> aus deinen Konfigurationsdateien
entfernen. Betroffen sind davon unter anderem:
</p>

<ul>
<li>Aktualisiere deine Kernelkonfigurationsdatei(en). (Hinweis: beginne
    mit einem neuen GENERIC-Kernel und mache an ihm die Änderungen)
</li>
<li>Verschiebe <tt>/etc/hostname.pn*</tt> nach
    <tt>/etc/hostname.dc*</tt>
</li>
<li>Aktualisiere deine <tt>/etc/ifaliases</tt>-Datei.
</li>
<li>Ändere deine <tt>/etc/ipnat.rules</tt> und <tt>/etc/ipf.rules</tt>,
    damit sie die neuen Interfacenamen beinhalten.</li>
</ul>

<p>
Wenn du einen angepassten Kernel modifizierst, stelle sicher, dass
du das <em>dcphy</em>-Device in deiner Kernelkonfiguration wie folgt
eingebunden hast:
</p>

<pre>
dcphy*  at mii? phy ?                           # Digital Clone PHYs
</pre>

<p>Wenn du schon dabei bist, möchtest du wahrscheinlich auch Folgendes
mit eintragen:</p>

<pre>
ukphy*  at mii? phy ?                           # "unknown" PHYs
</pre>

<a name="2.6.3"></a>
<h3>
2.6.3: Von gcc 2.95.1 auf 2.95.2 upgraden
</h3>

<p>Die <em>gcc</em>-Version 2.95.2 wurde in den OpenBSD-Source-Tree
um den 19. Januar 2000 herum übernommen. Damit <em>gcc</em>
ordnungsgemäß funktioniert, wird eine aktuellere (nach 2.6)
<em>libiberty</em> benötigt. Um diese Bibliothek zu erzeugen, führe
folgende Befehle aus:</p>

<pre>
	cd /usr/src/gnu/egcs/libiberty
	make -f Makefile.bsd-wrapper clean
	make -f Makefile.bsd-wrapper obj
	make -f Makefile.bsd-wrapper
	make -f Makefile.bsd-wrapper install
</pre>

<p>
HINWEIS: Auf mips-basierten Architekturen wie z.&nbsp;B. pmax
muss explizit <em>ldconfig</em> aufgerufen werden, wenn neue
Bibliotheken erzeugt wurden.
</p>

<p>Nachdem <em>libiberty</em> erzeugt wurde, kannst du mit einem
standardmäßigen <em>gcc</em>-Bootstrap fortfahren:</p>

<pre>
   cd /usr/src/gnu/egcs/gcc
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper obj
   make -f Makefile.bsd-wrapper -DBOOTSTRAP
   make -f Makefile.bsd-wrapper -DBOOTSTRAP install
   make -f Makefile.bsd-wrapper clean
   make -f Makefile.bsd-wrapper
   make -f Makefile.bsd-wrapper install
</pre>

<a name="2.6.4"></a>
<h3>
2.6.4: Kerberos upgraden.
</h3>

<p>
Damit Kerberos IV erfolgreich erzeugt werden kann, müssen die folgenden
Schritte zuvor befolgt werden:
</p>

<ul>
<li>
<p> Beziehe und erzeuge das aktuellste <tt>usr.bin/compile_et</tt>. </p>
<pre>
   # cd /usr/src/usr.bin/compile_et
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>

<li>
<p> Beziehe und erzeuge die aktuellste <tt>lib/libcom_err</tt>. </p>
<pre>
   # cd /usr/src/lib/libcom_err
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>

<li>
<p> Bereinige und installiere die Kerberos-Headerdateien neu: </p>
<pre>
  # rm -r /usr/include/kerberosIV/*
  # cd /usr/src/kerberosIV
  # make includes
</pre>
</li>
<li>
<p> Erzeuge nun die Kerberos-Bibliotheksdateien neu:</p>
<pre>
   # cd /usr/src/kerberosIV/lib
   # make clean &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>
<li>
<p> Wenn du kein vollständiges make build durchführst, dann erzeuge
    Kerberos neu:</p>
<pre>
   # cd /usr/src/kerberosIV
   # make cleandir &amp;&amp; make depend &amp;&amp; make &amp;&amp; make install
</pre>
</li>
<li> Starte ansonsten einfach dein <em>make build</em> neu. </li>
</ul>


<a name="2.6.5"></a>
<h3>
2.6.5: M4 upgraden.
</h3>

<p>
Die Version von m4, die mit OpenBSD 2.6 ausgeliefert wurde, wird in eine
Endlosschleife geraten, wenn die .mc-Dateien von sendmail in .cf-Dateien
umgewandelt werden. Du musst deshalb die neue Version von m4 installieren,
<strong>bevor</strong> du ein <em>make build</em> ausführen kannst. Mit
anderen Worten:
</p>

<pre>
    # cd /usr/src/usr.bin/m4
    # make &amp;&amp; make install &amp;&amp; make cleandir
</pre>

<a name="2.6.6"></a>
<h3>
2.6.6: Sendmail upgraden.
</h3>

<p>
In sendmail 8.10.X haben sich die Orte (und Namen) der
Konfigurationsdateien von sendmail geändert. Alles - bis auf die
PID-Dateien - befindet sich nun in /etc/mail. Zusätzlich haben sich
die Namen einiger Dateien geändert.
</p>

<table border="0">
<tr>
  <td><strong>ALT</strong></td>
  <td><strong>NEU</strong></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.cf</tt></td>
  <td><tt>/etc/mail/sendmail.cf</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.cw</tt></td>
  <td><tt>/etc/mail/local-host-names</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.ct</tt></td>
  <td><tt>/etc/mail/trusted-users</tt></td>
</tr>
<tr>
  <td><tt>/etc/sendmail.oE</tt></td>
  <td><tt>/etc/mail/error-header</tt></td>
</tr>
<tr>
  <td><tt>/etc/aliases</tt></td>
  <td><tt>/etc/mail/aliases</tt></td>
</tr>
<tr>
  <td><tt>/etc/service.switch</tt></td>
  <td><tt>/etc/mail/service.switch</tt></td>
</tr>
<tr>
  <td><tt>/etc/userdb</tt></td>
  <td><tt>/etc/mail/userdb</tt></td>
</tr>
<tr>
  <td><tt>/usr/share/misc/sendmail.hf</tt></td>
  <td><tt>/etc/mail/helpfile</tt></td>
</tr>
</table>

<p>
Es gibt einige Wege, wie man von der alten Sendmailkonfiguration zur
neuen wechselt; die ersten Schritte sind allerdings immer die gleichen.
</p>

<ol>
<li> Aktualisiere <tt>/etc/rc</tt>, so dass nach
     <tt>/etc/mail/sendmail.cf</tt> und nicht nach
     <tt>/etc/sendmail.cf</tt> gesucht wird.
</li>
<li> <tt>mv /etc/sendmail.cf /etc/mail/sendmail.cf</tt> <br />
     Dies ist der Weg mit dem geringsten Widerstand: so musst du
     jedenfalls nicht die Pfadangaben der anderen Dateien ändern.
</li>
<li> Oder erzeuge eine neue .cf-Datei aus deiner .mc-Quelldatei.
     Beachte, dass du nicht mehr folgende Zeile angeben musst:
     <pre>include(`../m4/cf.m4')</pre>
     da diese von make aus eingebunden wird. Beachte des Weiteren, dass
     wenn du Maschinen in die Klasse w (über »Cw Maschinenname«)
     einbinden willst, du dies jetzt in der LOCAL_CONFIG-Sektion
     machen musst (wirf einen Blick in <tt>openbsd-lists.mc</tt>, um
     ein Beispiel davon zu sehen).
</li>
</ol>

<a name="2.6.7"></a>
<h3>
2.6.7: Nach dem Upgraden booten die Kernel nicht mehr, die Unterstützung
für
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=apm&amp;sektion=8&amp;arch=i386">apm(8)</a>
beinhalten.
</h3>

<p>
Du musst deine Bootblocks aktualisieren. Lies
<a href="faq14.html#14.8">Section 14.8</a>
der OpenBSD-FAQ, um weitere Details darüber zu erfahren.
</p>

<a name="2.6.8"></a>
<h3>
2.6.8: Standardgruppe des Benutzers <em>daemon</em> geändert
</h3>

<p>Die Standardgruppe des Benutzers <em>daemon</em> wurde von
31 auf 1 umgestellt. Verwende vipw, damit diese Änderung wirksam
wird, so dass der Eintrag für den Benutzer daemon wie folgt aussieht:
<p><tt>daemon:*:1:1::0:0:The devil himself:/root:/sbin/nologin</tt>
</p>

<a name="2.5"></a>
<h2>Von 2.5 upgraden</h2>

<a name="2.5.1"></a>
<h3>
2.5.1: Welche großen Probleme treten beim Upgrade von 2.5 auf 2.6 auf?
</h3>

<h5><em>Perl</em> und <em>make</em></h5>
<p>
Die aktuellste Version von Perl (5.005_03) benötigt eine neue Version
von <em>make</em>, um richtig erzeugt werden zu können. Du musst make
vor der Erzeugung des neuen Perls übersetzen und installieren. Führe
Folgendes aus:
</p>

<pre>
# cd /usr/src/usr.bin/make
# make clean &amp;&amp; make &amp;&amp; make install
</pre>

<p>
Führe den Prozess fort und erzeuge wieder das neue Perl. Du musst das
<code>obj</code>-Verzeichnis von Perl manuell leeren, bevor du mit
der Erzeugungsphase beginnst.
</p>

<p>
Perl-Entwickler sollten sich die aktuellsten Änderungen genau
ansehen. Eine E-Mail von
millert@openbsd.org:
</p>

<pre>
The version of perl in the OpenBSD source tree (post 2.5) has been
upgraded to 5.005_03.  The build method has changed somewhat but
most of that should be invisible.  The important changes that affect
people are as follows:

1) Perl lib files have moved from /usr/lib/perl5 to the more correct
/usr/libdata/perl5
2) The default site_perl directories now live in /usr/local.  Ie:
if you install a perl module, it will place itself in
/usr/local/libdata/perl5/site_lib.  This makes it easy to
see what non-stock modules you have.  It also means that we
can have perl modules in the ports system easily.
3) The perl library man pages are now install in /usr/share/man/cat3p
You'll need to update your man.conf based on the src/etc/man.conf
to take advantage of them.  This means you can now do
"man 3p less" and get info on the less pragma but "man less"
will still get you the less pager manpage.

If you have modules or other non-stock perl files the simplest thing
to do is to move /usr/lib/perl5 to /usr/libdata/perl5 and add a link
from /usr/lib/perl5 to /usr/libdata/perl5.  Alternately, you could
just edit the installed Config.pm file and fix up the paths there.

</pre>

<h5>Compileränderung: <em>egcs</em> ersetzt <em>gcc</em></h5>
<p>
Diese Änderung ist sehr wahrscheinlich die signifikanteste Änderung,
der du begegnen wirst. Lies die Sektion <a href="#2.5.2">2.5.2</a>,
um eine ausführliche Beschreibung zu erhalten.
</p>

<h5>Kernelstruktur - <em>statfs</em> - geändert</h5>
<p>
Die <tt>statfs</tt>-Struktur wurde am 31. Mai geändert. Du musst
deinen Kernel neu erzugen, bevor du ein <em>make build</em>
ausführen kannst.
Siehe <a href="#2.5.3">2.5.3</a> für weitere Details.
</p>

<a name="2.5.2"></a>
<h3>
2.5.2: Wie upgrade ich von <em>gcc</em> auf <em>egcs</em>
</h3>

<p>
Die sicherste Weg ist, über einen aktuellen Snapshot upzugraden -
wenn einer verfügbar ist. <strong>Sieh erst nach, ob ein neuer
Snapshot vorliegt!</strong> Den neuen Compiler vom alten aus
zu bootstrappen wird als <em>letzte Möglichkeit</em> betrachtet.
</p>

<p>
Beachte zuerst, dass einige Plattformen noch nicht erfolgreich
bootstrappen konnten. Bis zum heutigen Tag sollten die folgenden
erfolgreich gebootstrappt werden können, wenn du vorsichtig
vorgehst:
</p>

<ul>
<li><strong>i386</strong>
<li><strong>sparc</strong>
<li><strong>m68k</strong>
<li><strong>alpha</strong>
</ul>

<p>
<strong>mips</strong> und <strong>rs6000</strong> haben Probleme.
</p>

<p>
Um zu überprüfen, ob deine Plattform gebootstrappt werden kann,
beziehe und installiere den egcs-Snapshot, der aus der
<a href="../../de/ports.html">Portskollection</a> installiert
werden kann. Wenn dieser funktioniert, dann wird es der im Tree
befindliche vermutlich auch tun. Dies ist die <em>sicherste</em>
Vorgehensweise.
</p>

<p>
Bevor wir nun auch nur einen Schritt weitergehen, stelle zunächst
sicher, dass deine Kopien von <em>binutils</em>, <em>gas</em> und
<em>ld</em> auf dem aktuellsten Stand sind. Beachte, dass es von
<em>gas</em> und <em>ld</em> zwei Kopien im Tree gibt. Für
<strong>i386</strong> und <strong>sparch</strong> werden die
Binutils-Version nicht genommen. Überprüfe
<tt>/usr/src/gnu/usr.bin/gas</tt> und <tt>/usr/src/gnu/usr.bin/ld</tt>
stattdessen.
</p>

<p>
Die folgenden Anweisungen beziehen sich auf den ursprünglichen
Snapshot (egcs-990517). Seitdem wurde ein zweiter Snapshot (egcs-990608)
in den Tree übernommen. Wenn du von einem reinen 2.5-System kommst,
wird es sehr unwahrscheinlich sein, dass du direkt die aktuellste
Version kompilieren kannst. In diesem Fall musst du zur früheren Version
mit diesen Anweisungen bootstrappen.
</p>

<p>
Von espie@openbsd.org:
</p>

<blockquote>
<pre>
Today, the compiler changes.

Exit gcc 2.8.1, enter egcs... or more precisely, gcc 2.95 prerelease.

This is probably going to be a rough ride, but I can't work out all
the kinks on every architecture by myself.

I'm going to start importing stuff *now*. There will be a second message
to tech@ once things are settled...

Thanks to everyone who helped me sorting stuff out, most especially
niklas, turan, and millert.

Why the switch
--------------
as most of you already know, egcs is now the *official* compiler supported
by the FSF.  The upcoming july release as been re-christened gcc 2.95.

Just looking at the log messages will show you many improvements:
support for newer processors is better, C++ is more accurately matching
the ANSI/ISO standards, Fortran 77 is more closely integrated.
There are also countless bug-fixes and code generation improvements.

Also the development is more open. There is a cvs tree, there are several
mailing-lists available, and we are cooperating closely with the egcs
team. More precisely, I've been feeding patches back to the egcs team
so that OpenBSD configurations are officially supported.
Also, the development team is highly responsive to bug-reports, and problems
get fixed.

There also is a band-wagon phenomenon: everyone is switching to egcs,
which means lots of code to test the compiler on, and that we can benefit
from related projects.

Why now
-------
egcs-1.1 was unfit for some purposes. Specifically, code size on i386
was larger than gcc 2.8.1, which yielded floppy-disks problems.
At 2.5 freeze, the only code fit to include was a somewhat unstable
snapshot.  In the interest of stability, after much pondering, egcs was
not put into 2.5.

Right now, the egcs project is going through a release cycle which will
yield egcs 1.2.  Judging from their time schedule, there is ample margin
between egcs 1.2 and the next release of OpenBSD.  Also, we want to get
in now, so that we get a chance to report problems on less frequently
used architectures, and get everything fixed for 1.2.

egcs `feature freeze' is supposed to occur on may 7th, and the current
snapshot 19990502 looks solid.

What works and what doesn't
---------------------------
egcs runs an i386 OpenBSD system without problems.  m68k works as well,
with a few work-arounds linked to obscure bugs that will get fixed.
sparc seems to be running as well.  There is some linker trouble on some
other arches that needs to be fixed before our next release.

Right now, constructors across dynamic libraries are not quite ready.

egcs now features a stand-alone cpp which is going to be better than
the current hackish solution we use. This means a few interface changes
and possibly weird warnings.

Keeping gcc 2.8.1 ?
-------------------
due to size constraints, as soon as egcs is imported, gcc is going
to move to cvs Attic.  If you don't want to deal with egcs now, you'll
have to be careful through your cvs updates.
Some Makefiles are bound to change: includes, gnu/usr.bin, and gnu/lib.
xlint and cpp.sh are going to change as well.

How to bootstrap the compiler
-----------------------------
the simplest way is probably to trust the various arch maintainers
and download a snapshot.

If you want to do stuff the hard way, you must first remake proper
obj dirs:
cd /usr/src
make obj

If you run i386, gas must be up-to-date.
If you run sparc, ld must be up-to-date.

then build libiberty:
cd /usr/src/gnu/egcs/libiberty
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper
make -f Makefile.bsd-wrapper install

then the C compiler:
cd /usr/src/gnu/egcs/gcc
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper
make -f Makefile.bsd-wrapper install

rebuild the C compiler with the new version:
cd /usr/src/gnu/egcs/gcc
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper
make -f Makefile.bsd-wrapper install

rebuild the includes
cd /usr/src/include
make includes

build all egcs libraries and install them
cd /usr/src/gnu/egcs
make -f Makefile.bsd-wrapper clean
make -f Makefile.bsd-wrapper depend
make -f Makefile.bsd-wrapper
make -f Makefile.bsd-wrapper install

install the new cpp driver
cd /usr/src/usr.bin/cpp
make install

then you're all set, and a standard make build should work...
</pre>


<p>
[Anmerkung des Autors: Nun, so richtig funktioniert es nicht. Das
Programm xlint kann nicht erzeugt werden. Die Behebung des Problems ist
aber recht einfach. Führe einfach
<code> make &amp;&amp; make install </code>
im <code>/usr/src/usr.bin/xlint/xlint</code>-Verzeichnis aus, bevor
du ein <em>make build</em> aufrufst und weiter forsetzst. Wirf einen
Blick auf <a href="#2.5.2.2">2.5.2.2</a>.]
</p>

<pre>
If it doesn't, you're using an arch that didn't go through make build yet.
The most probably occurrence is an Internal Compiler Error, as known as an
ICE.

First try to see if the ICE will go away with -O1 or -O0. In that case, you
can put a work-around in the Makefile until it's fixed
(see /usr/src/lib/libm/Makefile for an example of how to put in such
work-arounds for m68k).

Then the error needs to be reported to the egcs-bugs mailing list.

At a minimum, you must run the source through the same compiler invocation,
with an addition of -v -save-temps to the options.

-v yields the precise sequence of commands invoked by gcc. -save-temps
will give you a pre-processed C file (.i) or C++ (.ii) that the egcs people
can make sense of... you can't ask them to run OpenBSD on their boxes.

If you have more time, you can try to trim down the pre-processed C file to
the bare minimum that triggers the bug. Dichotomy works nicely.
</pre>
</blockquote>

<p>
Wenn du diese ganze Prozedur durchgeführt hast und immernoch alles
funktioniert, dann: glückwunsch. Wenn nicht, dann solltest du die
folgenden Sektionen nach Ratschlägen durchsuchen. Probleme, die hier
nicht aufgelistet werden, sollten an tech@openbsd.org gesendet werden.
</p>

<a name="2.5.2.1"></a>
<h5>
2.5.2.1 - <tt>i386</tt> und <tt>sparc</tt> werden nicht mehr
per <tt>#define</tt> definiert
</h5>

<p>
Das stimmt. Der Kompiler <em>egcs</em> verwendet die sauberen
<tt>__i386__</tt> und <tt>__sparc__</tt>. Wenn du Quelltext
kompilieren musst, dier auf den alten Definitionen basiert, dann
füge <tt>-Dsparc</tt> oder <tt>-Di386</tt> an die passende Stelle
in deiner Makefile an.
</p>

<a name="2.5.2.2"></a>
<h5>
2.5.2.2 - Erzeugungsphase bricht bei xlint ab
</h5>

<p>
Dies liegt an semantischen Unterschieden im cpp. Die Umgehung des
Problems ist aber recht einfach; ein ähnliches Problem mit
<em>cap_mkdb</em> wird in <a href="#2.4.2">2.4.2</a> beschrieben.
</p>

<p>
Führe folgende Befehle aus:
</p>

<pre>
# cd /usr/src/usr.bin/xlint/xlint
# make &amp;&amp; make install
</pre>

<p>
rufe nun erneut make auf; die Erzeugungsphase sollte forgesetzt werden.
</p>

<a name="2.5.2.3"></a>
<h5>
2.5.2.3 - Coredump bei <tt>uthread_autoinit.c</tt>
</h5>

<p>
Du bist Opfer eines Linkerbugs geworden. Hier ist die relevante
Nachricht:
</p>

<pre>
From: Marc Espie &lt;Marc.Espie@liafa.jussieu.fr&gt;
Subject: egcs core-dumping on uthread_autoinit.c

If this happens to you, this is a known linker problem... the cc1 you have
was linked in a weird way.

Initially, I made cc1 link against static /usr/lib/libiberty.a to avoid this
problem, but this was cutting things too close, and the bug reappeared,
probably thanks to unrelated changes in libc or elsewhere...

The tree has been patched with a work-around in

src/gnu/egcs/f/lang-options.h

make sure you have the kludged version of that file (at least rev 1.2),
recompile and reinstall cc1, the problem should go away.

What's going on is that the 386 linker gets something wrong because of
the huge strings array in toplev.c, and something gets mislinked, so
that
void f(void) __attribute((constructor)) {}
kills cc1.

As a work-around, I've killed Fortran options help texts, until someone finds
where the linker errs.
</pre>

<a name="2.5.2.4"></a>
<h5>
2.5.2.4 - <em>egcs</em> scheint viel langsamer zu sein als <em>gcc</em>
</h5>

<p>
Das stimmt; es gibt aber einen Grund. Der Kompiler <em>egcs</em> führt
mehr Optimierungen durch. Datenablage und andere derartige
Funktionalitäten sind mit <em>egcs</em>-kompilierten Code besser.
</p>

<a name="2.5.2.5"></a>
<h5>
2.5.2.5 - <em>egcs</em> generiert größeren Code als <em>gcc</em>
</h5>

<p>
Ja, in der Tat. Dies ist insbesondere dann auffällig, wenn die
alte gcc-Option <tt>-O2</tt> angegeben wurde. Mit <em>egcs</em> wurde
eine neue Option eingeführt: <tt>-Os</tt> optimiert auf Größe. Diese
Option ist im Großen und Ganzen mit dem Verhalten der alten
<tt>-O2</tt> vergleichbar.
</p>

<a name="2.5.2.6"></a>
<h5>
2.5.2.6 - Nach der Installation von <em>egcs</em> hatte ich nur noch
wenig Plattenspeicher übrig
</h5>

<p>
<em>egcs</em> installiert in ein anderes Unterverzeichnis als gcc 2.8.1.
Du solltest <em>gcc</em> deinstallieren, sobald egcs gebootstrappt wurde
und voll funktionsfähig ist.
</p>

<p>
Ein ähnlicher Hinweis sagte, dass die Perländerungen, die in
<a href="#2.5.1">2.5.1</a> besprochen wurden, darauf verwiesen haben,
dass das <tt>/usr/lib/perl5</tt>-Verzeichnis entfernt werden konnte.
Der neue Ort für diese Daten ist <tt>/usr/libdata/perl5</tt>.
</p>

<a name="2.5.2.7"></a>
<h5>
2.5.2.7 - Meine Erzeugungsphase bricht während libcurses ab
</h5>

<p>
Die Bibliothek <em>libcurses</em> baut nun auf der aktuellsten Version
von <em>cpp</em> auf. Beziehe die aktuellste Version, erzeuge
<em>cpp</em> neu und setze die Erzeugungsphase fort. Zum Beispiel:
</p>
<pre>
# cd /usr/src/usr.bin/cpp &amp;&amp; make install
</pre>

<p>Und probiere danach wieder make build.</p>

<a name="2.5.2.8"></a>
<h5>
2.5.2.8 - make obj schlägt fehl
</h5>

<p>
Wenn dein <em>make obj</em> fehlschlägt und davon berichtet,
dass Fehler in einer Makefile bestehen, dann sind deine
Makefiles wahrscheinlich verarltet. Zum Beispiel:
</p>

<pre>
===&gt; lib/libkvm
"Makefile", line 30: Malformed conditional ((${UVM} == "yes"))
"Makefile", line 30: Missing dependency operator
"Makefile", line 32: if-less endif
"Makefile", line 32: Need an operator
Fatal errors encountered -- cannot continue

</pre>

<p>
Dies kann behoben werden, indem die Makefile-Includes
neu erzeugt werden. Führe Folgendes aus:
</p>

<pre>
cd /usr/src/share/mk &amp;&amp; make install
</pre>

<p>
und versuche erneut, make build auszuführen.
</p>

<a name="2.5.3"></a>
<h3>
2.5.3: Mein <em>make build</em> bricht mit Fehlern über
<em>unimplemented syscall</em> ab
</h3>

<p><strong>Kurze Antwort:</strong> </p>

<p>
Die Kernelstruktur <tt>statfs</tt> hat sich geändert. Du musst den
Kernel neukompilieren, bevor du ein <em>make build</em> aufrufen
kannst.
</p>

<p><strong>Lange Antwort:</strong> </p>

<p>
Die Kernelstruktur <tt>statfs</tt> hat sich geändert. Der neue
<tt>struct statfs</tt> hat folgende Funktionalitäten:
</p>

<ul>
<li> Hat ein <tt>u_int32_t</tt> Flagsfeld - softdep kann nun ein echtes
     Flag haben.
</li>

<li> Verwendet <tt>u_int32_t</tt> statt longs (hübscher auf alphas).
Hinweis: die Manualseite sagte über das Setzen von
ungültigen/ungebrauchten aus, dass dies mit -1 getan wird - das war
falsch. SunOS macht das - unserer hat das noch nie getan.
</li>

<li> Beseitigte <tt>f_type</tt> vollständig. Es wurde seit NetBSD 0.9
nicht mehr genutzt und es gab nur Verwirrung, da es immer 0 zurückgab.
Man kann davon ausgehen, dass alter Code nicht mehr funktionsfähig sein
wird, doch ist das immer noch besser, als wenn etwas unentdeckt auf
einmal nicht mehr funktioniert.
</li>

<li> Fügt eine <tt>mount_info</tt>-Union ein, die das
<tt>FSTYPE_args</tt>-struct enthält. Das heißt, dass <em>mount</em>
dir nun alle Optionen eines Dateisystems mitteilen kann, mit denen es
gemountet wurde. Dies ist insbesondere mit NFS hilfreich.
</li>
</ul>

<p>
Weitere Veränderungen:
</p>

<ul>
<li> Die Linux-statfs-Emulation konvertierte nicht zwischen
BSDs fs names und Linux' <tt>f_type</tt>-Nummern. Dies wird nun
gemacht, da BSDs <tt>f_type</tt>-Nummer für Linux-Applikationen
nutzlos geworden sind (wurden mittlerweile sowieso entfernt).
</li>

<li> FreeBSDs struct statfs unterscheidet sich zu unserem (sowohl in
der alten als auch in der neuen Fassung) und muss daher konvertiert
werden. Zuvor wurden OpenBSD-Systemaufrufe genutzt, ohne dass echte
Konvertierung stattfand.
</li>

<li> <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&amp;sektion=8">mount(8)</a>
wird nun zusätzliche Informationen ausgeben, wenn es ohne Argumente
aufgerufen wurde. Verwende jedoch die Option -v (verbose), wenn du
<em>alles</em> sehen möchtest.
</li>
</ul>

<a name="2.5.4"></a>
<h3>
2.5.4: Verweis auf das neue 2.6-Verzeichnis.
</h3>

<p>
Wenn du auf 2.6 upgradest, dann musst du einen einfachen Verweis für
gcc erstellen.
</p>

<pre>
   cd /usr/lib/gcc-lib
   ln -s ${ARCH}-unknown-openbsd2.5 ${ARCH}-unknown-openbsd2.6
</pre>

<a name="2.5.5"></a>
<h3>
2.5.5: Nach einem <strong>(U)</strong>pgrade schlägt das Entpacken von
<em>base26.tar.gz</em> mit einer Meldung fehl:
</h3>

<p>
<em>tar: Unable to remove directory ./usr/include/machine &lt;Directory
not empty&gt;
</em>
</p>

<p>Unter 2.5 war <tt>/usr/include/machine</tt> ein Verzeichnis und
<tt>/usr/include/i386</tt> ein Verweis auf dieses. Unter 2.6 ist es
genau andersherum.
</p>

<p>
Um dieses Problem zu beheben, musst du die Shell aufrufen, das
<tt>/usr/include/machine</tt>-Verzeichnis entfernen und das Upgrade
erneut durchführen.
</p>


<a name="2.4"></a>
<h2>Von 2.4 upgraden</h2>

<a name="2.4.1"></a>
<h3>2.4.1: Änderungen an den Manualseiten</h3>
<p>
Einige Manualseiten wurden aus Sektion 1 in andere Sektionen
verschoben. Unglücklicherweise bleiben die alten Manualseiten in
Sektion 1, wodurch Benutzer nicht die aktuellste Version der Seite
sehen werden.
</p>

<p>
Die folgenden Seiten sollten entfernt werden:
</p>
<pre>
/usr/share/man/cat1/ipf.0
/usr/share/man/cat1/ipnat.0
/usr/share/man/cat1/ipsecadm.0
</pre>

<a name="2.4.2"></a>
<h3>2.4.2: Syntax von <em>cap_mkdb</em> wurde geändert</h3>

<p>
<strong>Symptom:</strong>
</p>

<p>
Ein <em>make build</em> endet mit einem Fehler wie diesem:
</p>

<pre>
cap_mkdb -i -f terminfo terminfo.src
cap_mkdb: illegal option -- i
usage: cap_mkdb [-v] [-f outfile] file1 [file2 ...]
*** Error code 1
</pre>

<p>
<strong>Korrektur:</strong>
</p>

<p>
Die Syntax, mit der man <em>cap_mkdb</em> aufruft, hat sich geringfügig
verändert. Vor dem Aufruf von <em>make build</em> solltest du cap_mkdb
aus den aktuellsten Quelltexten heraus neu erzeugen:
</p>

<pre>
# cd /usr/src/usr.bin/cap_mkdb
# make clean &amp;&amp; make &amp;&amp; make install
</pre>

<p>
Das make build sollte dann durchlaufen.
</p>


<a name="2.4.3"></a>
<h3>2.4.3: Snake</h3>
<p>
Du wirst den Inhalt des obj-Verzeichnisses löschen müssen, bevor du
<code>/usr/src/games/snake</code> upgraden kannst.
</p>

<a name="2.3"></a>
<h2>Von 2.3 upgraden</h2>

<a name="2.3.1"></a>
<h3>
2.3.1: Neuer Benutzer: <em>named</em>
</h3>

<p>
Nach der Veröffentlichung von 2.3 wurde der DNS-Daemon <em>named</em>
in ein Chrootjail gesperrt. Damit diese Änderung funktioniern kann, muss
der Benutzer <em>named</em> angelegt werden. Wenn du dies noch nicht
gemacht hast, musst du diesen Benutzer anlegen, um sicherzustellen,
dass alle Verzeichnis während des Erzeugungsprozesses wie erwartet
angelegt werden.
</p>

<p>
Füge den folgenden Eintrag in /etc/passwd mittels
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vipw&amp;sektion=8">vipw(8)</a>
ein:
</p>

<pre>
named:*:70:70::0:0:BIND Daemon:/var/named:/sbin/nologin
</pre>

<p>
Das Folgende muss in /etc/group eingetragen werden:
</p>

<pre>
named:*:70:
</pre>


<a name="2.3.2"></a>
<h3>
2.3.2: Ich habe versucht, das System zu erzeugen, doch schlägt der
Prozess fehl, wenn <em>ssleay</em> kompiliert werden soll.
</h3>

<p>
Dir fehlt vermutlich ein Eintrag für den Benutzer <em>named</em> in
deiner Passwortdatei.
</p>

<p>
<strong>Kurze Antwort:</strong>
</p>

<p>
Erstelle vor der Erzeugungsphase den Benutzer.
</p>

<p>
<strong>Lange Antwort:</strong>
</p>

<p>
Der Benutzer <em>named</em> wird benötigt, damit die Rechte
korrekt gesetzt werden können. Wenn der Benutzer nicht vorliegt, dann
wird ein Teil des Erzeugungsprozesses fehlschlagen. Wenn du die
Erzeugung in einer Datei protokolliert hast (zum Beispiel mit dem
Aufruf <em>make build &amp;&gt;/tmp/build.log</em>), dann wirst du
folgende Nachricht vorfinden:
</p>

<pre>
(cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs)
install -d -o root -g wheel -m 755 /
mtree -def mtree/4.4BSD.dist -p // -u

mtree: unknown user named
mtree: failed at line 1632 of the specification
*** Error code 1 (ignored)
</pre>

<p>
Unglücklicherweise haben wir nicht festgestellt, dass die Erzeugung
normal weitergeführt wurde; es wurde vollkommen missachtet, dass ein
Fehler auftrat.
</p>

<p>
Wenn der Benutzer <em>named</em> vorliegt, wird mtree normal
funktionieren:
</p>

<pre>
missing: ./var/named (created)
missing: ./var/named/dev (created)
missing: ./var/named/etc (created)
missing: ./etc/afs (created)
missing: ./etc/ssl (created)
missing: ./etc/ssl/private (created)
missing: ./usr/obj (not created: File exists)
missing: ./usr/share/doc/html (created)
missing: ./usr/share/doc/html/lynx_help (created)
missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
missing: ./usr/share/doc/usd/13.viref (created)
missing: ./usr/share/man/cat4/powerpc (created)
missing: ./usr/share/man/man4/alpha (created)
missing: ./usr/share/man/man4/pmax (created)
missing: ./usr/share/man/man4/powerpc (created)
missing: ./usr/share/tmac/mdoc (created)
missing: ./var/www/htdocs/manual/vhosts (created)
missing: ./usr/include/ssl (created)
</pre>

<p>
Der Grund für den Fehler ist, dass das Verzeichnis
<em>/usr/include/ssl</em> niemals erstellt wurde. Ohne diese
Headerdateien kann <em>ssleay</em> nicht übersetzt werden.
</p>

<p>
<strong>Korrektur:</strong>
</p>

<p>
Erstelle den Benutzer und die Gruppe mit dem Namen <em>named</em>.
Entferne <em>/usr/include/ssl</em> und <em>/var/named</em> und alle
anderen Verzeichnisse aus der vorherigen Liste, die versehentlich beim
Aufruf von <em>make build</em> als normale Datei angelegt worden sind.
</p>


<a name="2.3.3"></a>
<h3>
2.3.3: Ich habe versucht, dass System zu erzeugen, doch schlägt der
Prozess fehl, wenn ich das System für die PowerPC-Architektur erstelle.
</h3>

<p>
Dein Verzeichnisbaum ist unvollständig. Genauer gesagt: das
Verzeichnis <tt>/usr/share/man/cat4/powerpc</tt> fehlt.
</p>

<p>
<strong>Schnelle Korrektur:</strong>
</p>

<p>
Erstelle das Verzeichnis und fahre mit der Kompilierung fohrt.
</p>

<p>
<strong>Vollständige Korrektur:</strong>
</p>

<p>
Erstelle den gesamten Verzeichnisbaum. Führe dafür Folgendes aus:
</p>

<pre>
# cd /usr/src/etc &amp;&amp; make DESTDIR=/ distrib-dirs
</pre>

<p>
Du wirst vermutlich eine Ausgabe wie die folgende sehen:
</p>

<pre>
install -d -o root -g wheel -m 755 /
mtree -def mtree/4.4BSD.dist -p // -u

missing: ./var/named (created)
missing: ./var/named/dev (created)
missing: ./var/named/etc (created)
missing: ./etc/afs (created)
missing: ./etc/ssl (created)
missing: ./etc/ssl/private (created)
missing: ./usr/obj (not created: File exists)
missing: ./usr/share/doc/html (created)
missing: ./usr/share/doc/html/lynx_help (created)
missing: ./usr/share/doc/html/lynx_help/keystrokes (created)
missing: ./usr/share/doc/usd/13.viref (created)
missing: ./usr/share/man/cat4/powerpc (created)
missing: ./usr/share/man/man4/alpha (created)
missing: ./usr/share/man/man4/pmax (created)
missing: ./usr/share/man/man4/powerpc (created)
missing: ./usr/share/tmac/mdoc (created)
missing: ./var/www/htdocs/manual/vhosts (created)
missing: ./usr/include/ssl (created)
</pre>

<p>
Beachte, dass /usr/share/man/cat4/powerpc eines der Verzeichnisse war,
die mit diesem Prozess angelegt wurden.
</p>



<p>
--
</p>
<address>
<p>
<!--
Originally [OpenBSD: upgrade-old.html,v 1.18 ]<br>
$Translation: upgrade-old.html,v 1.12 2007/06/20 17:34:09 paldium Exp $<br>
-->
$OpenBSD: upgrade-old.html,v 1.11 2007/06/23 18:29:30 jufi Exp $
<br />
Copyright &copy; 1998-2007, OpenBSD.
<br />
</address>

</body>
</html>

