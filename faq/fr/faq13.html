<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><title>13 - Multimedia</title>

<link rev="made" href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta name="description" content="the OpenBSD FAQ page">
<meta name="keywords" content="openbsd,faq">
<meta name="distribution" content="global">
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
</head>

<!--
Copyright (c) 2005, Steven Mestdagh <steven.mestdagh@esat.kuleuven.be>

Permission to use, copy, modify, and distribute this documentation for
any purpose with or without fee is hereby granted, provided that the
above copyright notice and this permission notice appear in all copies.

THE DOCUMENTATION IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL
WARRANTIES WITH REGARD TO THIS DOCUMENTATION INCLUDING ALL IMPLIED
WARRANTIES OF MERCHANTABILITY AND FITNESS. IN NO EVENT SHALL THE
AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT, INDIRECT, OR CONSEQUENTIAL
DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM LOSS OF USE, DATA OR
PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR OTHER
TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS DOCUMENTATION
-->

<body bgcolor="#ffffff" text="#000000">

<a href="http://www.openbsd.org/index.html">
<img alt="[OpenBSD]" src="../../images/smalltitle.gif" border="0" height="30" width="141">
</a>
<p>
<font color="#0000e0">
<a href=" index.html">[Index de la FAQ]</a>
<a href=" faq12.html">[Section 12 - Questions spécifiques aux plateformes]</a>
<a href=" faq14.html">[Section 14 - Configuration des disques]</a>
</font>

</p><h1><font color="#e00000">13 - Multimedia</font></h1><hr>

<h3>Table des matières</h3>
<ul>
<li><a href="#confaudio">13.1 - Comment configurer mon périphérique audio ?</a>
</li><li><a href="#playaudio">13.2 - Jouer différents types de formats audio</a>
</li><li><a href="#playCD">13.3 - Comment jouer des CDs dans OpenBSD ?</a>
</li><li><a href="#recordaudio">13.4 - Puis-je utiliser OpenBSD pour enregistrer des séquences audio ?</a>
</li><li><a href="#lossyaudio">13.5 - Parlez moi de l'encodage Ogg Vorbis et MP3 ?</a>
</li><li><a href="#playDVD">13.6 - Comment lire des vidéos DVDs sous OpenBSD ?</a>
</li><li><a href="#burnCD">13.7 - Comment graver des CDs et DVDs ?</a>
<ul>
  <li><a href="#burnIntro">13.7.1 - Introduction et configuration de base</a>
  </li><li><a href="#writeCD">13.7.2 - Graver des CDs</a>
  </li><li><a href="#writeDVD">13.7.3 - Graver des DVDs</a>
</li></ul>
<li><a href="#convert">13.8 - Je voudrais mes fichiers multimédia au format FOO.</a>
<li><a href="#streaming">13.9 - Est-il possible de lire des fichiers en streaming sous OpenBSD ?</a>
<!--
<li><a href="#camera"     >13.xx - Can I use my digital camera under OpenBSD?</a>
<li><a href="#scanner"    >13.yy - How do I set up and use my scanner?</a>
-->
</li></ul>
<hr>

<a name="confaudio"></a>
<h2>13.1 - Comment configurer mon périphérique audio ?</h2>

Les périphériques concernant l'audio sous OpenBSD sont :
<tt>/dev/audio</tt>, <tt>/dev/sound</tt>, <tt>/dev/audioctl</tt> et
<tt>/dev/mixer</tt>.
Pour une belle introduction à la couche de support audio, vous pouvez
lire la page de manuel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audio&amp;sektion=4">audio(4)</a>.

<p>
Tous les matériels audio supportés sont déjà inclus dans le noyau
GENERIC, il n'y a donc pas besoin de configuration supplémentaire ou
d'installation de drivers.
Pour trouver des informations spécifiques à la puce de votre carte son,
vous devrez déterminer quelle puce vous avez. Les puces supportées
peuvent être trouvées sur la page des matériels supportés pour votre
<a href="../../fr/plat.html">plateforme</a>.
Si vous avez déjà OpenBSD lancé, cherchez l'apparition d'un driver de
carte son dans la sortie de la commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=1">dmesg(1)</a>,
et lisez le manuel du driver pour des informations plus spécifiques
comme les options et autres détails sur celui-ci.
Voici un exemple d'une puce audio dans une sortie dmesg :

<blockquote><pre>auich0 at pci0 dev 31 function 5 "Intel 82801BA AC97" rev 0x04: irq 10, ICH2 AC97
ac97: codec id 0x41445360 (Analog Devices AD1885)
ac97: codec features headphone, Analog Devices Phat Stereo
audio0 at auich0
</pre></blockquote>

<p>
Vous pouvez tester si votre matériel audio fonctionne correctement en
lui envoyant un fichier audio (souvent d'extension .au).
Si vous ne disposez pas de fichier audio, vous pouvez envoyer n'importe
quel fichier texte ou binaire sur le périphérique :

<blockquote><pre>
$ <strong>cat filename &gt; /dev/audio</strong>
</pre></blockquote>

Si vous entendez quelque chose (si ne n'est pas un fichier audio le son
ne sera pas aggréable), cela signifie que la puce de votre matériel est
supportée par OpenBSD et fût reconnue et configurée par le noyau lors du
démarrage. Dans le cas contraire il existe un certain nombre de
possibilités :

<ul>
<li>Le fichier que vous avez envoyé est tellement petit que vous avez du
    mal à entendre quelque chose. Essayez encore avec un fichier d'au
    moins 10 Ko.
<li>La puce à été configurée et reconnue correctement, mais le son est
    muet et doit être ré-activé pour que vous puissez entendre quelque
    chose, regardez ci-dessous.
<li>La puce à été reconnue mais n'a pas été configurée correctement.
    Peut être avez vous une vielle carte ISA qui doit être configurée
    avec une adresse I/O et une valeur IRQ différente pour éviter les
    conflits avec d'autres matériels. Vous pouvez simplement essayer
    différentes combinaisons en utilisant le <a
    href="faq5.html#BootConfig">User Kernel Configuration (UKC)</a>.
<li>Votre carte/puce n'est pas totalement supportée.
</ul>

<p>
<b>Remarque :</b>
Toutes les variations ou utilisations de toutes les puces n'ont pas été
testées ou débuggées.

<p>
Pour configurer vos périphériques audio, comme la vitesse de lecture,
vous pouvez utiliser
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>.
Pour configurer le volume sonore et les autres paramètres de mixage,
vous pouvez utiliser
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mixerctl&amp;sektion=1">mixerctl(1)</a>.
Ces deux utilitaires sont fournis avec le système de base.

<p>
Par exemple, pour configurer le volume sonore des canaux gauche et
droite à 200, vous pourriez lancer la commande (voir note 2 plus bàs) :

<blockquote><pre>
$ <strong>mixerctl outputs.master=200,200</strong>
outputs.master: 255,255 -&gt; 207,207
</pre></blockquote>

Remarquez que la valeur est devenue 207.
La raison à cela est que le périphérique de ma carte audio est un codec
AC'97, qui utilise seulement 5 bits pour le contrôle, ce qui ne laisse
que 32 valeurs possibles. Evidemment, les autres matériels peuvent
avoir une résolution différente.

<p>
Pour activer le canal "master", vous devriez faire

<blockquote><pre>
$ <strong>mixerctl outputs.master.mute=off</strong>
outputs.master.mute: on -&gt; off
</pre></blockquote>

<p>
Pour que vos changements soient permanents vous devrez éditer 
<i>/etc/mixerctl.conf</i>, par exemple :

<blockquote><pre>
$ <strong>cat /etc/mixerctl.conf</strong>
outputs.master=200,200
outputs.master.mute=off
outputs.headphones=160,160
outputs.headphones.mute=off
</pre></blockquote>

<b>Note 1 :</b>
Vous pourriez voir que plus de sorties sont disponibles sur votre carte
son ou votre carte mère. Ceci est du au fait que beaucoup de puces audio
sont généralement utilisées pour connecter les jacks sur les sorties,
et toute option de chaque puce audio n'est pas forcément accessible
depuis le monde extérieur.

</p>
<b>Note 2 :</b>
Sur votre système, il se peut que les sorties des périphériques soient
désignées autrement. Ainsi, vous pourriez ne pas avoir "outputs.master"
comme dans l'exemple précédent et devriez ajuster "outputs.output" ou
encore autre chose. Cela dépend du pilote audio mais il est facile de
trouver la dénomination correcte en listant tous les contrôles possibles
avec :

<blockquote><pre>
$ <b>mixerctl -a</b>
</pre></blockquote>

<a name="playaudio"></a>
<h2>13.2 - Jouer différents types de formats audio</h2>

<h3>Audio digitalisée</h3>

<h4>Formats audio sans perte (AU, PCM, WAV, FLAC, TTA)</h4>

Certains formats audio sans perte peuvent être joués sans qu'un logiciel
tierce partie ne soit nécessaire, ils contiennent les enregistrements
digitaux non compressés en flots d'octets.
Ces formats incluent les fichiers Sun audio (AU), les fichiers raw PCM
(sans en-tetes), et les RIFF WAV.

<p>
Pour jouer un tel fichier, vous devrez connaître ses paramètres
principaux : le type d'encodage, le nombre de canaux, la fréquence, et
le nombre de bit par morceau.
Si vous ignorez ces paramètres, vous pourrez les retrouver en utilisant
l'utilitaire :
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=file&amp;sektion=1">file(1)</a>.

<blockquote><pre>
$ <strong>file music.au</strong>
music.au:  Sun/NeXT audio data: 16-bit linear PCM, stereo, 44100 Hz
</pre></blockquote>

<blockquote><pre>
$ <strong>file music.wav</strong>
music.wav: Microsoft RIFF, WAVE audio data, 16 bit, stereo 44100 Hz
</pre></blockquote>

La seule chose qu'il vous reste à savoir sur ces fichiers d'exemple est
qu'ils sont encodés dans le format d'octet "little-endian" utilisant la
quantisation linéaire signée.
Vous pouvez vérifier cela en lisant son en-tête avec
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=hexdump&amp;sektion=1">hexdump(1)</a>.
Si vous utilisez un fichier sans en-tête (raw), il n'y a aucun moyen de
connaître les paramètres à l'avance.
Configurez les paramètres suivants en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>.

<blockquote><pre>
play.encoding=slinear_le
play.rate=44100
play.channels=2
play.precision=16
</pre></blockquote>

Ensuite, envoyez le fichier audio au périphérique son :

<blockquote><pre>
$ <strong>cat music.au &gt; /dev/sound</strong>
</pre></blockquote>

Si vous avez appliqués les bons paramètres, vous devriez entendre ce que
vous souhaitiez entendre.

<p>
Remarque : Utilisez toujours <tt>/dev/sound</tt>, et non
<tt>/dev/audio</tt>, si vous souhaitez que les paramètres appliqués
restent en place.

<p>
Il y à d'autres utilitaires que vous pouvez utiliser, comme
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=aucat&amp;sektion=1">aucat(1)</a>,
et <tt>audio/waveplay</tt> dans les packages et les ports. Bien sur, des
logiciels populaires comme XMMS sont aussi capables de jouers ces
fichiers aussi bien que d'autres formats;

<p>
A l'inverse de ce qui à été dit précédemment, il existe des format audio
sans perte de qualité.
Free Lossless Audio Codec (FLAC) et TTA en sont des exemples.
L'implémentation FLAC à été portée sous OpenBSD et peut être trouvée
dans <tt>audio/flac</tt> dans les packages et les ports.

<h4>Formats audio utilisant la compression par perte (Ogg Vorbis, MP3,
WMA, AAC)</h4>

La compression par perte de qualité est souvent utilisée pour l'audio ou
les autres fichiers multimédia. L'idée est qu'un certain volume de
données est supprimé pendant la compression, en utilisant une méthode
qui fait que le résultat compressé est toujours très exploitable et
dispose d'une bonne qualité pour être joué.
L'avantage de ces techniques est qu'ils autorisent de plus gros ratios
de compression, ce qui resulte en une plus faible place disque utilisée
et de plus besoins en bande passante.

<p>
Un bon exemple est le format libre, ouvert et non déposé
<a href="http://www.vorbis.com/">Ogg Vorbis</a>.
Pour jouer des fichiers Ogg Vorbis, vous pouvez utiliser l'utilitaire
ogg123, qui est inclus dans le le package <tt>audio/vorbis-tools</tt>.
Par exemple :

<blockquote><pre>
$ <strong>ogg123 music.ogg</strong>

Audio Device:   Sun audio driver output

Playing: music.ogg
Ogg Vorbis stream: 2 channel, 44100 Hz
Time: 00:02.95 [02:21.45] of 02:24.40  (133.1 kbps)  Output Buffer  87.5%
</pre></blockquote>

Bien sur, les plugins Ogg Vorbis existent pour beaucoups d'autres
logiciels audio.

<p>
Un autre exemple est le très populaire encodage MPEG-1 Audio Layer 3
(MP3), qui a, cependant, ses problèmes de redistribution et brevets.
Beaucoups de programmes peuvent jouer des fichiers MP3, consultez la
section <tt>audio</tt> du systèmes de packages et de ports et choisissez
celui que vous souhaitez.

<p>
Que dire du format Windows Media Audio (WMA) ? Les fichiers de ce type
peuvent être lus en utilisant <tt>x11/mplayer</tt> qui se sert de
l'architecture <a href="http://ffmpeg.sourceforge.net/">FFmpeg</a>.

</p><p>
Un bon point de départ pour en savoir plus sur les différents formats de
fichiers audio est de lire l'article Wikipedia suivant :
<a href="http://en.wikipedia.org/wiki/Audio_file_format">Audio file
formats (en anglais)</a>.

</p><h3>Son synthétisé</h3>

<h4>MIDI</h4>

Le protocole "Musical Intrument Digital Interface" (MIDI) fournit une
méthode standardisée et efficace pour représenter une performance
musicale sous forme de données électroniques. Un fichier MIDI peut être
très petit par rapport à un fichier audio traditionnel, car il ne
contient que les informations nécessaires au synthétiseur pour jouer les
sons.

<p>
Les deux technologies qui sont utilisées dans les synthétiseurs
musicaux sont :
<ul>
<li>Frequency Modulation (FM) Synthesis : une vielle méthode qui réalise
    une approximation de la courbe de chaque instrument en utilisant un
    certain nombre de paramètres; généralement de mauvaise qualité, peu
    couteux à implémenter, et donc utilisé sur beaucoups de cartes son.
<li>Wavetable Synthesis : une nouvelle méthode utilisant de petits
    enregistrements digitalisés de vrais instruments; meilleure qualité
    de son, requiert de la mémoire intégrée à la carte, on la trouve sur
    des cartes un peu plus chères.
</ul>

<p>
La plupart des informations concernant MIDI sur OpenBSD peuvent être
trouvées dans la page de manuel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=midi&amp;sektion=4">midi(4)</a>.

<p>
L'outil principal pour prendre en charge les fichiers MIDI standards est
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=midiplay&amp;sektion=1">midiplay(1)</a>.
Pour obtenir une liste des périphériques MIDI disponibles sur votre
système, essayez ceci :

<blockquote><pre>
$ <strong>midiplay -l</strong>
0: SB MIDI UART
1: SB Yamaha OPL3
2: PC speaker
</pre></blockquote>

Dans cet exemple, nous voyons une sortie UART sur laquelle un
périphérique externe peut être connecté, le synthétiseur intégré Yamaha
OPL3 FM et le classique vieux PC Speaker.

<p>
<b>Remarque :</b>
Toutes les cartes ne diposent pas de synthétiseur MIDI intégré, vous
pourriez ne voir qu'une sortie UART et un "PC speaker" listé.

<p>
Jouer un fichier MIDI standard, dans cet exemple à travers le
synthétiseur OPL3, est aussi simple que :

<blockquote><pre>
$ <strong>midiplay -d 1 file.mid</strong>
</pre></blockquote>

Remarquez que nous avons spécifié le périphérique MIDI de numéro 1, car
le périphérique 1 est utilisé par défaut.

<p>
Plus d'informations :
<a href="http://www.harmony-central.com/MIDI/Doc/tutorial.html">
Tutorial sur la synthétisation MIDI et de Musique</a>

<h4>MOD</h4>

Un module "Soundtracker" est un format binaire qui mixe les plages
audios avec des ordres de séquences, autorisant à jouer de très grands
morceaux de musique digitalisée avec un qualité raisonnablement bonne.

<p>
Le moyen le plus simple de jouer vos fichiers MOD favoris sur OpenBSD
est probablement d'utiliser le logiciel XMMS, disponible via les
packages et les ports.
Vous devriez installer le "subpackage" <tt>-mikmod</tt> pour XMMS afin
de lui permettre d'utiliser la librairie sonore MikMod, qui supporte les
modules de dormats MOD, S3M, IT et XM.

<p>
Vous trouverez aussi liste de "trackers" dans la section <tt>audio</tt>
de la collextion de ports et de packages, comme par exemple tracker,
soundtracker.
Avec ces trackers, vous ne pouvez pas seulement jouer mais aussi générer
vos propres modules.
Remarquez que tous les trackers ne sont pas supportés par les outils de
l'arbre des ports.
Vous êtes invités à <a href="../../fr/porting.html">envoyer un port</a>
de votre programme de tracker favori.

<a name="playCD"></a>
<h2>13.3 - Comment jouer des CDs dans OpenBSD ?</h2>

Pour jouer un CD audio, en utilisant la sortie analogique de votre
lecteur CD-ROM, vous pouvez
<ul>
<li>Utiliser la sortie casque audio, souvent présente sur la face avant
    de votre lecteur de cdrom.
<li>Connecter la sortie audio sur le connecteur noir de votre carte
    audio. Oui, il s'agit d'un cable supplémentaire près de celui des
    données (SCSI/IDE) et de celui de l'alimentation.
</ul>

<p>
Un utilitaire pratique en ligne de commande appelé
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cdio&amp;sektion=1">cdio(1)</a>,
à été inclut dans le système de base. Appelé sans paramètres, il entrera
en mode intéractif. Si vous souhaitez jouer un CD-ROM, entrez :

<blockquote><pre>
$ <strong>cdio play</strong>
</pre></blockquote>

<p>
Cela lira depuis le premier lecteur CD-ROM, <tt>cd0</tt>, par défaut.
Notez que l'utilisateur qui lance cdio doit bénéficier des permissions
de lecture sur le périphérique CD-ROM.
Etant donné que ce périphérique est dans le groupe "operator" par
défaut, ses permissions peuvent être ajustées comme suit :

<blockquote><pre>
# <strong>chmod o+r /dev/rcd0c</strong>
</pre></blockquote>

<p>
Si vous souhaitez une belle GUI, il y a beaucoup de lecteurs de CDs
basés sur X11 dans la collection de packages et de ports. Consultez
simplement la section <tt>audio</tt>.

<a name="recordaudio"></a>
<h2>13.4 - Puis-je utiliser OpenBSD pour enregistrer des séquences audio ?</h2>

Oui, pour le faire vous pouvez utiliser /dev/sound ou /dev/audio comme
périphérique d'entrée.
<p>
Premièrement, configurez les paramètres d'enregistrement corrects à l'aide de
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=audioctl&amp;sektion=1">audioctl(1)</a>,
exemple :

<blockquote><pre>
record.encoding=mulaw
record.rate=8000
record.channels=1
record.precision=8
</pre></blockquote>

J'utilise ici une quantisation non uniforme avec l'agorithme mu-law, un
seul canal, une fréquence de 8000 Hz et 8 bits par morceau.
Les algorithmes mu-law et A-law sont spécialement utiles lors de la
digitalisation de la voix, car il fournissent une meilleur efficacité au
codage.
Cela signifie que la qualité de l'enregistrement sera meilleure pour un
nombre de bit par morceau donné, ou que moins de bits seront reuquis
pour une qualité donnée.

<p>
Si vous décidez d'adopter les valeurs ci-dessus (seulement celles-ci !),
vous pouvez utiliser le périphérique /dev/audio qui les utilise par
défaut, donc vous n'avez pas besoin de les configurer explicitement ici.

<p>
Puis, soyez sur de sélectionner le bon matériel pour enregistrement et
que la source n'est pas muette.
Vous pouvez configurer les paramètres nécessaires en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mixerctl&amp;sektion=1">mixerctl(1)</a>.
Par exemple :

<blockquote><pre>
inputs.mic.mute=on
inputs.mic.preamp=on
inputs.mic.source=mic0
record.source=mic
record.volume=255,255
record.volume.mute=off
record.mic=0
record.mic.mute=off
</pre></blockquote>

Dans cet exemple j'enregistrerais à partir d'un microphone.
La pré-amplification a été activée, car sinon le son enregistré peut
être quelque peu silencieux.

<p>
Pour faire l'enregistrement utilisez simplement
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cat&amp;sektion=1">cat(1)</a>
ou
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1">dd(1)</a>:

<blockquote><pre>
$ <strong>dd if=/dev/audio of=myvoice.raw</strong>
</pre></blockquote>

Appuyez sur [CTRL]-C pour mettre fin à l'enregistrement.
La sortie est une séquence d'octets brute.
Ce son peut être joué, comme expliqué dans
<a href="#playaudio">Jouer différents formats audio</a>.
Pour un test rapide, en considérant que les paramètres audio
sont configurés correctement :

<blockquote><pre>$ <strong>dd if=myvoice.raw of=/dev/audio</strong>
</pre></blockquote>

<p>
Une fois de plus si vous spécifiez d'autres paramètres d'encodage, vous
devrez utiliser le périphérique /dev/sound.

Un autre exemple de paramètres d'encodage :

<blockquote><pre>
record.encoding=slinear_le
record.rate=22050
record.channels=2
record.precision=8
</pre></blockquote>

Le résultat sera un PCM avec une quantisation linéaire (uniforme)
signée, enregistré dans l'ordre little-endian à une fréquence de 22050
Hz, en stéréo, et en utilisant 8 bits pour représenter une morceau. (2^8
= 256 niveaux de quantisation).

<p>
<b>Note :</b>
Vous souhaiterez probablement convertir cet enregistrement brut (sans
en-tête) en un format utilisable pour pour un traitement ultérieur. 
Lisez <a href="#convert">FAQ 13 - Conversion</a> afin d'en savoir plus.

<a name="lossyaudio"></a>
<h2>13.5 - Parlez moi de l'encodage Ogg Vorbis et MP3 ?</h2>

Ces formats ont déja été mentionnés dans
<a href="#playaudio">Jouer différents formats audio</a>.
Dans cette section nous donnerons une brève introduction à l'encodage de
tels fichiers. Si vous êtes intéressé par le fonctionnement de ces
codecs de compression audio, de plus amples informations peuvent être
trouvées dans les articles Wikipedia concernant
<a href="http://en.wikipedia.org/wiki/Vorbis">Vorbis</a> et
<a href="http://en.wikipedia.org/wiki/MP3">MP3</a>.

<h3>Ogg Vorbis</h3>

L'encodage de formats audio raw, WAV ou AIFF en
<a href="http://www.vorbis.com/">Ogg Vorbis</a> peut être réalisé via
l'utilitaire <b>oggenc</b>, faisant partie du package
<tt>audio/vorbis-tools</tt>, qui est disponnible via le système de ports
et de packages d'OpenBSD.

<p>
Disons que vous avez un certain nombre de fichier WAV à encoder, par
exemple votre album favori que vous venez juste d'extraire de son CD.
Pour encoder tous ces fichiers en utilisant une fréquence d'environ 192
kbps, vous pouvez utiliser une commande comme celle ci :
<blockquote><pre>
$ <strong>oggenc *.wav -b 192</strong>
</pre></blockquote>

Une fois terminé, cela vous fournira un ensemble de fichiers .ogg dans
le dossier courant. Des exemples plus précis ainsi que les options
d'encodage peuvent être trouvés dans le manuel oggenc.

<h3>MPEG-1 Audio Layer 3 (MP3)</h3>

Si pour quelque raison que ce soit, vous souhaitez utiliser le format
MP3, vous pouvez utiliser
<a href="http://mp3dev.org/">"Lame ain't an MP3 encoder" (LAME)</a>,
un outil d'éducation utilisé pour apprendre l'encodage MP3. Lame est
inclu dans l'arbre des sources OpenBSD.
Notez que pour des raisons de brevets MP3, vous ne trouverez pas ce
package dans le
<a href="../../fr/orders.html">Set de CDs officiels</a>.

<p>
Ci-dessous ce trouve un exemple simple d'encodage d'un fichier WAV avec
une fréquence de 192 kbps :
<blockquote><pre>
$ <strong>lame -b 192 track01.wav track01.mp3</strong>
</pre></blockquote>

Pour toutes les options et les détails, merci de consulter le manuel
fournit avec lame.


<a name="playDVD"></a>
<h2>13.6 - Comment lire des vidéos DVDs sous OpenBSD ?</h2>

Pour l'instant, OpenBSD supporte les médias DVD à travers le système de
fichiers ISO 9660 qui est aussi utilisé pour les CD-ROMs.
Le nouveau système de fichiers
<a href="http://www.osta.org/specs/">Universal Disk Format (UDF)</a>
présent sur quelques DVDs n'est pas supporté.
Cependant, presque tous les disques DVD-Video et DVD-ROM utilisent le
format passerelle UDF, qui est une combinaison des systèmes de fichiers
DVD MicroUDF (sous-ensemble de UDF 1.02) et ISO 9660.
Ce format passerelle fournit une compatibilité ascendante pour les
systèmes d'exploitation ne supportant pas UDF.

<p>
Puisque la plupart des ordinateurs disposant d'un lecteur DVD-ROM
utilisent un décodage logiciel, il est recommandé d'avoir au moins un
processeur Pentium II 350-MHz ou équivalent pour disposer d'une bonne
qualité d'écoute.

<p>
Quelques utilitaires de lecture DVD populaires ont été portés sur OpenBSD.
Comme par exemple <a href="http://www.dtek.chalmers.se/groups/dvd/">ogle</a>
et <a href="http://www.mplayerhq.hu/">mplayer</a>.
Veuillez lire les instructions d'installation livrées avec le package,
car ces fichiers peuvent nécessiter plus de configuration.
Avec ces utilitaires il est possible de lire des DVD directement en
accédant au périphérique raw.
Bien sur, il est possible de monter d'abord le DVD en utilisant
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_cd9660&amp;sektion=8">mount_cd9660(8)</a>,
et de jouer les fichiers sur ce système de fichiers ou un autre.

<p>
<b>Remarque :</b>
</p><ul>
<li>Quasiment tous les DVDs que vous achetez sont encryptés en utilisant
    le "Content Scrambling System (CSS)". Pour pouvoir jouer ces DVDs
    encryptés, vous pouvez utiliser la librairie <a
    href="http://www.videolan.org/libdvdcss/">libdvdcss</a>, disponible
    au travers des packages et des ports.
<li>Soyez averti qu'un code région doit être présent sur votre disque
    DVD. Cela ne devrait pas réellement être un problème lorsque les
    DVDs sont joués sur un ordinateur.
</ul>


<a name="burnCD"></a>
<h2>13.7 - Comment graver des CDs et DVDs ?</h2>

<a name="burnIntro"></a>
<h3>13.7.1 - Introduction et configuration de base</h3>

Vous devriez tout d'abord être sur que votre graveur CD/DVD a bien été
reconnu et configuré par le noyau.
La plupart des périphériques SCSI sont reconnus. Les matériels IDE/ATAPI
et USB sont supportés au travers de l'émulation SCSI. Vous trouverez
rapidement votre périphérique dans la sortie d'un
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=1">dmesg(1)</a>.
Cherchez simplement les lignes commencant par "cd", par exemple :

<blockquote><pre>
cd0 at scsibus0 targ 0 lun 0: &lt;TOSHIBA, CD-ROM XM-5702B, 2826&gt; SCSI0 5/cdrom removable
cd1 at scsibus1 targ 4 lun 0: &lt;PLEXTOR, CD-R PX-R412C, 1.04&gt; SCSI2 5/cdrom removable
</pre></blockquote>

<h4>Mais <tt>cdrecord -scanbus</tt> ne fonctionne pas!</h4>

Oui. OpenBSD utilise un espace de nomage de périphérique différent de
celui du système d'exploitation pour lequel cdrecord a été écrit.
Tous les périphériques doivent être dans la sortie dmesg, comme
mentionné ci-dessus. L'information dont vous avez besoin se trouve ici.

<h4>Error: <tt>mount_cd9660: /dev/cd2c on /mnt/cdrom: No such file or directory</tt></h4>

Par défaut, l'installeur OpenBSD ne crée que deux périphériques cd
<tt>cd0</tt> et <tt>cd1</tt>.
Pour commencer à utiliser votre périphérique <tt>cd2</tt>, vous devez
créer le périphérique nécessaire pour celui-ci.
La méthode recommandée pour cela est d'utiliser le script
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=MAKEDEV&amp;sektion=8">MAKEDEV(8)</a>
(Sélectionnez votre plateforme) :

<blockquote><pre>
# <strong>cd /dev</strong>
# <strong>./MAKEDEV cd2</strong>
</pre></blockquote>

Dans ce qui suit, nous accèderons principalement au graveur de CD/DVD à
travers le périphérique <i>raw</i> et <b>non</b> le périphérique
<i>block</i>.

<h4>Vérifier le fonctionnement du graveur de CD/DVD</h4>

Il est recommandé de vérifier que votre graveur cd CD/DVD fonctionne
correctement. Dans cet exemple, j'utilise un graveur DVD USB 2.0 :

<blockquote><pre>
cd2 at scsibus2 targ 1 lun 0: &lt;LITE-ON, DVDRW LDW-851S, GS0C&gt; SCSI0 5/cdrom removable
</pre></blockquote>

Essayez de l'utiliser en y montant un CD/DVD.
Si vous le souhaitez, vous pouvez aussi vérifier les taux de transfert
que vous obtenez en copiant des fichiers sur votre disque dur.
La commande
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=time&amp;sektion=1">time(1)</a>
sera votre meilleure amie.

<p>
Si quelque chose se passe mal ici et que vous obtenez des erreurs durant
cette phase, il est important de les corriger avant de commencer à
écrire un CD/DVD.

<h3>Je souhaite maintenant graver un CD ! Pouvons nous commencer ?</h3>

Auparavant, il est judicieux de garder quelques conseils en tête :

<ul>
<li>Ne lancez pas de tâches utilisant lourdement le disque pendant que
    vous écrivez un CD/DVD. Cela réduira la vitesse d'écriture vers
    votre graveur CD/DVD. Si la vitesse descend plus bas que ce que le
    graveur attend pendant un temps trop long, son buffer sera vide. Ce
    phénomène est aussi connu sous le nom de "buffer underrun".
<li>Evitez les chocs pendant la gravure, cela pourrait faire glisser le
    laser de sa piste, et pourra conduire à des erreurs sur le disque.
<li>Tous les graveurs de DVD ne supportent pas tous les formats DVD,
    voyez ci-dessous.
</ul>

<a name="writeCD"></a>
<h3>13.7.2 - Graver des CDs</h3>

<h4>Créer des CD-ROMs de données</h4>

Tout d'abord, vous devrez créer un système de fichier ISO 9660 à mettre
sur un CD-ROM.
Pour cela vous pouvez utiliser l'utilitaire
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mkhybrid&amp;sektion=1">mkhybrid(1)</a>
fournit dans le système de base.

<p>
Comme exemple d'utilisation, j'ai essayé de sauvegarder les sources
d'OpenBSD dans une image ISO 9660 :

<blockquote><pre>
$ <strong>mkhybrid -R -o sys.iso /usr/src/sys</strong>

Using ALTQ_RMC.000;1 for  /usr/src/sys/altq/altq_rmclass_debug.h (altq_rmclass.h)
...
Using XFS_DEV-.000;1 for  /usr/src/sys/xfs/xfs_dev-common.c (xfs_dev-bsd.c)
 12.06% done, estimate finish Sun Mar 27 21:18:47 2005
 24.09% done, estimate finish Sun Mar 27 21:18:43 2005
...
 84.32% done, estimate finish Sun Mar 27 21:18:38 2005
 96.37% done, estimate finish Sun Mar 27 21:18:38 2005
Total translation table size: 0
Total rockridge attributes bytes: 0
Total directory bytes: 1822720
Path table size(bytes): 10674
Max brk space used 469000
41508 extents written (81 Mb)
</pre></blockquote>

<p>
L'option <tt>-R</tt> demande à <tt>mkhybrid</tt> de rajouter des
extensions Rock Ridge dans l'image ISO 9660.
Le "Rock Ridge Interchange Protocol" a été crée pour supporter le
système de fichiers POSIX à l'intérieur du système de fichiers ISO 9660,
comme les longs nom de fichiers, les créateurs de fichiers, les
permissions, les liens de fichiers, les fichiers de périphériques, les
hiérarchies de fichiers profondes (plus de 8 niveaux de sous-dossiers),
etc.

<p>
Si vous souhaitez que les longs noms de fichiers sur votre CD-ROM soient
lisibles sur les systèmes Windows et DOS, vous devriez ajouter le
paramètre <tt>-J</tt> pour inclure les extensions Joliet dans l'image
ISO 9660.

<p>
Après avoir crée les systèmes de fichiers, vous pouvez le vérifier en
<a href="http://www.openbsd.org/faq/faq14.html#MountImage">montant
l'image ISO 9660</a>.
Si tout se passe bien, vous êtes maintenant prêt à écrire le CD-R(W). Un
package souvent utilisé pour cela est le programme <b>cdrecord</b>,
inclus dans le package cdrtools, disponible dans le système de port et
de packages OpenBSD.

<p>
Si vous utilisez un média non réinscriptible, comme un CD-R, il est
souvent judicieux de faire un essai avant de graver effectivement le CD-
ROM, dans le but de ne pas gaspiller de disques.

<blockquote><pre>
# <strong>cdrecord -v -dummy dev=/dev/rcd1c sys.iso</strong>
</pre></blockquote>

Si tout se passe bien, vous êtes prêt à graver l'image créée dans
l'exemple précédant sur un CD-R(W) vierge. Vous pourrez utiliser une
commande similaire à :

<blockquote><pre>
# <strong>cdrecord -v dev=/dev/rcd1c sys.iso</strong>
</pre></blockquote>

En utilisant les options spécifiées ci-dessus, nous demandons à cdrecord
de fournir une sortie verbeuse et d'utiliser le second périphérique CD-
ROM comme graveur de CD.
Notez que nous passons le périphérique <i>raw</i> à cdrecord.

<p>
Pour vérifier que le CD-ROM a bien été écrit, vous pouvez le monter et
vérifier que tout ce qui doit y être y est. Pour monter le système de
fichier, vous devez utiliser le périphérique <i>block</i> pour le
lecteur de CD-ROM, qui dans ce cas est toujours le graveur de CD :

<blockquote><pre>
# <strong>mount /dev/cd1c /mnt/cdrom</strong>
</pre></blockquote>


<h4>Créer des CDs audio</h4>

Pour graver des CDs audio, vous pouvez utiliser <b>cdrecord</b> avec le
paramètre <tt>-audio</tt>, ou bien utilisant l'utilitaire <a
href="http://cdrdao.sourceforge.net/">cdrdao</a> pour écrire dans le
mode Disc-At-Once et éviter les trous entre les différentes pistes
audio. Chacun de ces utilitaires sont disponibles au travers du système
de ports et de packages OpenBSD.

<p>
Comme exemple, je ferais une copie de sauvegarde d'un de mes CDs de
musique.
Cela implique deux étapes :

<ol>
<li>Copier les pistes audio depuis votre CD original: vous pouvez faire
    cela a l'aide de logiciels comme <b>cdparanoia</b>, <b>cdda2wav</b>
    (inclus dans le package <tt>sysutils/cdrtools</tt>), et
    <b>cdrdao</b>.
    Par exemple :
    <blockquote><pre>
    # <strong>cdrdao read-cd --device /dev/rcd0c cdtracks.toc</strong>
    </pre></blockquote>
    Cette commande va extraire uen série de fichiers WAV depuis votre
    premier lecteur cd CD-ROM vers votre disque dur, et compiler un
    fichier de "Table of Contents (TOC)" (Table de matières).
<li>Ecrire les pistes audio sur un cd vierge comme mentionné ci-dessus
    en utilisant <b>cdrecord</b> ou <b>cdrdao</b>, exemple :
    <blockquote><pre>
    # <strong>cdrdao write --device /dev/rcd1c cdtracks.toc</strong>
    </pre></blockquote>
    Si vous le souhaitez, vous pouvez essayer la commande <tt>cdrdao
    simulate</tt> au préalable.
</ol>


<a name="writeDVD"></a>
<h3>13.7.3 - Graver de DVDs</h3>

Il y a quelques détails importants à propos des DVD que vous devriez
savoir avant de créer vos propres DVDs.

<p>
<b>Remarques importantes :</b>
</p><ul>
<li>Si vous souhaitez vraiment tout savoir sur les DVD, je vous suggère
    de lire la très complète
    <a href="http://www.dvddemystified.com/dvdfaq.html">FAQ DVD</a>.

<li>Cette section a été très peu testée et nous n'avons probablement pas
    testé toutes les combinaisons de médias et de graveurs possibles.
    Par exemple, les DVD-RAM restent non testés. Vous êtes invités à
    <a href="mailto:faq@openbsd.org">nous informer</a> de vos succès ou
    echecs.
</ul>

<h4>Differents formats de DVDs</h4>

Il y a plusieurs formats différents pour les DVD. Les plus utilisés sont
les formats DVD-R, DVD-RW, DVD+R et DVD-RW (R signifie enregistrable une
seule fois, RW signifie qu'il peut être réecrit quelques milliers de
fois). Il existe d'autres standards plus compétitifs.

<p>
Un format différent est le DVD-RAM, qui a principalement été développé
comme un lecteur de données et dispose de fonctions d'écriture de
paquets avancées, autorisant à l'utiliser comme une sorte de disque dur
optique. DVD-RAM n'est pas recommandé pour une utilisation video car les
vidéos sont écrites sur le disque dans un format non compatible avec les
lecteurs de DVD normaux.

<p>
Le point le plus important est d'utiliser le média adapté à votre
graveur de DVD.
Si vous souhaitez la compatibilité avec d'autres lecteurs de DVD,
veuillez lire
<a href="http://www.dvddemystified.com/dvdfaq.html#4.3.1">cette section</a>
de la FAQ DVD.

<h4>Vitesse de gravure DVD</h4>

Il est important de spécifier que les indications de vitesses des DVDs
diffèrent de celles des CD-ROMs. La table suivante en donne un apercu :

<p>
<table border="1">
<tbody><tr align="center">
<td>Vitesse de Lecture/Ecriture DVD</td>
<td>Taux de transfert (Mo/s)</td>
<td>Vitesse de Lecture/Ecriture CD-R(W)</td>
</tr>
<tr align="center">
<td>1x</td>
<td>1.32</td>
<td>9x</td>
</tr>
<tr align="center">
<td>2x</td>
<td>2.64</td>
<td>18x</td>
</tr>
<tr align="center">
<td>4x</td>
<td>5.28</td>
<td>36x</td>
</tr>
<tr align="center">
<td>8x</td>
<td>10.57</td>
<td>72x</td>
</tr>
</tbody></table>

<p>
Comme on peut le voir dans le tableau, les taux de transfert sont
relativement hauts, et vous devrez vérifier que votre bus (SCSI,
(E)IDE/ATAPI, USB) est assez performant pour les supporter.
Spécifiquement, les vielles interfaces USB 1.0 et 1.1 travaillent à des
taux plus bas, avec des vitesses de transfert de 1.5 Mbit/s et 12
Mbit/s, respectivement.
Cela signifie que l'USB 1.0 a une vitesse maximum de 178.8 kByte/s et
USB 1.1 de 1.43 MB/s.
USB 2.0 est plus rapide : 480 Mbit/s ou 57.2 MB/s.
En général, les vitesses des bus SCSI et (E)IDE/ATAPI sont correctes.

<h4>Graver les DVD</h4>

Basiquement, le processus est très similaire à celui d'écrire des CD-
R(W)s.
Le logiciel, cependant, diffère.
A ce moment, la meilleure option est <b>growisofs</b> depuis le package
<tt>sysutils/dvd+rw-tools</tt>.
Cet utilitaire écrit une image ISO 9660 sur le média DVD. Tous les
formats DVD sont supportés par dvd+rw-tools.

<p>
Dans le cas où vous voudriez plus d'informations sur le média présent
dans votre graveur de DVD (par exemple si vous avez perdu le texte
d'information dans la boite du cd ou êtes simplement désorganisé comme
moi), vous pouvez utiliser l'utilitaire <b>dvd+rw-mediainfo</b>.

<!--blockquote><pre>
$ <strong>dvd+rw-mediainfo /dev/rcd2c</strong>
INQUIRY:                [LITE-ON ][DVDRW LDW-851S  ][GS0C]
GET [CURRENT] CONFIGURATION:
 Mounted Media:         1Ah, DVD+RW
 Current Write Speed:   4.0x1385=5540KB/s
 Write Speed #0:        4.0x1385=5540KB/s
 Write Speed #1:        2.4x1385=3324KB/s
GET [CURRENT] PERFORMANCE:
 Write Performance:     4.0x1385=5540KB/s@[0 -> 0]
 Speed Descriptor#0:    00/0 R@2.4x1385=3324KB/s W@4.0x1385=5540KB/s
 Speed Descriptor#1:    00/0 R@2.4x1385=3324KB/s W@2.4x1385=3324KB/s
READ DVD STRUCTURE[#0h]:
 Media Book Type:       92h, DVD+RW book [revision 2]
 Media ID:              SONY/S11
 Legacy lead-out at:    2295104*2KB=4700372992
READ DISC INFORMATION:
 Disc status:           blank
 Number of Sessions:    1
 State of Last Session: empty
 Number of Tracks:      1
READ TRACK INFORMATION[#1]:
 Track State:           blank
 Track Start Address:   0*2KB
 Free Blocks:           2295104*2KB
 Track Size:            2295104*2KB
READ CAPACITY:          1*2048=2048
</pre></blockquote-->

Il y a deux options pour écrire le DVD:
<ul>
<li>Pre-masteuriser une image ISO 9660 depuis vos données, stockant
    l'image sur votre disque dur; puis l'écrire sur le DVD.
<li>Ecrire une image ISO 9660 de vos données directement sur le DVD.
</ul>

<p>
J'ai crée une image ISO 9660 pré-masteurisée depuis les modules CVS
d'OpenBSD (src, XF4, ports and www) présents dans le dossier /cvs de mon
disque.
J'ai utilisé la commande suivante, qui ressemble beaucoups à celle que
j'ai utilisé pour créer l'image CD-ROM précédante.

<blockquote><pre>
$ <strong>mkhybrid -R -o cvs.iso /cvs</strong>
</pre></blockquote>

Si vous le souhaitez, testez le système de fichiers ISO 9660 en
<a href="faq14.html#MountImage">montant l'image</a>.
Pour écrire cette image (environ 2Go) sur un disque DVD, on peut
utiliser :

<blockquote><pre>
# <strong>growisofs -dvd-compat -Z /dev/rcd2c=cvs.iso</strong>
Executing 'builtin_dd if=cvs.iso of=/dev/rcd2c obs=32k seek=0'
/dev/rcd2c: pre-formatting blank DVD+RW...
/dev/rcd2c: "Current Write Speed" is 4.1x1385KBps.
23822336/1545832448 ( 1.5%) @3.9x, remaining 5:19
42172416/1545832448 ( 2.7%) @3.9x, remaining 5:20
60522496/1545832448 ( 3.9%) @3.9x, remaining 4:54
...
1504706560/1545832448 (97.3%) @3.9x, remaining 0:07
1523318784/1545832448 (98.5%) @3.9x, remaining 0:04
1541898240/1545832448 (99.7%) @3.9x, remaining 0:00
/dev/rcd2c: flushing cache
/dev/rcd2c: writing lead-out
/dev/rcd2c: reloading tray
</pre></blockquote>

L'option <tt>-Z</tt> demande a growisofs de graver une session initiale
sur le périphérique, qui dans ce cas est mon graveur de DVD, attaché à
cd2.
L'option <tt>-dvd-compat</tt> finalise le disque, ce qui signifie
qu'aucune nouvelle session ne peut y être rajoutée.
Cela devrait fournir une meilleure compatibilité avec les lecteurs DVD
et quelques vielles unités DVD-ROM.

<p>Remarquez comment growisofs indique la vitesse d'écriture, dans notre
cas 3.9x, ce qui est ce que l'on peut attendre en combinant les vitesses
du média et du graveur, comme indiqué par le dvd+rw-mediainfo.

<p>
Si vous ne disposez pas de suffisament de place pour stocker une image
de ISO 9660 four un DVD, vous pouvez écritre vos données directement sur
le DVD. Essayons simplement une simulation de création du système de
fichiers.

<blockquote><pre>
# <strong>growisofs -dry-run -Z /dev/rcd2c -R /cvs</strong>
</pre></blockquote>

Si cela fonctionne, retirez simplement l'option -dry-run et commencez
l'ecriture du DVD.

<blockquote><pre>
# <strong>growisofs -Z /dev/rcd2c -R /cvs</strong>
</pre></blockquote>

Notez que, dans le cas d'une écriture directe sur le DVD, growisofs
appellera mkisofs, depuis le package cdrtools duquel dvd+rw-tools
dépend, et non mkhybrid présent dans le système de base.

<p>
Il est aussi possible d'ajouter des données à un DVD existant, en
utilisant l'option -M, qui fond une nouvelle session dans une session
existante :

<blockquote><pre>
# <strong>growisofs -M /dev/rcd2c -R /mydata</strong>
</pre></blockquote>

Pour plus d'informations à propos de growisofs, consultez sa page de
manuel.

<p>
Lorsque vous avez terminé d'écrire le DVD, montez le et vérifiez que
tout ce que vous souhaitiez présent y soit effectivement.

<h4>Pourquoi je n'obtiens pas la vitesse que je veux ?</h4>

Au lieu de la vitesse d'écriture précédente, vous pourriez voir quelque
chose comme ceci :

<blockquote><pre>
  4784128/1545832448 ( 0.3%) @0.7x, remaining 26:50
  7929856/1545832448 ( 0.5%) @0.7x, remaining 29:05
  14123008/1545832448 ( 0.9%) @0.7x, remaining 27:06
  ...
</pre></blockquote>

ce qui est bien plus lent.
Cela signifie qu'il ne transite pas assez d'informations sur l'un des
bus que votre DVD utilise.

Dans l'exemple précédent, le graveur de DVD USB fut installé sur une machine
sur laquelle le driver
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ehci&amp;sektion=4">ehci(4)</a>,
utilisé par les controlleurs USB 2.0, ne s'est pas initialisé correctement.
Comme d'habitude, vous êtes invités à envoyer des patchs et résultats de
vos tests.

Le graveur de DVD fut ralenti par l'interface USB 1.1 plus lente, ce qui
a reduit la vitesse de gravure.
L'USB 1.1 est limité à 12 Mbit/s, ce qui correspond à 1.43 MB/s ou 1.08x
en terme de vitesse DVD.

Le graveur de DVD est descendu à une plus basse vitesse de gravure pour
diminer le risque de buffer overrun (defaut de données à écrire).


<a name="convert"></a>
<h2>13.8 - Je voudrais mes fichiers multimédia au format FOO.</h2>

<h3>Conversion entre différents formats audios</h3>

Admettons que vous souhaitiez convertir le son enregistré avec
<a href="#recordaudio">FAQ 13 - Enregistrer des séquences audio</a>.
Cet enregistrement a été enregistré en format brut. Il serait utile de
le convertir car le format brut ("raw") ne contient pas d'en-tête et les
paramètres devront être spécifiés à chaque utilisation du fichier.

<p>
Un bon outil de conversion de format est <tt>audio/sox</tt>, disponible 
au travers des ports et des packages.
<b>sox</b> supporte les formats AIFF, AU, MP3, Ogg Vorbis, RIFF WAV et
raw, ainsi que certains autres plus exotiques. Ci-dessous vous trouverez
un exemple de conversion de l'enregistrement vers le format RIFF WAV.

<blockquote><pre>
$ <strong>sox -U -c 1 -r 8000 -b myvoice.raw myvoice.wav</strong>
</pre></blockquote>

Notez que les paramètres spécifiés correspondent aux paramètres
d'enregistrement spécifiés avant l'enregistrement.
Cela n'est qu'un exemple. De nombreux autres programmes et bibliothèques
peuvent être utilisés en conversion audio.

<p>
<b>Note :</b>
Il n'est pas recommandé de convertir entre différents formats de
compression dits destructeurs ("lossy"). Par exemple, les codecs MP3 et
Vorbis suppriment certaines informations du fichier audio original.
Ainsi, lorsque vous convertissez un fichier MP3 en Ogg Vorbis, le
résultat final sonnera certainement moins bon que l'original.

<h3>Conversion entre différents formats vidéos</h3>

Il est important de faire une distinction entre
<ul>
<li>le format du containeur - par exemple, MP4, OGG, MPEG, MOV, AVI,
ASF.
<li>le codec vidéo - par exemple, MPEG-1, MPEG-2, codecs compatibles
MPEG-4 (comme Xvid et DivX), FFmpeg, WMV, ... - lisez
<a href="http://en.wikipedia.org/wiki/Video_codec">l'article Wikipedia
sur les codecs vidéos</a> pour en savoir plus.
</ul>

Pour le moment, le support des containeurs MPEG et AVI est le plus
abouti. Aucun utilitaire présent dans l'arbre des ports n'est encore
capable de créer des containeurs MP4.

<p>
Il existe deux utilitaires populaires, <tt>multimedia/transcode</tt> et
<b>mencoder</b> (qui fait partie de <tt>x11/mplayer</tt>). Ils utilisent
ou  peuvent utiliser la bibliothèque <b>libavcodec</b> disponible dans
le port <tt>graphics/ffmpeg</tt> et qui génère un format de sortie de
bonne qualité. Vous pouvez bien sûr utiliser <b>ffmpeg</b> directement.
Il devrait aussi être possible d'utiliser l'encodeur XviD présent dans
<tt>multimedia/xvidcore</tt>.

<p>
La documentation, qui vient avec ces paquetages sous la forme de pages
de manuel ou de documents HTML dans <tt>/usr/local/share/doc</tt>,
contient de nombreux exemples, c'est pourquoi il est HAUTEMENT
recommandé de lire ces documents.


<a name="streaming"></a>
<h2>13.9 - Est-il possible de lire des fichiers en streaming sous
OpenBSD ?</h2>

Oui, c'est possible. De nombreux streams audio et vidéos fonctionneront
sans soucis sur un nombre limité de plateformes. Certains, quant à eux,
ne fonctionneront pas.

<p>
Ce document ne représente pas une réponse exhaustive sur la manière de
faire fonctionner tous les formats de streaming possibles sur n'importe
qu'elle architecture. Tout d'abord, vous devriez vous renseigner sur
la technologie de streaming. Quoi qu'un peu daté, le
<a href="http://www.oreilly.com/catalog/sound/chapter/ch05.html">
chapitre à propos du streaming</a> tiré du livre "Designing Web Audio"
aux éditions O'Reilly représente un bon début.

<p>
La première chose à savoir est qu'il existe plusieurs protocoles de
streaming. Le <b>protocole</b> de streaming définit la façon dont les
flux seront envoyés à travers le réseau. Ils ont été développés afin de
garantir une transmission audio/vidéo efficace en temps réel par
internet. En bref, le protocole de streaming est un protocole applicatif
(niveau 7) capable d'utiliser les protocoles de transport UDP ou TCP
(niveau 4). Le protocole de transport UDP ("User Datagram Protocol")
convient parfaitement pour ce type d'application puisqu'il n'effectue
aucune retransmission de paquets ou autre type de charge réseau. Un
certain nombre de protocoles spécialisés mais propriétaires ont été
développés, par exemple Microsoft Media Services (MMS - services média
de Microsoft) et le Real Time Streaming Protocol (RTSP - protocole de
transmission de flux en temps réel). Comme nous le verrons, HTTP (qui
utilise TCP) est également parfois utilisé, même s'il ne permet pas de
transmettre des flux à une vitesse régulière comme UDP, RTSP et MMS.

<p>
Ensuite, il y a le <b>format</b> de streaming qui représente la façon
dont les données audio/vidéo ont été organisées et peuvent être lues.
Les formats de streaming les plus utilisés sont le MP3, Real Audio (RA,
RM) et le Windows Media (ASF) qui sont tous des technologies
propriétaires. Parfois, vous rencontrerez certains streams au format
Ogg Vorbis.

<p>
Pour l'exemple, j'expliquerai, en quelques étapes, comment j'arrive à
écouter <a href="http://www.radio1.be">Radio 1</a>, une des stations
radios nationales belges. Sous OpenBSD, les plugins (modules externes)
de navigateurs ne sont pas disponibles, ce qui signifie que la mise en
place se résume rarement en un "clic et lecture".

<ul>
<li>Déterminer le protocole de streaming et le format.<br>
Ceci est généralement indiqué sur le site web sur lequel vous accédez
au stream. Dans ce cas, je clic simplement sur le lien "Listen live"
(écoutez en direct) à partir du site principal qui me répond que mon
système d'exploitation n'est pas supporté. Ils sont suffisamment polis
pour me signifier que je peux également écouter leur stream MP3 sans
utiliser leur lecteur Flash qui nécessite un plugin. Ensuite une liste
de liens vers les stations radios nationales apparait, ce qui me permet
de passer à la suite. Notez que j'ai dû utiliser un navigateur
compatible JavaScript afin d'arriver ici.
<li>Déterminer l'URL précise.<br>
De nombreux sites internet lient vers un containeur (du type M3U, ASX,
RAM) qui contient la localisation effective du flux. Enregistrez
simplement ce fichier et récupérez l'URL à partir de celui-ci. Dans mon
exemple, il s'agit de :

<blockquote><pre>
$ <strong>ftp http://internetradio.vrt.be/dab/hoeluisteren/pc/help/gebruiksvoorwaarden/stream_11.m3U</strong>
$ <strong>cat stream_11.m3U</strong>
http://mp3.streampower.be/radio1-mid.mp3
http://mp3.streampower.be/radio1-low.mp3
http://mp3.streampower.be/radio1-high.mp3
</pre></blockquote>

Visiblement, je peux même choisir entre différentes qualités de flux
("low, medium et high"). D'autres sites peuvent contenir du code
JavaScript pour créer l'URL. Dans ce cas, le meilleur conseil serait :
parcourez le source HTML ainsi que les scripts auxquels il se réfère. Il
existe une bonne chance que vous soyez en mesure de reconstruire l'URL à
partir de ces données.

<li>Pour lire ces flux, votre meilleure chance est probablement
<tt>x11/mplayer</tt>, disponible en tant que paquetage et dans l'arbre
des ports. Il supporte la plupart des protocoles et formats de streaming
et fonctionne sur les plateformes amd64, i386, powerpc et sparc64. Mais
il existe des alternatives : <b>ogg123</b> dans
<tt>audio/vorbis-tools</tt> (pour les streams Ogg Vorbis),
<tt>audio/mpg123</tt> et <tt>audio/mpg321</tt> (pour les streams MP3),
XMMS dans <tt>audio/xmms</tt> et le client Videolan dans
<tt>x11/vlc</tt>. Continuons l'exemple :

<blockquote><pre>
$ <strong>mplayer http://mp3.streampower.be/radio1-mid.mp3</strong>
</pre></blockquote>

<li>Si vous le souhaitez, vous pouvez faciliter cela en ajoutant un
alias dans votre fichier <tt>.profile</tt> :

<blockquote><pre>
alias radio1='mplayer http://mp3.streampower.be/radio1-mid.mp3'
</pre></blockquote>

</ul>

<!--  
check out http://www.cbc.ca/listen/index.html
it has DivX streams over MMS as well as Ogg Vorbis streams over HTTP.
maybe a good example but also nearly an ideal case...
-->

Les flux Windows Media (ASF) fonctionneront la plupart du temps bien
qu'ils puissent contenir des données aux formats suppportés uniquement
grâce au port <tt>graphics/win32-codecs</tt> qui ne tourne que sous
i386 ('pkg_info win32-codecs' vous donnera la liste des codecs
supportés). Certains flux Real Audio peuvent fonctionner sous i386 en
utilisant <b>mplayer</b> en conjonction avec les ports
<tt>graphics/win32codecs</tt> et <tt>emulators/redhat/base</tt> (lisez
<a href="http://marc.theaimsgroup.com/?t=107060510300001&amp;r=1&amp;w=2">
ce fil</a> de la liste de discussion des ports).


<!--
this would be interesting, but lack of hardware at the moment

<a name="camera"></a>
<h2>13.xx - Can I use my digital camera under OpenBSD?</h2>

<a name="scanner"></a>
<h2>13.yy - How do I set up and use my scanner?</h2>
-->

<p>
<font color="#0000e0">
<a href=" index.html">[Index de la FAQ]</a>
<a href=" faq12.html">[Section 12 - Questions spécifiques aux plateformes]</a>
<a href=" faq14.html">[Section 14 - Configuration des disques]</a>
</font>

</p><p>
</p><hr>
<a href="index.html"><img src="../../images/back.gif" alt="[back]" border="0" height="24" width="24"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br>
<small>
<!--
Originally [OpenBSD: faq13.html,v 1.92 ]<br>
$Translation: faq13.html,v 1.13 2005/08/14 09:05:42 ajacoutot Exp $<br>
-->
$OpenBSD: faq13.html,v 1.7 2005/08/15 20:46:06 saad Exp $
</small>

</body></html>
