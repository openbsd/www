<!doctype html>
<html lang=en id=faq>

<title>Following -current and using snapshots</title>
<meta charset=utf-8>
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="../openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/faq/current.html">

<h2 id=OpenBSD>
<a href="../index.html">
<i>Open</i><b>BSD</b></a>
Following -current and using snapshots
<small>
<a href="index.html">[FAQ Index]</a>
</small>
</h2>
<hr>

<p>
Active OpenBSD development is known as the
<a href="faq5.html#Flavors">-current</a> branch.
These sources are frequently compiled into releases known as <i>snapshots</i>.

<p>
Aggressive changes are sometimes pushed in this branch, and complications can
arise when building the latest code or upgrading from a previous point in time.
Some of the steps for getting over these hurdles are explained on this page.
Make sure you've read and understand how to
<a href="faq5.html">build the system from source</a> before using -current
and the instructions below.

<p>
In general, it's far easier to use snapshots, as developers will have gone
through much of the trouble for you already.

<p>
You should <b>always</b> use a snapshot as the starting point for running
-current.
This process typically consists of running
<a href="https://man.openbsd.org/sysupgrade">sysupgrade(8)</a> with the
<code>-s</code> flag.
Alternatively, download (and verify) the appropriate
<a href="faq4.html#bsd.rd">bsd.rd</a> file from the <code>/snapshots/</code>
directory of your preferred <a href="../ftp.html">mirror</a>, boot from it,
and choose <code>(U)pgrade</code> at the prompt.
Any installed packages should then be
<a href="faq15.html#PkgUpdate">upgraded</a> after booting into the new system.

<p>
Upgrading to -current by compiling your own source code is discouraged
for everyone except for experts, as difficult build-time crossing-points
can occur often, and no assistance will be provided.  In case of failure,
use a snapshot to recover.

<p>
Most of these changes will have to be performed as root.


<h3 id="r20251122">2025/11/22 - [packages] PostgreSQL major update</h3>

<p>
There was a major update to PostgreSQL 18.1.
This defaults to using data checksums.
For ease of using pg_upgrade, if you have an existing database using 17.x,
it is recommended to enable data checksums <b>before</b> upgrading OpenBSD:

<pre class="cmdbox">
# <b>rcctl stop postgresql</b>
# <b>su _postgresql -c '/usr/local/bin/pg_checksums -e -D /var/postgresql/data'
# <b>rcctl start postgresql</b>
</pre>

After upgrading, use <tt>pg_upgrade</tt> as described in the
<a href="https://cvsweb.openbsd.org/cgi-bin/cvsweb/~checkout~/ports/databases/postgresql/pkg/README-server?rev=1.39&amp;content-type=text/plain">postgresql-server pkg-readme</a>
or do a dump/restore.


<h3 id="r20251117">2025/11/17 - OpenBSD/luna88k switches to PIE userland</h3>

The <a href="../luna88k.html">OpenBSD/luna88k</a> port has switched userland
to PIE (Position-Independent-Executables). Update using a snapshot is highly
recommended. To update from source, the following steps are needed:

<ol>
<li>
Install new Makefile machinery.

<pre class="cmdbox">
# <b>cd /usr/src/share/mk && make install</b>
</pre>

<li>
Build, but do not install, binutils.

<pre class="cmdbox">
# <b>cd /usr/src/gnu/usr.bin/binutils-2.17 && su build -c 'exec make -f Makefile.bsd-wrapper'</b>
</pre>

<li>
Build and install the new compiler.

<pre class="cmdbox">
# <b>cd /usr/src/gnu/usr.bin/cc && su build -c 'exec make' && make install</b>
</pre>

<li>
Install binutils.

<pre class="cmdbox">
# <b>cd /usr/src/gnu/usr.bin/binutils-2.17 && make -f Makefile.bsd-wrapper install</b>
</pre>

<li>
Build and install the C runtime objects.

<pre class="cmdbox">
# <b>cd /usr/src/lib/csu && su build -c 'exec make' && make install</b>
</pre>

<li>
Rebuild the system as usual.

<pre class="cmdbox">
# <b>cd /usr/src && make build</b>
</pre>

</ol>


<h3 id="r20251116">2025/11/16 - 52-partition ABI change</h3>

<b>struct disklabel</b> is changing in preparation for supporting
52 partitions rather than the 16 partition limit.  Building through
this is not trivial and requires the following conservative steps:

<ol>
<pre>
cp /usr/src/etc/rc /etc/rc               # to be safe
cp /usr/src/etc/etc.ARCH/MAKEDEV /dev

# place some sort of newish bsd.rd for recovery purposes

cd /usr/src && make includes
cd /usr/src/lib/libc && make && make install
cd /usr/src/lib/libutil && make && make install

cd /usr/src/sbin && make && make install

# With new disklabel command installed, verify that "disklabel sd0" fails
# with an error.  It should give an error, because it is issuing an ioctl
# for the large partition table

cp /bsd /bsd.save
cd /sys/arch/ARCH/compile/GENERIC && make && make install

cd /dev && sh MAKEDEV all
reboot
</pre>
</ol>

This hopefully works.


<h3 id="r20251023">2025/10/23 - OpenBSD/luna88k compiler switch</h3>

The <a href="../luna88k.html">OpenBSD/luna88k</a> port has switched compiler
from gcc 3.3.6 to gcc 4.2.1. Update using a snapshot is highly recommended. To
update from source, the following steps are needed:

<ol>
<li>
Install new Makefile machinery.

<pre class="cmdbox">
# <b>cd /usr/src/share/mk && make install</b>
</pre>

<li>
Build and install the new compiler.

<pre class="cmdbox">
# <b>cd /usr/src/gnu/usr.bin/cc && su build -c 'exec make' && make install</b>
</pre>

<li>
Build and install the preprocessor.

<pre class="cmdbox">
# <b>cd /usr/src/usr.bin/cpp && su build -c 'exec make' && make install</b>
</pre>

<li>
Rebuild the system as usual.

<pre class="cmdbox">
# <b>cd /usr/src && make build</b>
</pre>

</ol>


<h3 id="r20260112">2026/01/12 - LACP mode removed from trunk(4)</h3>

IEEE 802.3ad/802.1AX Link Aggregation Control Protocol support has
been removed from <a href="//man.openbsd.org/trunk.4">trunk(4)</a>.
trunk(4) LACP configuration can be moved to
<a href="//man.openbsd.org/aggr.4">aggr(4)</a>,
the dedicated IEEE 802.1AX Link Aggregation network interface driver.

<p>
aggr(4) is compatible with trunk(4) with two exceptions:

<ol>
<li>
aggr(4) uses a random MAC by default, trunk(4) uses the MAC of the
first-added child port.

<li>
aggr(4) needs to be configured up explicitly.
</ol>

<p>
An example of migrating configuration for trunk0 to aggr0:

<pre class="cmdbox">
# <b>cd /etc</b>
# <b>ifconfig trunk0 | awk '/lladdr/ { print "lladdr $2" } > hostname.aggr0</b>
# <b>cat hostname.trunk0 >> hostname.aggr0</b>
# <b>echo up >> hostname.aggr0</b>
# <b>rm hostname.trunk0</b>
</pre>




<!--
     Two blank lines before new sections.
     New sentences start on new lines.
     Try to make lines shorter than 80 characters.
-->

<hr id="end">
<small>$OpenBSD: current.html,v 1.1149 2026/01/23 11:50:17 sthen Exp $</small>
