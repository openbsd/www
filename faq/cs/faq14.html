<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<meta http-equiv="Content-type" content="text/html; charset=iso-8859-2">
<title>14.0 - Nastavení disku</title>
<link rev= "made" href= "mailto:www@openbsd.org">
<meta name= "resource-type" content= "document">
<meta name= "description"   content= "the OpenBSD FAQ page">
<meta name= "keywords"      content= "openbsd,faq">
<meta name= "distribution"  content= "global">
<meta name= "copyright"     content= "This document copyright 1998-2002 by OpenBSD.">
</head>

<body bgcolor= "#ffffff" text= "#000000"> 

<img alt="[OpenBSD]" height=30 width=141 src="../../images/smalltitle.gif">
<h2><font color=#e00000>14.0 - Nastavení disku</font><hr></h2>

<ul><h3>Obsah</h3>
<li><a href="#disklabel">14.1 - Pou¾ívání disklabel v OpenBSD</a></li>
<li><a href="#fdisk">14.2 - Pou¾ívání fdisku v OpenBSD</a></li>
<li><a href="#NewDisk">14.3 - Pøidávání dal¹ích diskù v OpenBSD</a></li>
<li><a href="#SwapFile">14.4 - Jak nastavit swapování do souboru</a></li>
<li><a href="#SoftUpdates">14.5 - Soft Updates</a></li>
<li><a href="#D0P3">14.6 - Kdy¾ nabootuji po instalaci OpenBSD/i386, zastaví se na 
"Using partition 3 id 0".</a></li>
<li><a href="#LargeDrive">14.7 - Jak je to s velkými disky ?</a></li>
<li><a href="#InstBoot">14.8 - Instalace Bootblocks - specifické pro i386</a></li>
<li><a href="#Backup">14.9 - Pøíprava na katastrofu: Zálohování a obnova z pásky.</a></li>
<li><a href="#MountImage">14.10 - Mountování disk images v OpenBSD</a></li>
<li><a href="#pciideErr">14.11 - Pomoc! Dostávám chyby s PCIIDE!</a></li>
<li><a href="#IDEDMA"     >14.12 - Pøikázání DMA pøístupu k IDE diskùm</a>
<li><a href="#RAID">14.13 - Mo¾nosti pou¾ití RAID s OpenBSD</a></li>k
</ul>
<hr>

<a name="disklabel"></a>
<h2>Pou¾ívání disklabel v OpenBSD</h2>
<h3>Obsah</h3>

<ul>
<li><a href="#disklabel.1">Co to je disklabel?</a>
<li><a href="#disklabel.2">Pou¾ití disklabel bìhem instalace OpenBSD</a>
<li><a href="#disklabel.3">Bì¾né pou¾ití disklabel(8).</a>
</ul>


<p>
<a name="disklabel.1"></a>
<h3>Co to je disklabel?</h3>
 
<p>
Nejprve se ujistìte, ¾e jste si pøeèetli manuálovou stránku 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8&amp;format=html">disklabel(8)</a>
</p>
  
<p>
Disklabely jsou vytváøeny k tomu, aby existovalo rozhraní mezi diskem a
diskovými drivery obsa¾enými v kernelu. Labely dr¾í urèitou informaci o va¹em
disku , napø. geometrii disku a informaci o filesytémech. To je vyu¾ito
bootstrap programem k inicializaci disku a k tomu aby se vìdìlo kde je který
filesystém v rámci disku. Labely jsou navíc vyu¾ívány ve spojení se
filesystémy k vytvoøení efektivnìj¹ího prosøedí. Detailnìj¹í informace o
diklabelu jsou obsa¾eny v manuálové stránce 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=5&amp;format=html">disklabel(5)</a>
</p> 

<p>
Disklabel umo¾òuje navíc pøekonat omezení diskových oddílù dané architekturou.
Napøíklad na i386 mù¾ete mít pouze 4 primární diskové oddíly (partitons).
(Diskové oddíly které jsou vidìt na ostatních systémech jako napø. na WindowsNT nebo DOS) s 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8&amp;format=html">disklabel(8),</a>
 mù¾ete vyu¾ít jeden z tìchto primárních oddílù k
ulo¾ení *v¹ech* oddílù OpenBSD. (napø. 'swap', '/', '/usr' and '/var'). A
stále vám zùstávají 3 oddíly pro jiné operaèní systémy!
</p>

<a name="disklabel.2"></a>
<h3>Pou¾ití disklabel bìhem instalace OpenBSD</h3>

<p>
Jedna z hlavních èástí instalace OpenBSD je vytvoøení labelù. To následuje
(pro architekturu i386) hned po pou¾ití programu <a href="#fdisk">fdisk(1)</a>.
Bìhem instalace vyu¾ijete disklabel na vytvoøení jednotlivých labelù v rámci
jednoho diskového oddílu, která budou obsahovat mimojiné i názvy
pøípojných bodù. Bìhem instalace mù¾ete nastavit
va¹e pøípojné body v <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8&amp;format=html">disklabel(8),</a> ale to není úplnì nezbytné, proto¾e pozdìji
budete vy¾ádáni, abyste potvrdili va¹e volby. Pøesto to dìlá instalaèní
proceduru rychlej¹í.
</p>

<p>
První label, který vytvoøíte bude 'a'. Tento label by mìl být namountován jako
/. Doporuèené oddíly a jejich velikosti si mù¾ete prohlédnout v  <a
href="faq4.html#SpaceNeeded">FAQ 4, Je potøeba volné místo</a>. Pro servery je doporuèené, abyste vytvoøili
tyto diskové oddíly separátnì. Pro bì¾né u¾ivatele bude staèit vytvoøení
mounpointu /. Ne¾ vytvoøíte vá¹ root diskový oddíl, uvìdomte si, ¾e budete
je¹tì potøebovat nìjaké místo pro label swap. Tím jsme vysvìtlili základy
diskalbelu a mù¾eme pøistoupit k pøíkladùm bìhem instalace. V prvním pøíkladu
pøedpokládáme, ¾e OpenBSD bude jediný operaèní systém na tomto poèítaèi a ¾e
budete provádìt plnou instalaci. 
</p>


Pokud je disk sdílen s jinými operaèními systémy, mìly by tyto mít BIOS oddíl,
který rozdìluje prostor, který pokrývájí. Pro bezpeènost se pøesvìdète, ¾e
Oddíl s OpenBSD je v rozmezí offsetù a velikosti daných v 'A6' tabulce BIOSu.
(Implicitnì se bude disklabel sna¾it toto vnutit). Pokud si nejste jisti, jak
rozdìlit korektnì nìkolik oddílù, (napø. rozdìlení /,  /usr, /tmp, /var,
/usr/local a jiných) jednodu¹e prozatím rozdìlte místo mezi oddíly root a swap.  

<pre>
# using MBR partition 3: type A6 off 63 (0x3f) size 4991553 (0x4c2a41) 

Treating sectors 63-16386300 as the OpenBSD portion of the disk.
You can use the 'b' command to change this.

Initial label editor (enter '?' for help at any prompt)
&gt; <strong>d a</strong>
&gt; <strong>a a</strong>
offset: [63] <strong>&lt;Enter&gt;</strong>
size: [16386237] <strong>64M</strong>
Rounding to nearest cylinder: 131040
FS type: [4.2BSD] <strong>&lt;Enter&gt;</strong>
mount point: [none] <strong>/</strong>
fragment size: [1024] <strong>&lt;Enter&gt;</strong>
block size: [8192] <strong>&lt;Enter&gt;</strong>
cpg: [16] <strong>&lt;Enter&gt;</strong>
&gt; <strong>a b</strong>
offset: [131103] <strong>&lt;Enter&gt;</strong>
size: [16255197] <strong>64M</strong>
Rounding to nearest cylinder: 131040
FS type: [swap] <strong>&lt;Enter&gt;</strong>
</pre>

<p>
V této chvíli jsme vytvoøili 64M root diskový oddíl na /, a 64Megový oddíl pro
swap. V¹imnìte si, ¾e offset zaèíná na sektoru 63. To je pøesnì to co chcete.
Disklabel ukazuje velikost v sektorech, nicménì nemusíte vkládat velikosti
pouze v sektorech. Jako v pøíkladu vý¹e mù¾ete vkládat velikosti napø. jako
<i>64 Megabytes = 64M</i> a <i>2 Gigabytes = 2G</i>. Disklabel toto zaokrouhlí
na nebli¾¹í cylindr. V pøíkladu vý¹e mù¾ete také zaznamenat, ¾e disklabel
pøedpokládá, ¾e label 'b' bude oddíl pro swap. To je správný pøedpoklad a
jádro GENERIC je nastaveno aby se dívalo po swapu v labelu 'b' a vy bystì mìli
pou¾ít 'b' jako label pro swap standartnì.
</p>

<p>
Dal¹í pøíklad vás provede vytvoøením dal¹ích dvou labelù. To znamená, ¾e to
není kompletní instalace, proto¾e velikost tìchto labelù by nestaèila na
plnou instalaci OpenBSD. 
</p>

<pre>
&gt; <strong>a d</strong>
offset: [262143] <strong>&lt;Enter&gt;</strong>
size: [16124157] <strong>64M</strong>
Rounding to nearest cylinder: 131040
FS type: [4.2BSD] <strong>&lt;Enter&gt;</strong>
mount point: [none] <strong>/tmp</strong>
fragment size: [1024] <strong>&lt;Enter&gt;</strong>
block size: [8192] <strong>&lt;Enter&gt;</strong>
cpg: [16] <strong>&lt;Enter&gt;</strong>
&gt; <strong>a e</strong>
offset: [393183] <strong>&lt;Enter&gt;</strong>
size: [15993117] <strong>64M</strong>
Rounding to nearest cylinder: 131040
FS type: [4.2BSD] <strong>&lt;Enter&gt;</strong>
mount point: [none] <strong>/var</strong>
fragment size: [1024] <strong>&lt;Enter&gt;</strong>
block size: [8192] <strong>&lt;Enter&gt;</strong>
cpg: [16] <strong>&lt;Enter&gt;</strong>
</pre>

<p>
V pøíkladì uvedeném vý¹e byste si mìli v¹imnout dvou vìcí. Jedna z nich je
fakt, ¾e offset se poèítá automaticky, tak aby byl dal¹í v poøadí. Pokud
budete provádìt instalaci tohoto typu, vùbec se nebudete muset s offsety
zabývat. Dal¹í rozdíl, kterého si mù¾ete v¹imnout je, ¾e label 'c' byl
pøeskoèen. To bylo provedeno z toho dùvodu, ¾e label 'c' representuje celý
disk, tak¾e s labelem 'c' byste nemìli operovat.
</p>

<p>
Pokud jste vytvoøili v¹echny labely, které jste chtìli, je èas zapsat tyto
informace na disk a pokraèovat v instalaèním procesu. Abyste zapsali v¹echno
na disk a ukonèili disklabel (a pokraèovali s instalací) udìlejte:
</p>

<pre>
&gt; <strong>w</strong>
&gt; <strong>q</strong>
</pre>

<p>
<strong>*POZOR!*</strong> - Pro u¾ivatele s velkými disky: Pokud vá¹ bios
nemumí rozpoznat správnout velikost va¹eho disku, OpenBSD to nebude umìt taky.
V opaèném pøípadì si OpenBSD poradí s diskem normálnì. Pokud jste v situaci,
kdy vá¹ bios nepodporuje vá¹ disk, zkuste produkty typu Maxtor EZ-Drive.
</p>


<a name="disklabel.3"></a>
<h3>Bì¾né pou¾ití disklabel(8)u</h3>

<p>
Pokud je vá¹ systém nainstalován, nìmeli byste pou¾ívat disklabel moc èasto.
Budete ho ale potøeba v pøípadì, ¾e budete chtít pøidat, odebrat nebo
restruktorovat va¹e disky. Jedna z prvních vìcí které budete potøebovat udìlat
je vypsat si stávající disklabel, jednodu¹e napi¹te:
</p>

<pre>
# <strong>disklabel wd0</strong> &gt;----- Podle toho jaký device si budete
# chtít prohlédnout

# using MBR partition 3: type A6 off 64 (0x40) size 16777152 (0xffffc0)
# /dev/rwd0c:
type: ESDI
disk:
label: TOSHIBA MK2720FC
flags:
bytes/sector: 512
sectors/track: 63
tracks/cylinder: 16
sectors/cylinder: 1008
cylinders: 2633
total sectors: 2654064
rpm: 3600
interleave: 1
trackskew: 0
cylinderskew: 0
headswitch: 0           # millisekundy
track-to-track seek: 0  # millisekundy
drivedata: 0 

16 partitions:
#        size   offset    fstype   [fsize bsize   cpg]
  a:  2071440    65583    4.2BSD     1024  8192    16   # (Cyl.   65*- 2120)
  b:    65520       63      swap                        # (Cyl.    0*- 65)
  c:  2654064        0    unused        0     0         # (Cyl.    0 - 2632)
  j:   512001  2137023    4.2BSD     1024  8192    16   # (Cyl. 2120*- 2627*)
</pre>

<p>
Vý¹e uvedený pøíkaz vám jednodu¹e dovolí vypsat stávající disklabel a ujistit
se, ¾e nic nepokazíte. (Co¾ v¹ichni nìkdy potøebujeme.) Abyste byli schopni
udìlat zmìny, musíte disklabel vyvolat s op¹nou -E.
</p>

<pre>
# <strong>disklabel -E wd0</strong>
</pre>

<p>
To vám hodí prompt, ten samý jaký jste pou¾ívali pøi instalaci OpenBSD.
NEjdùle¾itìj¹í pøíkaz na tomto promptu je asi '?'. To vám vylistuje v¹echny
mo¾nosti. Dokonce se mù¾ete podívat na kompletní manuálovou stránku
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8&amp;format=html">disklabel(8)</a>
 pomocí pøíkazu 'M'. Z toho promptu budete dìlat vìci jako
pøidávat, mazat nebo mìnit diskové oddíly. Pro více informací si pøeètìte
manuálovou stránku 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;sektion=8&amp;format=html">disklabel(8)</a>.
</p>

<a name="fdisk"></a>
<h2>14.2 - Pou¾ívání utility fdisk</h2>

<p>
Nejprve se ujistìte, ¾e jste si pøeèetli hlavní manuálovou stránku fdisku
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;apropos=0&amp;sektion=8&amp;arch=i386&amp;format=html">fdisk(8)</a>.
</p>
<p>
Fdisk je program, který má pomáhat s údr¾bou va¹ich diskových oddílù. Tento
program je pou¾it pøi instalaci k nastavení va¹eho diskového oddílu s OpenBSD.
(tento dikový oddíl mù¾e obsahovat <u>nìkolik</u> labelù, ka¾dý s
filesystémem/swapem/atd.).
Mù¾e rozdìlit prostor na va¹ich discích a nastavit jeden aktivní. Tento
program je obvykle pou¾íván v Single Boot Módu ( boot -s ). Fdisk dále
nastavuje MBR na va¹ich rùzných discích.
</p>

<p>
Pro potøeby instalce budete potøebovat pouze <b>JEDEN</b> diskový oddíl s
OpenBSD a pak pou¾ijete disklabel abyste na nìm nastavili prostor pro swap a
filesystem.
</p>

<p>
Abyste si prohlédli tabulku va¹ich diskových oddílù: <br> 
</p>
<pre># <strong>fdisk fd0</strong><br>
</pre>

<p>
Co¾ vám dá výstup podobný tomuto:
</p>

<pre>
         Disk: fd0       geometry: 80/2/18 [2880 sectors]
         Offset: 0       Signatures: 0xAA55,0x0
                  Starting        Ending
          #: id  cyl  hd sec -  cyl  hd sec [     start -       size]
----------------------------------------------------------------------
         *0: A6    0   0   1 -   79   1  18 [         0 -       2880] OpenBSD
          1: 00    0   0   0 -    0   0   0 [         0 -          0] unused
          2: A7    0   0   2 -   79   1  18 [         1 -       2879] NEXTSTEP
          3: 00    0   0   0 -    0   0   0 [         0 -          0] unused
</pre>

<p>
V tomto pøíkladì ukazujeme výstup fdisku bez floppy drajvu. Mù¾eme nastavit
diskový oddíl OpenBSD (A6) a jeho velikost. * nám ríká, ¾e diskový oddíl s
OpenBSD je bootovatelný.
</p>

<p>
V pøedchozí ukázce jsem jenom vypisovali informaci. Co kdy¾ budeme chtít
editovat tabulku na¹ich diskových oddílù? Abysme tak mohli uèinit, budeme
potøebovat pou¾ít <b>-e</b> flag. To nás dostane do promptu pro interakci s
fdiskem.
</p>

<pre>
# <strong>fdisk -e wd0</strong>
Enter 'help' for information
fdisk: 1&gt; <strong>help</strong>
        help            Command help list
        manual          Show entire OpenBSD man page for fdisk
        reinit          Re-initialize loaded MBR (to defaults)
        setpid          Set the identifier of a given table entry
        disk            Edit current drive stats
        edit            Edit given table entry
        flag            Flag given table entry as bootable
        update          Update machine code in loaded MBR
        select          Select extended partition table entry MBR
        print           Print loaded MBR partition table
        write           Write loaded MBR to disk
        exit            Exit edit of current MBR, without saving changes
        quit            Quit edit of current MBR, saving current changes
        abort           Abort program without saving current changes
fdisk: 1&gt; 
</pre>

<p> 
Je naprosto bezpeèné podívat se a prozkoumat co vás zajímá, jenom se ujistìte,
¾e odpovíte <Strong>N</strong> na dotaz o ukládání zmìn a *NEPOU®ÍVEJTE*
pøíkaz <strong>write</strong>.
</p>

<p>Zde je pøehled pøíkazù které mù¾ete pou¾ít s volbou <b>-e</b>.<br>
<ul>
<li><strong>help</strong>    Vypí¹e seznam pøíkazù, kterým disk rozumí v
interaktivním módu.</li>
<li><strong>reinit</strong>  Zinicializuje aktuálnì vybranou, v pamìti
ulo¾enou kopii boot bloku.</li>
<li><strong>setpid</strong>  Zmìní identifikátor parti¹ny pro
danou polo¾ku tabulky parti¹en. Tento pøíkaz je pøíslu¹nì u¾iteèný
pro opìtovné pøiøazení parti¹ny OpenBSD.</li>
<li><strong>disk</strong>    Zobrazí aktuální geometrii disku kterou detekoval
fdisk. Budete moci zvolit ji editovat pokud budete chtít.</li>
<li><strong>edit</strong>    Edituje danou polo¾ku v kopii boot bloku, která je ulo¾ena
v pamìti. Mù¾ete buï editovat v BIOS geometry módu nebo v offestech sektorù a
velikostech.</li>
<li><strong>flag</strong>    Nastaví danou tabulku diskoých oddílù
bootovatelnou. Pouze jeden záznam mù¾e být nastaven jako bootovatelný. Pokud
chcete bootovat z extended diskového oddílu, budete potøebovat oznaèit záznam
v tabulce pro extended diskový oddíl jako bootovatelný.</li>
<li><strong>update</strong>  Updatne strojový kód v pamìti v kopii aktuálnì
vybraného boot bloku.</li>
<li><strong>select</strong>  Nastaví a nahraje do pamìti boot blok, na který
ukazuje extended diskový oddíl v tabulce v rámci aktuálního boot bloku.</li>
<li><strong>print</strong>   Vytiskne na terminál akuálnì nastavený boot bloku, který je
ulo¾en v pamìti a jeho MBR tabulku.</li>
<li><strong>write</strong>   Zapí¹e kopii aktuálního boot bloku ulo¾enou v
pamìti  na disk. Budete dotázáni, abyste tuto operaci potvrdili.</li>
<li><strong>exit</strong>    Vyleze ze stávající urovnì fdisku, buï se vrátí
k pøedchozí kopii boot bloku ulo¾ené v pamìti nebo ukonèí program, pokud
nezbývá ¾ádná fdal¹í úroveò.</li>
<li><strong>quit</strong>    Ukonèí aktuální úroveò fdisku, buï se vrátí
pøedchozí kopii boot bloku ulo¾ené v pamìti nebo ukonèí program, pokud nezbývá
¾ádná fdal¹í úroveò. Na rozdíl od fdisku zapí¹e aktuální zmìny  v bloku na
disk. </li>
<li><strong>abort</strong>   Ukonèí program bez ulo¾ení zmìn.</li>
</ul>

<a name="NewDisk"></a>
<h2>14.3 - Pøidávání dal¹ích diskù v OpenBSD</h2>

<p>
Jakmile jste instalovali vá¹ disk <strong>SPRÁVNÌ</strong> budete potøebovat
pou¾ít 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;apropos=0&amp;sektion=8&amp;arch=i386&amp;format=html">fdisk(8)</a>
(<i>pouze pro i386</i>) a 
<a href= "http://www.openbsd.org/cgi-bin/man.cgi?query=disklabel&amp;apropos=0&amp;sektion=8&amp;format=html">
disklabel(8)</a> k nastavení va¹eho disku v OpenBSD. 
<P>
Lidi s i386  by mìli zaèít s fdiskem. Dal¹í architektury toto mohou ignorovat. 
<pre>
# <Strong>fdisk -i sd2</strong>
</pre>
Toto nainicializuje "skuteènou" tabulku diskových oddílù pro exkluzivní
pou¾ití OpenBSD. Pak pro ni budete potøebovat vytvoøit disklabel. To se mù¾e
zdát zmatené. 
<pre>
# <strong>disklabel -e sd2</strong>

<i>(obrazovka bude prázdná, spustí se vá¹ $EDITOR)</i>
type: SCSI
<i>...bla...</i>
sectors/track: 63
total sectors: 6185088
<i>...bla...</i>
16 partitions:
#        size   offset    fstype   [fsize bsize   cpg]
  c:  6185088        0    unused        0     0         # (Cyl.    0 - 6135)
  d:  1405080       63    4.2BSD     1024  8192    16   # (Cyl.    0*- 1393*)
  e:  4779945  1405143    4.2BSD     1024  8192    16   # (Cyl. 1393*- 6135)
</pre>
Nejdøíve, ignorujte diskový oddíl 'c', ten je obsa¾en v¾dy a existuje proto
aby programy jako disklabel vùbec mohly fungovat!
Pro normální pou¾ití by mìla být fsize v¾dy 1024,  bsize 8192 a cpg 16. Fstype
je 4.2BSD. Total sectors je celková velikost disku. Toto je disk o velikosti 3
gigabyty. Tøi gigabyty je v termínech výrobce 3000 megabytù. Tak¾e vydìlte
6185088/3000 (pou¾ijte <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=bc&amp;sektion=1">bc(1))</a>). Dostanete 2061. Tak¾e abyste vytvoøili velikost
diskosti diskových oddílù pro a, d, e, f, g, ... jednodu¹e vynásobte X*2061
abyste dostali X megabytù místa na daném diskovém oddílu. Ofset pro vá¹ první
diskoý oddíl bude ten samý jako "sectors/track" vypsaný ve výstupu disklabelu
vý¹e. Pro nás je to 63. Ofset pro ka¾dý dal¹í diskový oddíl by mìl být
kombinace velikosti ka¾dého diskového oddílu a ofsetu ka¾dého diskového
oddílu. (Kromì diskového oddílu 'c', ten v této rovnici nehraje ¾ádnou roli.)
<P>
Jiná mo¾nost je ta, ¾e budete chtít jeden diskové oddíl na disku, øeknìme ¾e
budete pou¾ívat celý disk pro web nebo jako adresáø home nebo tak nìco, pak
vezmìte celkovou velikost disku a odeètìte od ní poèet sektorù na stopu.
6185088-63 = 6185025.  Vá¹ diskový oddíl je
<pre>
    d:  6185025       63    4.2BSD     1024  8192    16 
</pre>
<P>
<b>
Pokud se vám toto v¹e zdá zbyteènì slo¾ité, mù¾ete pou¾ít disklabel -E abyste
dostali ten samý mód diskového oddílu, který jste dostali na instalaèním
disku!</b> Mù¾ete zadat "96M" abyste øekli "96 megabytù". (Nebo pokud máte tak
velký disk, tak 96G pro 96 giga!) Nane¹tìstí mód -E pou¾ívá diskovou geonetrii
z BIOSu a ne tu reálnou a èasto se tyto dvì li¹í. Abyste toto omezení obe¹li,
napi¹te 'g d' pro 'geometry disk'. (Jiné mo¾nosti jsou  'g b' pro 'geometry
bios' a 'g u' pro geometry user, nebo jednodu¹e pro to, co label øíkal pøedtím
ne¾ disklabel ulo¾il zmìny.)
<P>
To je docela dost, ale je¹tì nejsme u konce. Nakonec budete potøebovat
vytvoøit filesystem na disku tím, ¾e pou¾ijete
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=newfs&amp;apropos=0&amp;sektion=8&amp;format=html">newfs(8)</a>.
</p>

<pre>
# <strong>newfs wd1a </strong>
</pre>

<p>
Podle toho jak byl vá¹ disk pojmenován v rámci schematu OpenBSD. (Podívejte se
na výstup z <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dmesg&amp;sektion=8">dmesg(8)</a> abyste vidìli jak byl vá¹ disk pojmenován.)
</p>

<p>
Ted zjistìte kam budete tento právì vytvoøený diskový oddíl montovat. Øeknìme,
¾e ho budete chtít montovat pod /u. Nejprve vytvoøte adresáø /u. Pak jej
namontujte.
</p>

<pre>
# <strong>mount /dev/wd1a /u</strong>
</pre>

<P>
Nakonec ho pøidejte do <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5">/etc/fstab(5)</a>
</p>
<pre>/dev/wd1a /u ffs rw 1 1</pre>

<p>
Co kdy¾ budete pøemístit ji¾ existující adresáø jako napø. /usr/local? Mìli
byste namontovat nový disk do /mnt a pak pou¾ít cpio -pdum abyste nakopírovali
/usr/local do adresáøe v /mnt. Zeditujte soubor  <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5">/etc/fstab(5)</a> aby ukazoval, ¾e
diskový oddíl s /usr/local je teï /dev/wd1a (vá¹ novì naformátovaný diskový
oddíl.)
Pøíklad:
</p>

<pre>
<strong>/dev/wd1a /usr/local ffs rw 1 1</strong>
</pre>

<p>
Rebootujte do single módu..<strong>boot -s</strong> Pøemístìte existující
/usr/local do /usr/local-backup (nebo ho sma¾te, jestli se na to cítíte) a
vytvoøte prázdný adresáø /usr/local. Pak rebootujte systém a voila!! soubory
jsou tam!
</p>

<br>

<a name="SwapFile"></a>
<h2>14.4 - Jak swapovat do souboru</h2>

<p>
(Poznámka: jestli¾e chcete swapovat do souboru proto, ¾e dostáváte hlá¹ky jako
&quot;virtual memory exhausted&quot; mìli byste nejdøíve zkusit zvý¹it limity
na proces pomocí 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=unlimit&amp;sektion=1&amp;format=html">unlimit(1)</a>
v csh,
nebo
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=ulimit&amp;sektion=1&amp;format=html">ulimit(1)</a>
v sh.)
</p>

<p>
Swapování do souboru nevy¾aduje zvlá¹tní konfiguraci kernelu, 
aèkoliv to klidnì mù¾ete udìlat, tento faq vám uká¾e jak
to udìlat obìma zpùsoby.
</p>

<h3>Swapování do souboru.</h3>

<p>
Swapování do souboru je nejjedodu¹¹í a nejrychlej¹í cesta jak dostat dal¹í
prostor pro swap. To neplatí pro u¾ivatele, kteøí pou¾ívají Soft Updates. (Není
nastaveno jako default).
Abyste mohli zaèít, podívejte se kolik swapu v souèasné chvíli pou¾íváte, tím
¾e se podíváte pomocí utility
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=swapctl&amp;sektion=8&amp;format=html">swapctl(8)</a>
To mù¾ete udìlat tak, ¾e spustíte:
</p>

<pre>
$ <strong>swapctl -l</strong>
Device      512-blocks     Used    Avail Capacity  Priority
swap_device      65520        8    65512     0%    0
</pre>

<p>
To ukazuje zaøízení a jejich statistiky které jsou aktuálnì pou¾ívány pro
swapování. V pøíkladu uvedeném vý¹e existuje pouze jedno zaøízení pojmenováné
&quot;swap_device&quot;.&quot;swap_device&quot;. To je pøeddefinovaná oblast
na disku která je pou¾ita pro swapování. (Ukazuje se jako dikový oddíl b kdy¾
si prohlí¾íte disklabely). Jak mù¾ete v pøíkladu dále vidìt, toto zaøízení e v
souèasné dobì moc nepou¾ívá. Ale pro úèely tohoto dokumentu budeme dìlat, ¾e
potøebujeme dal¹ích 32M.
</p>
<p>
První krok jak nastavit soubor jako swapovací zaøízení je vytvoøení souboru.
To je nejlep¹í udìlat pomocí utility
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dd&amp;sektion=1&amp; format=html">dd(1)</a>
Tady je pøíklad vytvoøení souboru <i>/var/swap</i> který má velikost 32M.
</p>

<pre>
$ <strong>sudo dd if=/dev/zero of=/var/swap bs=1k count=32768</strong>
32768+0 records in
32768+0 records out
33554432 bytes transferred in 20 secs (1677721 bytes/sec)
</pre>

<p>
Jakmile je toto hotovo, mù¾eme zapnout swapování do tohoto zaøízení. Pou¾ijte
následující pøíkaz k tomu abyste zapnuli swapování na toto zaøízení.
</p>

<pre>
$ <strong>sudo chmod 600 /var/swap</strong>
$ <strong>sudo swapctl -a /var/swap</strong>
</pre>

<p>
Teï budeme potøebovat zjistit, jestli bylo korektnì pøidáno do seznamu
zaøízení pro swap.
</p>

<pre>
$ <strong>swapctl -l</strong>
Device      512-blocks     Used    Avail Capacity  Priority
swap_device      65520        8    65512     0%    0
/var/swap        65536        0    65536     0%    0
Total           131056        8   131048     0%
</pre>

<p>
Teï kdy¾ jste nastavili a zapnuli swapování do souboru, budete potøebovat
pøidat øádku do va¹eho souboru <i>/etc/fstab</i> aby se konfigurace provedla
pøi ka¾dém bootu. Pokud tuto øádku nepøidáte, nebude zaøízení zkonfigurováno.
</p>

<pre>
$ <strong>cat /etc/fstab</strong>
/dev/wd0a / ffs rw 1 1
/var/swap /var/swap swap sw 0 0
</pre>

<h3>Swapování pomocí zaøízení vnode</h3>

<p>
Toto je více dlouhodobé øe¹ení jak pøidat více prostoru pro swap. Abyste
swapovali do souboru trvale, nejdøíve vytvoøte kernel s vnd0c jako swap. Pokud
máte wd0a jako root filesystem, wd0b je pøedchozí swap, pou¾ijte tento øádek
ve va¹em souboru s konfigurací jádra (souvisí s kompilaci jádra): 
</p>

<pre>
config          bsd     root on wd0a swap on wd0b and vnd0c dumps on wd0b
</pre>

<p>
Jakmile je toto hotovo, budete potøebovat vytvoøit soubor, který bude pou¾íván
ke swapování. Mìli byste to udìlat pomocí toto samého pøíkazu uvedeného v
pøíkladech vý¹e.
</p>

<ul><pre>
$ <strong>sudo dd if=/dev/zero of=/var/swap bs=1k count=32768</strong>
32768+0 records in
32768+0 records out
33554432 bytes transferred in 20 secs (1677721 bytes/sec)
</pre></ul>

<p>
Teï je vá¹ soubor na místì, budete potøebovat pøidat tento soubor do
<i>/etc/fstab</i>. Zde je pøíklad jak nabootovat s tímto zaøízení jako
swapovacím.
</p>

<ul><pre>
$ <strong>cat /etc/fstab</strong>
/dev/wd0a / ffs rw 1 1
/dev/vnd0c none swap sw 0 0 
</pre></ul>

<p>
V tomto bodì budete muset rebootovat vá¹ poèítaè aby se projevily zmìny v
jádøe. Jakmile je to hotovo, je èas nakonfigurovat toto zaøízení jako
swapovací. Abyste to udìlali, pou¾ijte
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vnconfig&amp;sektion=8&amp;format=html">vnconfig(8)</a>.
</p>

<pre>
$ <strong>sudo vnconfig -c -v vnd0 /var/swap</strong>
vnd0: 33554432 bytes on /var/swap
</pre>

<p>
Posledním krok je zapnutí  swapování do tohoto zaøízení. Udìláme to stejnì
jako v pøíkladech uvedených vý¹e, pou¾ijeme k tomu  swapctl(8). Pak zjistíme
jestli bylo korektnì pøidáno do na¹eho listu swapovacích zaøízení.
</p>

<pre>
$ <strong>sudo swapctl -a /dev/vnd0c</strong>
$ <strong>swapctl -l</strong>
Device      512-blocks     Used    Avail Capacity  Priority
swap_device      65520        8    65512     0%    0
/dev/vnd0c       65536        0    65536     0%    0
Total           131056        8   131048     0%
</pre>



<p><a name="SoftUpdates"></a>
<h2>14.5 - Soft Updates</h2>


<p>
Posledních pár let pracoval Kirk McKusick na nìèem nazývaném "soft updates".
Celé je to zalo¾eno na idei navrhované Greg Gangerem a Yale Pattem kteøí
navrhli èásteèné uspoøádání operací v buffer cache, které by dovolilo
odstranìní po¾adavkù na synchronní zapisování adresáøovách polo¾ek z kódu FFS.
Tím se rapidnì zvý¹í rychlost zápisu na disk.<br>
Proto¾e soft updates jsou jako celek stále ve vývoji, je nadále
nutné <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fsck&amp;sektion=8">fsck(8)</a>
v pøípadì, ¾e poèítaè je náhle vypnut bez správné ukonèovací sekvence. Tato
skuteènost bude ale opravena v budoucích verzích.<p>
Více informací a detailù o soft updates lze nalézt v pracích 
<a href="http://www.ece.cmu.edu/~ganger/papers/CSE-TR-254-95/">Ganger a Patt</a>
a z <a href="http://www.mckusick.com/softdep/index.html">McKusick</a>.
</p>

<p>
Pro pou¾ívání Soft Updates potøebujete mít jádro zkompilované s volbou
</p>

<p>
<strong>FFS_SOFTUPDATES</strong>
</p>
tato volba se nachází u¾ v jádrech GENERIC. 

<p>
Zapnutí Soft Updates musí být provedeno s op¹nou pøíkazu mount,
kdy¾ montujete parti¹nu s utilitou 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&amp;sektion=8">mount(8)</a>,
mù¾ete specifikovat mù¾ete specifikovat, jestli si pøejete zapnout
soft updaty na této parti¹nì. Ní¾e uvedený je pøíklad 
záznamu do <i><a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=fstab&amp;sektion=5">/etc/fstab(5)</a></i>,
který má jednu parti¹nu <i>sd0a</i> kterou jsme namontovali se
soft updates.

</p>

<pre>
/dev/sd0a / ffs rw,softdep 1 1
</pre>

<p>
Poznámka pro u¾ivatele na platformì sparc. Nezapínejte softupdates na 
strojích sun4 nebo sun4k. Tyto architektury podporují pouze omezené mno¾ství 
pamìti jádra a nemohou pou¾ívat tuto volbu. Stroje sun4m tímto omezením netrpí.
</p>

<a name="D0P3"></a>
<h2>14.6 -  Kdy¾ nabootuji po instalaci OpenBSD/i386, zastaví se na
"Using partition 3 id 0" - specifické pro i386.</h2>
<p>
Toto není vlastnì chybová hlá¹ka sama o sobì, je to boot loader v
MBR, který vám øíká, ze kterého disku a z které partition se chystá
bootovat. Problém je, ¾e v této chvíli se proces zastavil.
</p>
<p>
Existují dva bì¾né dùvody, proè se to stalo: nekompatibilita mezi 
BIOSem a OpenBSD MBR nebo problém s geometrií disku. Pøíklad
¹patné geometrie disku by byl pokud byste pøesunuli disk z jednoho
poèítaèe do druhého, updatovali BIOS nebo zmìnili nastavení BIOSu,
aèkoliv je èasto hlá¹eno, ¾e se to mù¾e stát z neznámých dùvodù
bìhem instalace.
</p>
<p>
<b>Poznámka:</b> Poèínaje OpenBSD 3.1, problém s kompatibilitou
BIOSu by mìl být vyøe¹en prakticky na v¹ech systémech. Nicménì je
poøád mo¾né mít problém s geometrií disku, tak¾e je stále mo¾né,
¾e se systém zastaví na této hlá¹ce.
</p>
<p>
Abyste opravili problém s kompatibilitou BIOSu, musíte pøepsat
boot loader nìjakým, který je s va¹ím systémem kompatibilní.
Na¹tìstí je lehké takový získat.
</p>

<h3>Instalace bootloader BootEasy:</h3>
<p>
Toto vy¾aduje abyste rebootovali vá¹ systém. Proto¾e nemù¾eme z
pevného disku nabootovat pøímo, musíme pou¾ít bootovací disketu nebo
CD-ROM, abychmo zaèali bootovací proces. A¾ se systém dostane k
'boot&gt;' promptu, pøesmìrujte ho k bootování z pevného disku:
</p>
<pre>
reading boot.......
probing pc0 com0 com1 pci mem [639k 79m a20=on]
disk hd0 fd0
&gt;&gt; OpenBSD BOOT 1.28
boot&gt; <b>boot hd0a:/bsd</b>
</pre>
<p>
Tento pøíkaz pøesmìruje bootovací proces k souboru /bsd  na
parti¹nì 'a' va¹eho prvního pevného disku, a dovolí tak systému
nabootovat.
</p>
<p>
Jakmile systém jednou nabootuje, budete potøebovat instalovat
bootloader BootEasy. Soubor samotný mù¾ete nalézt jak na CD-ROM,
tak na FTP v adresáøi 3.0/tools/booteasy/Boot.bin a mù¾e být
instalován následujícím <a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&amp;sektion=8&amp;arch=i386&amp;format=html">fdisk(8)</a>
pøíkazem:
</p>
<pre>
# <b>fdisk -i -f /mnt/3.0/tools/booteasy/Boot.bin wd0</b>
</pre>
<p>
To pøedpokládá, ¾e máte namontované CD s 3.0 v /mnt a ¾e pou¾íváte
IDE disk. Mù¾ete to zmìnit na v závislosti na tom, kde je umístìn
Boot.bin a jaký disk máte (SCSI disk bude typicky sd0).
<b>Poznámka: Nedìlejte to, jestli¾e OpenBSD parti¹na nepokrývá
celý vá¹ disk!</b> Inicialize MBR touto cestou vytvoøí OpenBSD
parti¹nu, která pokrývá celý disk a sma¾e ostatní parti¹ny, co¾ je
zøídkakdy dobré.
</p>
<p>
BootEasy má dal¹í vlastnost, která vás mù¾e zajímat, jestli¾e máte
problémy s defaultním bootloaderem: Je schopen vybrat bootovací
parti¹nu pøi startu -- nechá vás vybrat z které parti¹ny
nabootovat a nabootuje z aktivní parti¹ny, pokud nebyl proveden
¾ádný výbìr. To mù¾e být velmi u¾iteèné pokud máte na va¹em disku
více operaèních systémù. Instalace BootEasy touto cestou je pøes
MS-DOS pomocí BOOTINST.EXE, který naleznete v adreáøi BootEasy na
CD-ROM a FTP serverech.
</p>
<h3>Instalace MS-DOS boot loaderu: </h3>
<p>
Nabootujte z bootovacího disku Windows 9x nebo DOSu verze 6 s,
který obsahuje FDISK.EXE. Jakmile je systém nabootován do MS-DOS
promptu, zadejte následující:
</p>
<pre>
A:\&gt;<b>fdisk /mbr</b>
</pre>
<p>
Mìli byste vidìt krátký pøístup k disku a pak by vás pøíkaz mìl
vrátit do pøíkazového øádku bez ¾ádné hlá¹ky. "Bad command or file
name"  znamená, ¾e disk, který jste pou¾ili neobsahuje FDISK.EXE.
Pokud to udìláte správnì, hlá¹ka "Using ..." bude odstranìna,
proto¾e se nahradil kód, který ji produkuje. Pokud máte problémy s
kompatibilitou BIOSu, budou nyní pryè, rebootujte a zaènìte
instalaci OpenBSD.
</p>
<p>
Bylo hlá¹eno, ¾e toto funguje s FreeDOSem.
</p>

<h3>Boot loader OS-BS:</h3>
<p>
Dal¹í boot loader, OS-BS je na CD-ROM a dostupný z FTP v
2.9/tools/osbs135.exe. OS-BS web stánka je na 
<a href="http://www.prz.tu-berlin.de/~wolf/os-bs.html">
    http://www.prz.tu-berlin.de/~wolf/os-bs.html</a>
</p>
<h3>LILO:</h3>
<p>
Mù¾ete pou¾ít také LILO. Pro detaily se podívejte na
<a href="ftp://ftp.openbsd.org/pub/OpenBSD/3.0/i386/INSTALL.linux">INSTALL.linux</a>
</p>

<h3>Jak se problému vyhnout</h3>
<p>
Relativnì málo strojù má problém s kompatibilitou BIOSu, ale
jestli¾e nastavujete stroj, o kterém víte, ¾e má tento problém,
mù¾ete se mu snadno vyhnout. OpenBSD bootloader je instalován je
pokud odpovíte 'Y' na otázku 'Use entire disk for OpenBSD'. Pokud
odpovíte 'N' a ruènì vytvoøíte OpenBSD parti¹nu, nebude bootloader
pøepsán dokud nepouøijete 'reinit' nebo 'update' pøíkazy fdisku.
Toto samozøejmì pøedpokládá, ¾e vá¹ disk ZAÈÍNAL nìjakým
bootloaderem -- pokud tomu tak není (nový disk, èistý disk vyta¾ený z
jiné platformy), budete muset instalovat nìjaký bootloader pøed
tím, ne¾ sytém nabootuje.
</p>

<h3>Øe¹ení problému s geometrií disku:</h3>
<p>
Ideálnì byste se tomuto problému vyhnuli, tak, ¾e zachováte tu
samou geometrii, ne ¾e ji budete opravovat, aèkoliv nìkdy se tomu
nemù¾ete vyhnout. Pøíkladem by mohlo být vyta¾ení velkého disku ze
starého poèítaèe, který nepodporuje LBA geometrii do nového
stroje, který trvá na pou¾ití LBA.
</p>
<p>
Nastartujte stroj za pou¾ití bootovacího disku nebo CD-ROM jak je
popsáno vý¹e. NAlogujte se jako root a spus»te následující
pøíkazy:
</p>
<pre>
# cp /usr/mdec/boot /boot
# /usr/mdec/installboot -v /boot /usr/mdec/biosboot wd0
</pre>
<p>
Nabootujte, vá¹ systém by mìl nabìhnout.
</p>
<p>
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=installboot&amp;sektion=8&amp;arch=i386">installboot(8)</a>
nainstaluje a nakonfiguruje boot loader,
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=biosboot&amp;sektion=8&amp;arch=i386">biosboot(8)</a>,
kter7 nahraje
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>
je modul, který nahraje kernel do RAM.
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=biosboot&amp;sektion=8&amp;arch=i386">biosboot(8)</a>
má v sobì tabulku, která ukazuje na fyzické umístìní (podle va¹eho
BIOSu) z
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>.
Pokud udìláte nìco co zmìní náhled BIOSu na umístìní
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>,
musíte znovu spustit
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=installboot&amp;sektion=8&amp;arch=i386">installboot(8)</a>
jako vý¹e abyste reinicializovali tabulku ukazující na
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>.
 </p>
Podívejte se na <a href="#InstBoot">Install Boot</a> pro více
informací.
<br>
 
<a name= "LargeDrive"></a>
<a name="14.7"></a>
<h2>14.7 - Jak je to s velkými disky v OpenBSD</h2>
OpenBSD podporuje pro souborové systémy o velikostech mnohem
vìt¹ích ne¾ mají souèasnì nebo brzy dostupné disky, nicménì
existují limity na nìkterých rozhraních, které jsou men¹í ne¾
teoretické maximum OpenBSD. V pøípadì IDE diskù je limit 128GB,
limit souèasného populárního ATA rozhraní. Dal¹í generace ATA
diskù s kapacitami vy¹¹ími ne¾ 128G (1G=2^30, ne 1,000,000,000,
tak¾e nìkteøí výrobci to budou èasto nazývat 137G), nebude
podporována do OpenBSD 3.1 a døívìj¹í.
<a href="/donations.html">Dary</a> 
nebo 
<a href="/want.html">hardware</a> 
pro vývojové uèely jsou vítány.)   
</p>
<p>
Nena¹tìstí, plná schopnost OS je dostupná a¾ PO nahrátí OS do
pamìti a poté, co bootovací proces nastaví limity. Bootovací
proces musí pou¾ít (a tím pádem je jím limitován) systémovou boot
ROM.
OpenBSD i386 boot loadery
(<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=biosboot&amp;sektion=8&amp;arch=i386">biosboot(8)</a>
a 
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=boot&amp;sektion=8&amp;arch=i386">boot(8)</a>)
mají svoje interní limity 8G ze starého limitu BIOSu.
</p> 
<p>
Z tohoto dùvodu musí být celý soubor /bsd (kernel) umístìn na
disku v oblasti adresovatelné boot ROM nebo do 8G na disku, cokoliv
z toho je men¹í. To znamená, ¾e na nìkterých star¹ích poèítaèích
i386 musí být root parti¹na umístìna v prvních 504M, ale pro vìt¹inu
nových poèítaèù mù¾e být root parti¹na bìhem prvních 8G. 
</p> 
<p>
Je mo¾né instalovat 40G disk na starou 486 a nahrát na nìj
OpenBSD na jedné velké parti¹nì a myslet si, ¾e jste poru¹ili vý¹e
uvedené pravidlo. Nicménì to být nepøíjemné v nìkolika ohledech:
</p>
<ul>
  <li>Instalujete na 40G / parti¹nu.  Pracuje to, ale jenom proto¾e base
OS a v¹echny jeho soubory (vèetnì /bsd) jsou v prvních 504M.
  <li>Pou¾íváte systém, a skonèíte s více ne¾ 504M souborù.
  <li>Upgradujete, zkompilujete nový kernel, a zkopírujete 
    nový /bsd pøes starý. 
  <li>Rebootujete.
  <li>Dostanete hlá¹ku "bad magic"
</ul>
<P>
Proè ? Proto¾e kdy¾ zkopírujete "pøes" nový /bsd soubor,
nepøepí¹ete ten starý, ale je umístìn na nové místo, pravdìpodobnì
za hranicí prvních 504M. Boot loader nebyl schopen
najít soubor /bsd a systém se zaseknul.
</p>
<p>
Abyste OpenBSD nabootovali, /bsd musí být v rozmezí podporovaném
boot ROM. Pravidlo je jednoduché:
</p>
<p>
<b>Celá root parti¹na musí být v rozmezí, které je adresovatelné
BIOSem (nebo boot ROM) nebo bìhem prvních 8G, cokoliv z toho je men¹í.</b>
</p>
<p>
Existuje dal¹í dùvod k <a href="faq4.html#SpaceNeeded">rozdìlení
disku na parti¹ny</a>, ne¾ pou¾ívat jednu velkou parti¹nu.
</p>


<p>
<a name="InstBoot"></a>
<h2>14.8 - Instalace Bootblokù - pouze pro i386</h2>

<p>
Star¹í verze MS-DOSu mohou pracovat pouze disky, které mají geometrii 1024
cylinderù nebo ménì. Proto¾e v¹echny nové disky mají více ne¾ 1024 cylindrù,
vìt¹ina SCSI BIOSù (které jsou na SCSI øadièi) a IDE BIOSù (které jsou èástí
BIOSU PC) mají volbu (nìkdy je defaultní) urèenou k "pøekladu" skuteèné
geometrie disku do neèeho co je v rámci mo¾ností MS-DOSu. Nicménì ne v¹echny
BIOSy provádìjí tento pøeklad stejnì. Pokud zmìníte vá¹ BIOS (buï s novou
základní deskou nebo SCSI BIOSem) a ten nový pou¾ívá rozdílný "pøeklad"
geometrie, nebudete schopni nahrát stage boot loader (tím pádem nebudete
schopni nahrát kernel). (To je proto, ¾e first stage boot loader obsahuje
seznam blokù které skládají /boot v rámci originální "pøelo¾ené"
geometrie).
Pokud pou¾íváte IDE disky, a provedete zmìny ve va¹em nastavení BIOSu, mù¾ete
nechtìnì) zmìnit také pøeklady (vìt¹ina IDE diskù nabízí 3 rùzné pøeklady.)
Abyste spravili vá¹ boot block abyste mohli nabootovat normálnì, 
vlo¾te bootovací disketu do drivu (nebo pou¾ijte bootovatelný
CD-ROM) a na pøíkazovém promptu napi¹te "b hd0a:/bsd", èím¾
vynutíte boot z prvního hard disku (a ne z floppy). Va¹e
ma¹ina by mìla nabìhnout normálnì. Teï budete potøebovat updatovat
first stage boot loader abyste vidìli novou geometrii (a znovu
zapsat boot blok podle toho).
<br>
Ná¹ pøíklad bude pøedpokládat ¾e boot disk je sd0 (ale pro IDE disky to bude
wd0, atd..):
</p>

<pre>
# <strong>cd /usr/mdec; ./installboot /boot biosboot sd0</strong>
</pre>

<p>
Pokud si installboot stì¾uje ¾e nemù¾e èíst geometrii BIOS, v boot&gt; promptu
mù¾ete zadat &quot;machine diskinfo&quot; (nebo krátce &quot;ma di&quot;) aby
se vytiskla po¾adovaná informace. Vyplòte hodnoty &quot;heads&quot; a
&quot;secs&quot; pomocí flagù -h a -s, repsektive modifikujte installboot
pøíkaz tak, aby vypadal následovnì:
</p>
<pre>
#<strong> cd /usr/mdec; ./installboot -h &lt;heads&gt; -s &lt;secs&gt; /boot biosboot sd0</strong>
</pre>

<p>
Pokud ne vy¾adovaná nová verze bootblockù, budete potøebovat zkompilovat tyto
sami. To udìláte jednodu¹e:
</p>

<pre>
# <strong>cd /sys/arch/i386/stand/</strong>
# <strong>make &amp;&amp; make install </strong>
# <strong>cd /usr/mdec; cp ./boot /boot</strong>
# <strong>./installboot /boot biosboot sd0</strong> (or whatever device your hard disk is)
</pre>

<p>
<a name="Backup"></a>
<h2>14.9 - Pøíprava na katastrofu: Zálohování a obnova z pásky.</h2>

<h3>Úvod:</h3>

<p>
Pokud plánujete provozovat nìco co se dá nazvat produkèní server, je rozumné
mít nìjakou formu zálohování v pøípadì, ¾e nìkterý z va¹ich pevných diskù
padne.
</p>

<p>
Tato informace vám pom¾e v pou¾ívání standartních utilit
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&sektion=8&format=html">dump(8)</a>/<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&sektion=8&format=html">restore(8)</a>
dodávaných s OpenBSD. Lep¹í utilita nazvaná "Amanda" lze pou¾ít pro více
serverù sdíljících jednu páskovou jednotku. V vìt¹inì prostøedí je kombinace
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=dump&sektion=8&format=html">dump(8)</a>/<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=restore&sektion=8&format=html">restore(8)</a>
dostaèující. Nicménì jestli¾e potøebujete zálohovat více strojù na jednu
pásku, mù¾e stát výzkum Amandy za to.
</p>

<p>
Pøíklady pro zaøízení v tomto dokumentu jsou pro konfiguraci která zahrnuje
SCSI disky a pásku. V produèním prostøedí jsou SCSI disky doporuèovány kvùli
zpùsobù jakým zacházejí se ¹patnými bloky. Tím nechceme øíci, ¾e tyto
informace budou zbyteèné v pøípadì ¾e pou¾íáte IDE disky, jenom se situace
bude mírnì li¹it. Napøíklad sd0a by bylo v IDE systému wd0a.
</p>

<h3>Zálohování na pásku:</h3>

<p>
Zálohování na pásku vy¾aduje znalost místa, kde jsou namontovány filesystémy.
To mù¾ete zjistit pomocí pøíkazu <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount&amp;sektion=8">mount(8)</a> v shellu. Mìli byste dostat výstup
podobný tomuto:
</p>

<pre>
# <b>mount</b>
/dev/sd0a on / type ffs (local)
/dev/sd0h on /usr type ffs (local)  
</pre>

<p>
V tomto pøíkladì je root (/) filesystem umístìn fyzicky na sd0a, co¾ indikuje
pevná disk SCSI 0, diskový oddíl a. Filesystém /usr je na sd0h, co¾ je pevný
disk SCSI 0, diskový oddíl h.
</p>

<p>
Dal¹í pøíklad více komplikované tabulky by mohl být:
</p>

<pre>
# <b>mount</b>
/dev/sd0a on / type ffs (local)
/dev/sd0d on /var type ffs (local)
/dev/sd0e on /home type ffs (local)
/dev/sd0h on /usr type ffs (local)  
</pre>

<p>
V tomto komplikovanìjèím pøíkladì je  root (/) filesystem fyzicky na sd0a.
Filesystém /var je na sd0d, /home je na sd0e a koneènì /usr je na sd0h.
</p>

<p>
Abyste zálohovali vá¹ stroj budete potøebovat dodat dumpu jméno ka¾dého
pevného diskového oddílu. Zde je pøíklad pøíkazù potøebných pro jednodu¹¹í
mount tabulku uvedenou vý¹e:
</p>

<pre>
# <b>/sbin/dump -0au -f /dev/nrst0 /dev/rsd0a</b>
# <b>/sbin/dump -0au -f /dev/nrst0 /dev/rsd0h</b>
# <b>mt -f /dev/rst0 rewind  </b>
</pre>

<p>
Pro slo¾itìj¹í tabulku, byste pou¾ili n¹co jako:
</p>

<pre>
# <b>/sbin/dump -0au -f /dev/nrst0 /dev/rsd0a</b>
# <b>/sbin/dump -0au -f /dev/nrst0 /dev/rsd0d</b>
# <b>/sbin/dump -0au -f /dev/nrst0 /dev/rsd0e</b>
# <b>/sbin/dump -0au -f /dev/nrst0 /dev/rsd0h  </b>
# <b>mt -f /dev/rst0 rewind  </b>
</pre>

<p>
Mù¾ete si pøeèíst manuálovou stránku abyste se dozvìdìli co pøesnì dìlá který
pøepínaè. Zde je krátký popis parametrù popsaných vý¹e:
</p>

<ul>
<li><b>0</b> - Provede dump úrovnì 0, na v¹echno
<li><b>a</b> - Pokusí se automaticky zjistit délku páskového media
<li><b>u</b> - Updatne soubor /etc/dumpdates, který slou¾í k indikaci data
poslední zálohy
<li><b>f</b> - Které páskové zaøízení se má pou¾ít (v tomto pøípadì /dev/nrst0)
</ul>

<p>
Nakonec který¾ diskový oddíl chcete zálohovat (/dev/rsd0a, atd.)
</p>

<p>
Pøíkaz mt je pou¾it k pøetoèení pásky. Pøeètìte si manuálovou stránku abyste
se dozvìdìli více options. (jako napø. eject).
</p>

<p>
Pokud si nejste jistí jménem páskového zaøízení, pou¾ijte dmesg k tomu, abyste
jej lokalizovali. Pøíklad záznamu páskového zaøízení v dmesg by vypadal asi
takto:
</p>

<pre>
st0 at scsibus0 targ 5 lun 0: &lt;ARCHIVE, Python 28388-XXX, 5.28&gt;
</pre>

<p>
Mo¾ná jste zaznamenali, ¾e kdy¾ zálohujete je k páskovému zaøízení 
pøistupováno jako k "nrst0" namísto "st0", co¾ je jméno které je uvedeno v
dmesg. Kdy¾ pøistupujete k st0 jako k nrst0, pøistupujete k tomu samému
fyzickému zaøízení, ale øíkáte tím, aby se jednotka nepøevinula a¾ dojde na
konec a aby se k ní pøistupovalo v raw modu. Abyste zálohovali více systémù na
jednu pásku, ujistìte se, ¾e pou¾íváte non-rewind zaøízení, proto¾e kdybyste
pou¾ili rewind zaøízení (rst0) na zálohování více systémù, dopadlo by to tak,
¾e byste si pøepsali filesystém s dal¹ím dumpem na pásku. Pøíslu¹ný popis
rùzných rozhraní k páskovým zaøízením mù¾ete najít v manuálové stránce dumpu. 
</p>

<p>
Pkud jste chtìli napsat malý skript nazvaný "backup", mohl by vypadat nìjak
takto:
</p>

<pre>
echo "  Startuji Plnou Zálohu..."
/sbin/dump -0au -f /dev/nrst0 /dev/rsd0a
/sbin/dump -0au -f /dev/nrst0 /dev/rsd0d
/sbin/dump -0au -f /dev/nrst0 /dev/rsd0e
/sbin/dump -0au -f /dev/nrst0 /dev/rsd0h
echo
echo -n "  Pøetáèím pásku, èekejte prosím..."
mt -f /dev/rst0 rewind
echo "Hotovo."
echo                      
</pre>

<p>
Pokud po¾adujete zálohy ka¾dou noc, pou¾ijte 
<a
href="http://www.openbsd.org/cgi-bin/man.cgi?query=cron&sektion=8&format=html">cron(8)</a>
pro automatický start zálohovacího skriptu.
</p>

<p>
Dále vám mù¾e pomoci napsat si (na kus papíru) jak velké by mìly být
jednotlivé filesystémy. Mù¾ete pou¾ít df -h na zji¹tìní kolik místa zabírají
jednotlivé dikoé oddíly. To bude u¾iteèné kdy¾ disk spadne a vy budete
potøebovat znovuvytvoøit tabulku diskových oddílù na novém disku.
</p>

<p>
Znovuobnovení va¹ich dat vám pomù¾e zmen¹it fragmentaci. Abyste se ujistili,
¾e dostanete v¹echny soubory, nejlep¹í zpùsob jak zálohovat je rebootovat vás
sytem v single módu. File systémy nepotøebují být namontovány k tomu aby mohly
být zálohovány. Nezapomeòte namontovat root (/) r/w po rebootu v single modu
nebo vá¹ dump spadne kdy¾ se bude pokou¹et zapsat data dumpu. Napi¹te bsd -s v
boot&gt; promptu abyste se dostali do single modu. 
</p>

<h3>Prohlí¾ení obsahu pásky:</h3>


<p>
Poté co jste zálohovali va¹e filesystémy poprvé, byl by dobrý nápad otestovat
va¹i pásku a ujistit se, ¾e na ní jsou data ve stavu v jakém jste oèekávali.
</p>

<p>
Mù¾ete pou¾ít následující pøíklad k tomu abyste si prohlédli seznam souborù na
pásce:
</p>

<pre>
# <b>/sbin/restore -tvs 1 -f /dev/rst0</b>
</pre>

<p>
To vylistuje seznam souborù které jsou na prvním diskovém oddílu pásky. S
informacemi uvedenými vý¹e mù¾eme øíct, ¾e 1 bude vá¹ root (/) file system.
</p>

<p>
Abyste si prohlédli co je ulo¾eno na druhém diskovém oddílu, pøesmìrujte
výstup do souboru, pou¾ijte nìco jako:
</p>

<pre>
# <b>/sbin/restore -tvs 2 -f /dev/rst0 > /home/me/list.txt</b>
</pre>

<p>
Pokud máte mount tabulku podobnou té v jednodu¹¹ím pøíkladu, 2ka by byla /usr,
pokud je va¹e slo¾itìj¹í, tak 2ka by mohla být /var nebo jiný fs. Sekvenèní
èílo se shoduje s poøadím vkterém jsou file systémy azapisovány na pásku.  
</p>


<h3>Obnova z pásky:</h3>

<p>
Pøíklad scénáøe vypsaného dále by mohl být u¾iteèný pokud vám spadl disk
kompletnì. V pøípadì ¾e budete chtít obnovit pouze jeden soubor, podívejte se
na manuálovou stránku a vìnujte pozor instrukcím pro interaktvní mod. 
</p>

<p>
Pokud jste se poøádnì pøipravili, výmìna disku a obnova dat bude velmi rychlý
proces. Standartní instalèní/bootovací disketa s OpenBSD u¾ obsahuje
po¾adovanou utilitu restore stejnì jako binárky nutné k tomu abyste udìlali
nový disk bootovatelný. Ve vìt¹ine pøípadù jsou tato disketa a páska se
zálohou v¹e co potøebujete abyste obnovili data a znovu se rozjeli.
</p>

<p>
Jakmile jste fyzicky vymìnili disk, základní kroky jak obnovit va¹e data by
byly:
</p>

<ul>
<li>
<p>
Nabootujte OpenBSD instalaèní/bootovací disketu. V selekci menu zvolte Shell.
Ochraòte disketu proti zápisu a vlo¾te va¹i poslední pásku se zálohou do
jednotky.
<br>
</p>

<li>
<p>
Pou¾ijte pøíkaz
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=fdisk&sektion=8&arch=i386&format=html">fdisk(8)</a>
vytvoøte priární diskovou oblast pro OpenBSD na tomto novì nainstalovaném
disku. Pøíklad:
</p>

<pre>
# <b>fdisk -e sd0</b>
</pre>

<p>
Více informací je v <a href="#14.2">fdisk FAQ</a>.
</p>

<li>
<p>  
Pou¾ijte pøíkaz disklabel, vytvoøte znovu tabulku va¹ch diskových oddílù pro
OpenBSD, kterou jste právì vytvoøili fdiskem. Pøíklad:
</p>

<pre>
# <b>disklabel -E sd0</b>
</pre>

<p>
(Nezapomeòte na swap, pøeètìte si <a href="#14.1">disklabel FAQ</a>)
</p>

<li>
<p>
Pu¾ijte pøíkaz newfs pro vytvoøení èistého filesystémy na ka¾dém diskovém
oddílu který jste vytvoøili v pøedchozím kroku. Pøíklad:
</p>

<pre>
# <b>newfs /dev/rsd0a</b>
# <b>newfs /dev/rsd0h</b>
</pre>

<li>
<p>
Namontujte vá¹ novì pøipravený root (/) file system do /mnt. Pøíklad:
</p>

<pre>
# <b>mount /dev/sd0a /mnt</b>
</pre>

<li>
<p>

Pøesuòte se do toho namontovaného file systemu a zaènìte restore proces.
Pøíklad:
</p>

<pre>
# <b>cd /mnt</b>
# <b>restore -rs 1 -f /dev/rst0</b>
</pre>

<li>
<p>
Budete chtít aby vás disk byl bootovatelný, pou¾ijte následující k tomu,
abyste zapsali nový MBR na disk. Pøíklad:
</p>

<pre>
# <b>fdisk -i sd0</b>
</pre>

<li>
<p>
Dále budete potøebovat instalovat nové boot bloky k tomu, abyste mohli z
tohoto MBR nabootovat. Následující krátký pøíklad to provede:
</p>

<pre>
# <b>cp /usr/mdec/boot /mnt/boot</b>
# <b>/usr/mdec/installboot -v /mnt/boot /usr/mdec/biosboot sd0</b>
</pre>

<li>
<p>
Vá¹ nový root file system na pevném disku by mìl být dostateènì pøipraven na
to, abyste z nìj mohli nabootovat a pokraèovat v obnovì zbytku va¹ich file
systémù. Proto¾e operaèní systém není je¹tì kompletní, ujistìte se, ¾e zpátky
nabootujete v single módu. V promto zadejte následující pøíkazy k tomu abyste
odmontovali a haltovali systém:
</p>

<pre>
# <b>umount /mnt</b>
# <b>halt</b>
</pre>

<li>
<p>
Vyndejte instalaèní/bootovací disketu z drajvu a rebootujte vás systém. V
boot&gt; promptu OpenBSD zadejte následující pøíkaz:
</p>

<pre>
boot&gt; <b>bsd -s</b>
</pre>

<p>
bsd -s nastartuje systém v single módu, co¾ vy¾aduje pouze root (/) file
system.
</p>

<li>
<p>
Pøedpokládejme, ¾e jste provedli v¹echny kroky uvedené vý¹e správnì a nestalo
se nic ¹patnì, tj. ¾e jste dostali prompt s tím abyste zadali cestu k shellu a
zadali return. Zadejte return a dostanete se do shellu. Dále budete chtít
remountovat root v r/w modu, to udìláte následujícím pøíkazem:
</p>

<pre>
# <b>mount -u -w /</b>
</pre>

<li>
<p>
Jakmile jste remountovali v r/w módu, mù¾e pokraèovat s obnovou va¹ich
filesystémù. Pøíklad:
</p>

<pre>
(jednoduchá mount table)
# <b>mount /dev/sd0h /usr; cd /usr; restore -rs 2 -f /dev/rst0</b>

(slo¾itìj¹í mount table)
# <b>mount /dev/sd0d /var; cd /var; restore -rs 2 -f /dev/rst0</b>
# <b>mount /dev/sd0e /home; cd /home; restore -rs 3 -f /dev/rst0</b>
# <b>mount /dev/sd0h /usr; cd /usr; restore -rs 4 -f /dev/rst0</b>
</pre>

<p>
mohli byste pou¾ít "<b>restore rvsf</b>" namísto pouhého rsf k tomu, abyste
vidìli obnovování objektù z dumpu. 
</p>

<li>
<p>
Nakonec poté co jste dokonèili obnovu v¹ech filesystémù na disk, rebotojte do
multiuser módu. Pokud ¹lo v¹echno tak jak jste plánovali, bude vá¹ systém
zpátky ve stavu v jakém byla provedena poslední záloha a bude pøipraven k
dal¹ímu pou¾ití.
</p>
</ul>

<a name="MountImage"></a>
<h2>14.10 - Mountování disk images v OpenBSD</h2>

<p>
Abyste namontovali v OpenBSD disk image (ISO images, diskové images vytvoøené pomocí dd,
atd.) musíte konfigurovat zaøízení
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vnd&sektion=4">vnd(4)</a>
Na pøíklad pokud máte ISO image v <i>/tmp/ISO.image</i>, následující kroky vám
tento image namontují.
</p>

<table border=0 width="650">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<pre>
# <strong>vnconfig svnd0 /tmp/ISO.image</strong>
# <strong>mount -t cd9660 /dev/svnd0c /mnt</strong>
</pre>
                </td>
        </tr>
</table>

<p>
V¹imnìte si, ¾e toto je CD image, tak¾e pøi montování musíte specifikovat typ
<i>cd9660</i>. To platí nezávisle na typu, napøíklad musíte zadat typ ffs
pokud montujete diskové images.
</p>

<p>
K tomu abyste odmontovali image, pou¾ijte následující príkazy:
</p>

<table border=0 width="800">
        <tr>
                <td nowrap bgcolor="#EEEEEE">
<pre>
# <strong>umount /mnt</strong>
# <strong>vnconfig -u svnd0</strong>
</pre>
                </td>
        </tr>
</table>

<p>
Více informací naleznete v manuálové stránce
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=vnconfig&amp;sektion=8">vnconfig(8)</a> man page.
</p>


<a name="pciideErr"></a>
<h2>14.11 - Pomoc! Dostávám chyby s PCIIDE!</h2>

<p>
PCI IDE DMA je nespolehlivá s mnoha kombinacemi hardware. Je¹tì donedávna
se vìt¹ina "mainstreamových" operaèních systémù, které tvrdily, ¾e podporují
DMA transfery na IDE discích nedodávala s touto vlastností defaultnì
zapnutou.
</p>

<p>
OpenBSD je agresivní a poukou¹í se pou¾ít nejvy¹¹í DMA mód, který mù¾e konfigurovat.
Tímto ale dochází k naru¹ení pøenosù dat u nìkterých nastavení, kvùli chybovému chipsetu
zakládní desky, chybovým driverùm a/nebo ¹umu na kabelu. Na¹tìstí Ultra-DMA mód pøidává k
datùm CRC pro detekci tìchto naru¹ení. Pokud Ultra-DMA CRC je chybná, OpenBSD vypí¹e chybovou
hlá¹ku a zkou¹í transfer provést je¹tì jednou.
</p>

<pre>
wd2a:  aborted command, interface CRC error reading fsbn 64 of 64-79 (wd2 bn 127; cn 0 tn 2 sn 1), retrying
</pre>

<p>
Po nìkolikerém selhání  OpenBSD sní¾í konfiguraci na pomalej¹í (doufejme, ¾e spolehlivìj¹í) Ultra-DMA mód.
Pokud je dosa¾eno Ultra-DMA módu 0, øadiè disku downgraduje na PIO mód.
</p>

<p>
Pokud va¹e OpenBSD úspì¹nì nedowngraduje konfiguraci pøenosového módu nebo tento proces zpùsobí, ¾e stroj
natvrdo zatuhne, napi¹te prosím <a href="../../cs/report.html">zprávu o chybì</a>.
</p>

a name= "IDEDMA"></a>
<h2>14.12 - Jak pøikázat DMA pøístup pro IDE disky</h2>

<p>
Kódu realizující obsluhu zaøízení PCI IDE v jádøe nemusí znát chipset
va¹eho øadièe. Pokud se tak stane, dostanete pøi startu zprávu jako:

<blockquote>
<pre>
pciide0: DMA, (unused)
</pre>
</blockquote>

Pokud jste ten pøípad, mù¾ete se pokusit je¹tì stále DMA zprovoznit.
Provedete to tak, ¾e ve va¹em konfiguraèním souboru jádra pøidáte
k záznamu patøícímu pciide øadièi volbu 'flags 0x0001'. Daná øádka 
v konfiguraèním souboru jádra pak bude vypada napø. takto:

<blockquote>
<pre>
pciide* at pci ? dev ? function ? flags 0x0001
</pre>
</blockquote>

S touto úpravou zkusí pciide kód v jádøe pou¾ít DMA mód bez ohledu na to,
jestli ví, jak to udìlat u va¹eho chipsetu. Pokud se mu to podaøí úspì¹nì
a vá¹ systém projde pøes fsck a startovací rc skripty, je velmi pravdìpodobné,
¾e to bude fungovat trvale. Pokud tento zpùsob nefunguje a systém
vytuhne nebo po nastartování skonèí na kernel panic, pak nemù¾ete
pou¾ít DMA mód (alespoò do té doby, ne¾ je pøidána podpora pro vá¹ chipset).
Poznamenjme jen, ¾e pokud nìkde najdete dokumentaci k va¹emu chipsetu
PCI-IDE øadièe, pak jste na dobré cestì, aby vá¹ chipset byl zcela
podporován pod OpenBSD. Mù¾ete zkusit hledat tøeba na webové stránce
výrobce nebo mu zavolat. Pokud vá¹ PCI-IDE øadièe je souèástí základní
desky, zjistìte výrobce chipsetu a od nìho dokumentaci.

<p>
To, ¾e DMA podpora u va¹eho hardware byla pod OpenBSD zapnuta zjistíte
pohledem na dmesg, konkrétnì nìco jako:

<blockquote>
<pre>
cd0(pciide0:1:0): using PIO mode 3, DMA mode 1
</pre>
</blockquote>

Vý¹e uvedené znamená, ¾e øadiè pciide0, kanál 1, zaøízení 0 (které se
jeví jako ATAPI CD-ROM) pou¾ívá DMA data transfery.

<a name= "RAID"></a>
<h2>14.13 - Mo¾nosti RAID v OpenBSD</h2>
RAID (Redundant Array of Inexpensive Disks) dává mo¾nost pou¾ití
nìkolika diskù abyste dosáhli vy¹¹ího výkonu, kapacity a/nebo
redundance ne¾ kolik mù¾ete získat z nìkolika diskù samotných.
Aèkoliv je úplná diskuse nad výhodami a risky RAID mimo obsah
tohoto èlánku, je nìkolik bodù, které jsou dùle¾ité:
<ul>
<li>RAID nemá co dìlat se zálohováním.</li>
<li>Sám o sobì RAID neeliminuje down-time.</li>
</ul>
Pokud je to pro vás nová informace, pak to není dobrý poèáteèní
bod pro zkoumání RAIDu.

<h3>Softwarové mo¾nosti</h3>
OpenBSD obsahuje RADIframe, softwarové øe¹ení RAIDu. Dokumentace
pro nìj mù¾ete nalézt na následujících místech:
<ul>
<li><a href="faq11.html#raid">FAQ 11, RAID</a>
<li><a href="http://www.pdl.cmu.edu/RAIDframe/">RAIDframe Homepage</a></li>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=raidctl&amp;sektion=8">man page for raidctl(8)</a></li>
<li><a href="http://www.openbsd.org/cgi-bin/man.cgi?query=raid&amp;sektion=4">man page for raid(4)</a></li>
</ul>
<p>
V souèasné dobì nemù¾e být root parti¹na mirrorovaná pomocí
RAIDframe na OpenBSD, to se ale zmìní s dal¹í release OpenBSD.
Poèínaje OpenBSD 3.1 mù¾e být root parti¹na pøímo mirrorována na
OpenBSD pou¾itím op¹ny "Autoconfiguration" v RAIDframe. Pøedchozí
vydání OpenBSD nemohly mít root parti¹nu takto mirrorovanou.
</p>

<h3>Hardwarová øe¹ení</h3>
<p>
Mnoho OpenBSD <a href="../../cs/plat.html">platforem</a> zahrnuje
podporu pro rùzné RAID produkty. Tyto se li¹í od platformy,
podívejte se na pøíslu¹nou stránku (<a href="../../cs/plat.html">zde</a>).
</p>
<p>
Dal¹í mo¾nost, která je dostupná pro mnoho platforem je jeden z
mnoha produktù, které zpøístupòují nìkolik diskù, tak ¾e se celek
chová jako jeden IDE nebo SCSI adaptér. Tyto zaøízení mohou
pracovat na skoro jakékoliv platformì, která podporuje IDE nebo
SCSI. 
</p>
Nìkteøí výrobci tìchto produktù:
<ul>
<li><a href="http://www.arcoide.com/">Arco</a></li>
<li><a href="http://www.maxtronic.com/">Maxtronic</a></li>
<li><a href="http://www.infortrend.com/">Infortrend</a></li>
</ul>
(Poznámka: tyto jsou pouze produkty, které pou¾ívají nìkteøí
u¾ivatelé OpenBSD -- toto není úplný seznam.)


<h3>Ne-mo¾nosti</h3>
<p>
Èasto jsou kladenou otázkou na <a href="../../cs/mail.html">mailing
listech</a> je "Je podporován Promise nebo HighPoint IDE RAID
kontrolér ?". Odpovìï je "Ne". Tyto karty a èipy nejsou opravdové
RAID kontroléry, ale BIOS asistované bootvání softwrového RAIDu.
Proto¾e OpenBSD u¾ podporuje softwarový RAID v hardware nezávislým
zpùsobem, není pøíli¹ ochoty mezi OpenBSD developery implementovat
speciální podporu pro tyto karty.
</p>
<p>
<font color= "#0000e0">
<a href= "index.html">[Zpìt na Hlavní Index]</a>
<a href= "faq13.html">[Na Sekci 13.0 - IPsec]</a>
</font>
</p>

<hr>
<p>
<a href= "index.html"><img height= "24" width= "24" src= "../../images/back.gif" border= "0" alt="[zpìt]"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<small>
<br>
Originally [OpenBSD: faq14.html,v 1.71 ]
<br>
$Translation: faq14.html,v 1.16 2003/10/29 08:13:12 certik Exp $
<br>
$OpenBSD: faq14.html,v 1.16 2003/10/30 18:00:22 horacio Exp $
</small>

</body>
</html>
