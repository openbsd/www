<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD AnonCVS</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1">
<meta name="description" content="How to get OpenBSD updates via Internet using Anonymous CVS">
<meta name="keywords" content="openbsd,anoncvs,updates">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1996-2004 by OpenBSD.">
</head>

<body bgcolor="#ffffff" text="#000000" link="#23238e">

<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="../images/smalltitle.gif" border="0"></a>
<p>
<h2><font color="#e00000">CVS Anonyme</font></h2>

<h3>Table des matières</h3>

<ul>
<li><a href="#anoncvs">Qu'est ce que le CVS Anonyme ?</a>
<li><a href="#CVS">Qu'est ce que CVS ?</a>
<li><a href="#starting">Débuter avec le CVS Anonyme</a>
<li><a href="#using">Utiliser CVS(1) pour obtenir et mettre à
    jour les sources</a>
<li><a href="#CVSROOT">Serveurs CVS Anonymes disponibles</a>
<li><a href="#CRYPTO">Obtenir les sources de la crypto par CVS(1)</a>
<li><a href="#EXAMPLE">Exemples d'usages de CVS(1)</a>
<li><a href="#WHICH">Utiliser rsh(1) ou ssh(1) ?</a>
<li><a href="#SUP">Faire un miroir du CVS avec sup(1)</a>
<li><a href="#MIRROR">Mettre en place un miroir anoncvs</a>
</ul>

<hr>

<h3><a name="anoncvs"><font color="#0000e0">Qu'est ce que le CVS Anonyme
    ?</font></a></h3>

<p>
Le CVS Anonyme est une méthode qui permet de garder à jour
votre copie locale des sources d'OpenBSD. En plus de suivre les
dernières nouveautés du développement, il est aussi
possible de suivre les correctifs et les errata d'une version.
</p>

<p>
L'avantage majeur du CVS Anonyme sur les autres techniques de mise
à jour est que cela fonctionne directement à partir d'un
serveur central où réside le code source ou d'un miroir.
Cela vous permet d'avoir accès à toutes les commandes de
CVS pour intégrer et mettre à jour vos changements avec
d'autres changements dans les sources, d'effectuer des diffs, de voir
l'historique des changements et plein d'autres types de requêtes.
</p>

<p>
Le projet OpenBSD a actuellement cinq branches principales :
</p>

<ul>
  <li><b>src</b> - Contient tout le code source pour le système
         d'exploitation OpenBSD.
  <li><b>ports</b> - Contient les <a href="ports.html">ports
         OpenBSD</a>.
  <li><b>www</b> - Contient les pages web OpenBSD. (dont celle-ci).
  <li><b>X11</b> - Contient l'adaptation OpenBSD du logiciel
      <a href="http://www.XFree86.org/">XFree86-3</a>.
  <li><b>XF4</b> - Contient l'adaptation OpenBSD du logiciel 
      <a href="http://www.XFree86.org/">XFree86-4</a>.
</ul>

<p>
Pour résumer, la force du CVS Anonyme est que c'est un
système de contrôle du code source "tolérant". Il
<strong>respecte</strong> les changements que vous avez effectués
dans vos sources et fait les <strong>"meilleurs efforts"</strong> pour
mettre à jour votre arborescence des sources, plutôt que de
vous faire une liste de problèmes ésotériques
à résoudre avant de pouvoir continuer.
</p>

<h3><a name="CVS"><font color="#0000e0">Qu'est ce que CVS ?
    </font></a></h3>

<p>
<a href="why-cvs.html">
CVS est le système de contrôle du code source
utilisé pour gérer les sources d'OpenBSD.</a> Il met en
oeuvre un "dépôt" central pour tout le source
officiellement disponible tout en permettant aux développeurs de
maintenir des copies locales du code source avec leurs changements
personnels. Les développeurs avec un "<b>accès en
écriture</b>" peuvent soumettre des changements directement dans
les sources d'OpenBSD, tandis que les utilisateurs du CVS Anonyme ont un
"<b>accès en lecture</b>" et peuvent garder leurs copies des
sources à jour et émettre des requêtes vers le
serveur.
</p>

<p>
La grande force de CVS est sa capacité à effectuer une
intégration intelligente des changements venant du serveur
central contenant les sources avec les changements que vous avez
effectués dans votre copie locale. Cela signifie que si vous
faites des changements à un module et que vous effectuez une mise
à jour, vos changements ne seront pas détruits. CVS fait
en sorte d'intégrer les changements dans les sources avec les
changements que vous avez effectués.
</p>

<p>
Au cas où les changements ne peuvent pas être
complètement intégrés, CVS fournit une "chute en
douceur", dans le sens qu'il vous fournit des changements annotés
à votre copie locale en préservant celle-ci et continue de
mettre à jour les autres sources comme demandé.
</p>

<h3><a name="starting"><font color="#0000e0">Débuter avec le CVS
    Anonyme </font></a></h3>

<p>
La dernière version de CVS est disponible chez
<a href="http://www.cvshome.org/">Cyclic</a>. Les versions plus
anciennes que 1.6 ne sont pas recommandées et pourraient ne pas
fonctionner. Si vous avez déjà OpenBSD d'installé,
CVS est inclus.
</p>

<p>
Les personnes qui possèdent un CD d'OpenBSD y ont sans doute vu
des répertoires <i>CVS/</i>. La raison est que sur le CD se
trouve une version du module <b>src</b> d'OpenBSD utilisable pour faire
des mises à jour depuis un serveur CVS Anonyme. Utiliser cette
arborescence est beaucoup plus rapide que de récupérer
complètement les sources d'OpenBSD. Il y a deux manières
d'utiliser le CD :
</p>

<ul>
<li>Pour copier l'arborescence CVS depuis le CD vers <i>/usr/src</i> (en
    supposant que le CD est monté sur /mnt):
<pre>
        # <b>cd /mnt; pax -rw CVS Makefile [a-z]* /usr/src</b>
</pre>
<li>Utiliser un "union mount" (voir
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=mount_union&amp;apropos=0&amp;sektion=8&amp;manpath=OpenBSD+Current&amp;format=html">mount_union(8)</a>)
avec le CD monté dans un répertoire autorisé en
écriture. (Ne peut être utilisé que si vous compilez
depuis l'arborescence des sources)
<pre>
        # <b>mount -t union -o -b /mnt /usr/src</b>
</pre>
</ul>

<p>
Pour ceux qui n'ont pas de CD sous la main, vous pouvez utiliser
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a>
pour récupérer les sources. C'est décrit dans la
<a href="#using">section suivante</a>.
</p>

<p>
Après ça, <i>/usr/src</i> sera un répertoire
où les commandes
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1&amp;format=html">cvs(1)</a>
fonctionneront correctement.
</p>

<h3><a name="using"><font color="#0000e0">Utiliser CVS pour
    récupérer et mettre à jour son arbre
    source</font></a></h3>

<p>
CVS a été mis au point dans le but d'être un moyen
simple de récupérer et de mettre à jour vos
sources. Vous devez tout d'abord décider si vous voulez suivre la
branche <i>current</i> ou une branche de correctifs (patch).
L'arborescence current possède tous les derniers changements et
la branche correctifs contient une version d'OpenBSD avec tous les
correctifs de l'<a href="errata.html">errata</a> appliqués. Pour
une définition de <i>current</i>, se reporter à la
<a href="../faq/upgrade-minifaq.html#1.1">mini foire aux questions sur la mise à jour</a>.

<p>
Une fois que vous avez décidé quelle est la branche que
vous voulez suivre, vous devez sélectionner le serveur de CVS
Anonyme que vous allez utiliser. Une liste de ces serveurs est
disponible <a href="#CVSROOT">ci-dessous</a>. Remarquez tout de
même qu'il existe trois possibilités pour accéder
à ces serveurs.
</p>

<dl>
<dt><b>ssh</b> - Secure Shell peut être utilisé pour
       accéder aux serveurs de CVS Anonymes. C'est la
       manière <em>recommandée</em> de faire les choses,
       à cause du chiffrement. Depuis OpenBSD 2.6, OpenSSH est
       inclus dans la distribution standard.
<dt><b>rsh</b> - Remote Shell peut être utilisé avec
       certains serveurs pour les utilisateurs qui n'ont pas
       accès à <a href="http://www.openssh.com">ssh</a>
<dt><b>pserver</b> - pserver est avant tout utile pour les utilisateurs
       qui se trouvent derrière des pares-feu qui bloqueraient
       les deux autres types de connexion.
</dl>

<p>
<b>REMARQUE :</b> Pour les utilisateurs qui souhaitent utiliser rsh, il
   faut d'abord définir la variable <var>CVS_RSH</var> à
   rsh.

<ul>
<li> Pour les shells Korn/Bourne :
<pre>
        $ <b>export CVS_RSH=/usr/bin/rsh</b>
</pre>
<li> Pour les shells csh/tcsh : 
<pre>
        % <b>setenv CVS_RSH /usr/bin/rsh</b>
</pre>
</ul>

<p>
Une fois que vous avez choisi le <a href="#CVSROOT">serveur de CVS
Anonyme</a> que vous allez utiliser, et quelle méthode vous allez
utiliser, vous pouvez démarrer. Pour ceux qui aurait le CD, vous
pouvez démarrer avec la version du CVS qui se trouve sur le CD
avec les méthodes décrites
<a href="#starting">ci-dessus</a> pour installer les sources sur votre
système. Si vous n'avez pas le CD sous la main, utilisez la
méthode ci-dessous pour récupérer les sources.
Cette méthode place l'arborescence des sources d'OpenBSD dans
<i>/usr/src</i>.
</p>

<pre>
        # <b>cd /usr; cvs checkout -P src</b>
</pre>

<p>
La méthode ci-dessus va récupérer (checkout)
l'arborescence <i>current</i> des sources. Beaucoup d'entre vous
désirerons sûrement la branche correctifs (patch) des
sources. Pour récupérer une branche patch, vous devez le
spécifier avec votre commande (tag). Exemple :
</p>

<pre>
        # <b>cd /usr; cvs checkout -P -rOPENBSD_3_6 src</b>
</pre>
<p>
Ou OPENBSD_3_5 pour 3.5, etc... 
<p>
Actuellement, seul le tag OPENBSD_3_6 contient les sources et les
erratas sur les sources déjà appliqués.

<h3><a name="CVSROOT"><font color="#0000e0">Serveurs CVS Anonymes
    disponibles</font></a></h3>

<p>
Il existe deux niveaux d'accès à l'arborescence des
sources :

<dl>
<dt><strong>Accès en lecture-écriture pour les
    développeurs :</strong>
<dd>Les développeurs qui ont besoin de soumettre des changements
    à l'arborescence des sources doivent avoir un compte sur les
    machines OpenBSD. Obtenir cet accès sera le résultat
    tout naturel du travail effectué sur les sources avec
    d'autres développeurs OpenBSD. Si quelqu'un fait du bon
    travail et montre qu'il peut travailler avec l'équipe, il
    obtiendra un compte.
</dl>

<dl>
<dt><strong>Accès en lecture seule pour tout le monde :</strong>
<dd>N'importe qui peut accéder au CVS en lecture seule. Ces
    copies du CVS en lecture-écriture sont
    réalisées relativement souvent. Pour en utiliser un,
    il vous faudra définir votre variable d'environnement
    <var>CVSROOT</var> avec l'une des valeurs suivantes :
<p>
<em>Voyez la remarque ci-dessous en ce qui concerne l'utilisation de
<a href=#WHICH">ssh ou rsh !</a></em>
<p>
<ul>
<li><strong>CVSROOT=anoncvs@anoncvs.usa.openbsd.org:/cvs</strong><br>,
<strong>anoncvs@anoncvs4.usa.openbsd.org</strong>.<br>
Situé à Redwood City, Californie, ouest des USA.<br>
Maintenu par <a href="mailto:millert@openbsd.org">Todd Miller</a>.<br>
Protocoles : rsh, ssh, ssh port 2022, pserver.<br>
Mis à jour toutes les 2 heures.<br>
Empreintes SSH :<br>
(RSA1) 1024 64:de:26:16:c2:ff:1b:c7:24:ed:a4:4a:d7:2f:69:3e<br>
(RSA) 1024 49:67:9a:46:62:8a:3f:4e:b3:63:ca:d6:41:29:2a:2f<br>
(DSA) 1024 a7:75:49:77:f3:47:d1:3c:5e:65:84:84:3b:03:f1:33<br>
<p> 
<li><strong>CVSROOT=anoncvs@anoncvs2.usa.openbsd.org:/cvs</strong><br>
Connu aussi sous le nom de <strong>repository.citi.umich.edu</strong>.<br>
Situé à l'Université du Michigan, centre des USA.<br>
Maintenu par <a href="mailto:rees@umich.edu">Jim Rees</a>.<br>
Protocoles : ssh, ssh port 2022.<br>
Mis à jour toutes les 12 heures.<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs3.usa.openbsd.org:/cvs</strong><br>
Situé au National Center for Atmospheric Research, Boulder, ouest des
USA.<br>
Maintenu par <a href="mailto:millert@openbsd.org">Todd Miller</a>.<br>
Protocoles : rsh, ssh, ssh port 2022, pserver.<br>
Mis à jour toutes les 2 heures.<br>
Empreintes SSH :<br>
(RSA1) 1024 34:95:19:c2:b3:e7:61:7b:39:e8:ab:86:37:cd:c4:49<br>
(RSA) 1024 42:56:39:98:65:05:e7:2a:98:2b:ee:cc:e5:a3:53:ed<br>
(DSA) 1024 e3:e7:83:ef:f6:78:dc:d3:ca:a5:cf:64:c6:b7:4f:43<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs1.ca.openbsd.org:/cvs</strong><br>
Connu aussi sous le nom de <strong>anoncvs.ca.openbsd.org</strong>,
<strong>openbsd.sunsite.ualberta.ca</strong><br> Situé
à Edmonton, Alberta, Canada.<br>
Maintenu par <a href="mailto:beck@ualberta.ca">Bob Beck</a>.<br>
Protocoles : ssh, rsh, ssh port 2022, pserver<br>
Mis à jour toutes les 2 heures.<br>
<p> 
<li><strong>CVSROOT=anoncvs@anoncvs.no.openbsd.org:/cvs</strong><br>
Connu aussi sous le nom de <strong>cvs.inet.no</strong>.<br>
Situé en Norvège<br>
Maintenu par <a href="mailto:cvsadmin@inet.no">Michael Shuldman</a>.<br>
Protocoles : rsh, ssh, ssh port 2022.<br>
Mis à jour toutes les 4 heures.<br>
<p> 
<li><strong>CVSROOT=anoncvs@anoncvs.at.openbsd.org:/cvs</strong><br>
Connu aussi sous le nom de <strong>togetic.kd85.com</strong>.<br>
Situé en Autriche.<br>
Maintenu par <a href="mailto:wim@kd85.com">Wim Vandeputte</a>.<br>
Protocoles : rsh, ssh, ssh port 2022.<br>
Mis à jour toutes les 3 heures.<br>
<p> 
<li><strong>CVSROOT=anoncvs@anoncvs.nl.openbsd.org:/cvs</strong><br>
Situé à Amsterdam, aux Pays-Bas.<br>
Maintenu par
<a href="mailto:nick@calyx.net">Nick Merrill</a> et
<a href="mailto:alex@calyx.nl">Alexander Grendel</a>.<br>
Protocoles : ssh.<br>
Mis à jour toutes les 3 heures.<br>
<p> 
<li><strong>CVSROOT=anoncvs@anoncvs.jp.openbsd.org:/cvs</strong><br>
Connu aussi sous le nom de <strong>kankoromochi.econ.nagasaki-u.ac.jp</strong>.<br>
Situé à l'Université de Nagasaki, Faculté
d'Economie, Japon.<br>
Maintenu par <a href="mailto:sigh@net.nagasaki-u.ac.jp">SUZUKI Hitoshi</a>.<br>
Protocoles : ssh, pserver.<br>
Mis à jour toutes les 3 heures.<br>
<p> 
<li><strong>CVSROOT=anoncvs@anoncvs.de.openbsd.org:/cvs</strong><br>
Machine aussi connue comme <strong>grappa.unix-ag.uni-kl.de</strong>.<br>
Situé à l'université de Kaiserslautern,
Allemagne<br>
Maintenu par <a href="mailto:naddy@openbsd.org">Christian Weisgerber</a>.<br>
Protocoles : ssh, ssh port 2022, pserver<br>
Mis à jour toutes les 6 heures.<br>
Empreintes SSH :<br>
(RSA) 1024 cf:a9:ee:a4:60:5d:66:00:50:5b:fd:d3:72:04:14:a3<br>
(DSA) 1024 78:d4:19:da:df:6f:c0:14:7f:4a:55:2a:e9:82:5f:e4<br>
<!-- <p>
<li><strong>CVSROOT=anoncvs@anoncvs.pl.openbsd.org:/cvs</strong><br>
Connu aussi sous le nom de <strong>anoncvs1.pl.openbsd.org</strong>,
<strong>incredible.bmtmc.gda.pl</strong>.<br>
Situé à BMT Maritime Consultants, Gdansk, Pologne<br>
Maintenu par <a href="mailto:detergent@incredible.bmtmc.gda.pl">Adam
Naguszewski</a>.<br>
Protocoles : ssh, pserver<br>
Mis à jour toutes les 3 heures.<br> -->
<p> 
<li><strong>CVSROOT=anoncvs@rt.fm:/cvs</strong><br>
Situé à Lake in the Hills, Illinois, USA<br>
Maintenu par <a href="mailto:jcs@rt.fm"> Joshua Stein</a>.<br>
Protocoles : ssh<br>
Mis à jour toutes les 3 heures.<br>
Empreintes SSH :<br>
(RSA) 1024 cf:a9:ee:a4:60:5d:66:00:50:5b:fd:d3:72:04:14:a3<br>
(DSA) 1024 78:d4:19:da:df:6f:c0:14:7f:4a:55:2a:e9:82:5f:e4<br>
<p> 
<li><strong>CVSROOT=anoncvs@cvs.openbsd.cz:/cvs</strong><br>
Situé à Prague, République Tchèque<br>
Maintenu par <a href="mailto:vlada@openbsd.cz">Vladimir Kotal</a>.<br>
Protocoles : ssh, pserver.<br>
Mise à jour toutes les 4 heures.<br>
<!-- <p>
<li><strong>CVSROOT=anoncvs@anoncvs.openbsd.org.ua:/cvs</strong><br>
Situé à Kiev, Ukraine<br>
Maintenu par <a href="mailto:hunter@dg.net.ua">Sergey Smitienko</a>.<br>
Protocoles : ssh<br>
Mise à jour toutes les 6 heures.<br> -->
<!-- <p>
<li><strong>CVSROOT=openbsd@openbsd.bug.it:/cvs</strong><br>
Situé à Modène, Italie<br>
Maintenu par <a href="mailto:jwk@bug.it">Giacomo Cariello</a>.<br>
Protocoles : ssh, password "openbsd"<br>
Mise à jour toutes les 6 heures.<br> -->
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.openbsd.lt:/cvs</strong><br>
Situé à TVK, Cable TV and Internet Services, Lituanie.<br>
Maintenu par  <a href="mailto:helpas@ebox.lt">Donatas Budvytis</a>.<br>
Protocoles : ssh<br>
Mise à jour toutes les 3 heures à partir de
cvsup.no.openbsd.org.<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs2.de.openbsd.org:/cvs</strong><br>
Connu aussi sous le nom de openbsd.informatik.uni-erlangen.de</strong><br>
Situé à l'Université d'Erlangen-Nuremberg,
Allemagne<br>
Maintenu par <a href="mailto:grunk@pestilenz.org">Alexander von Gernler</a>.<br>
Protocoles : ssh, ssh port 2022, pserver<br>
Mise à jour toutes les 6 heures.<br>
Empreintes SSH :<br>
(RSA) 1024 fc:94:b0:c1:e5:b0:98:7c:58:43:99:76:97:ee:9f:b7<br>
(DSA) 1024 a9:00:3f:ba:50:81:16:d1:e9:b8:4f:3c:b2:10:e2:6c<br>
<p>
<li><strong>CVSROOT=anoncvs@mirror.osn.de:/cvs</strong><br>
Situé à Nürnberg, Allemagne<br>
Maintenu par <a href="mailto:aw@osn.de">Armin Wolfermann</a>.<br>
Protocoles : ssh<br>
Mise à jour toutes les 4 heures.<br>
Empreintes SSH :<br>
(RSA) 1024 fc:94:b0:c1:e5:b0:98:7c:58:43:99:76:97:ee:9f:b7<br>
(DSA) 1024 a9:00:3f:ba:50:81:16:d1:e9:b8:4f:3c:b2:10:e2:6c<br>
<p>
<li><strong>CVSROOT=anoncvs@openbsd.chem.uw.edu.pl:/cvs</strong><br>
Situé à Varsovie, Pologne<br>
Maintenu par <a href="mailto:admin@chem.uw.edu.pl">Piotr
Klein</a>.<br>
Protocoles : ssh<br>
Mise à jour toutes les 3 heures.<br>
<p>
<li><strong>CVSROOT=anoncvs@anoncvs.student.pw.edu.pl:/cvs</strong><br>
Situé à l'Université de Technologie de Varsovie, Pologne<br>
maintainu par <a href="mailto:dmarcink@elka.pw.edu.pl">Darek
Marcinkeiwicz</a>.<br>
Protocoles : ssh<br>
Mis à jour toutes les 3 heures.<br>
<li><strong>CVSROOT=anoncvs@anoncvs.se.openbsd.org:/cvs</strong><br>
Situé au Stacken computer club, KTH, Suède.<br>
Maintenu par <a href="mailto:hin@openbsd.org">Hans Insulander</a>.<br>
Protocoles : ssh<br>
Mis à jour toutes les 3 heures.<br>
</ul>

<p>
<em>Remarque :</em>, Si votre serveur est listé ici avec des
informations inexactes, veuillez contacter
<a href="mailto:beck@openbsd.org"><tt>beck@openbsd.org</tt></a>
</p>

<p>
Vous pouvez utiliser
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=traceroute&amp;sektion=8&amp;format=html">traceroute(8)</a>
pour trouver le serveur le plus proche de vous. Les problèmes
avec un serveur doivent être adressés directement au
<b>mainteneur</b> du serveur en question.
</dl>

<h3><a name="CRYPTO"><font color="#0000e0">Obtenir les sources crypto
    par cvs(1)</font></a></h3>

<p>
<strong>REMARQUE IMPORTANTE :</strong>
Il existe quelques remarques au sujet des logiciels cryptographiques que
tout le monde doit connaître :
<ul>
<li>Les sources d'OpenBSD viennent du Canada.  
Comme
        <a href="http://www.efc.ca/pages/doc/crypto-export.html">
        recherché par un Canadien</a>
et comme décrit dans la
        <a href="http://axion.physics.ubc.ca/ECL.html">
        liste de contrôle des exportations du Canada</a>
il est légal d'exporter les logiciels de crypto depuis le Canada
vers le reste du monde.
<p>
<li>Cependant, si vous êtes en dehors des USA et du Canada, vous
    ne devez pas récupérer les parties cryptographiques
    des sources d'OpenBSD depuis un serveur anoncvs Situé aux
    USA. Les fichiers en question sont :
<ul>
<li>src/kerberosIV/*
<li>src/kerberosV/*
<li>src/lib/libdes/*
<li>src/lib/libc/crypt/crypt.c
<li>src/lib/libc/crypt/morecrypt.c
<li>src/sys/crypto
<li>src/sys/netinet
<li>src/usr.sbin/afs/src/rxkad/*
<li>XF4/xc-mit/lib/Xdmcp/Wraphelp.c
<li>XF4/xc-old/lib/Xdmcp/Wraphelp.c
<li>XF4/xc/lib/Xdmcp/Wraphelp.c
</ul>
A cause de la loi américaine sur l'exportation des armes (ITAR),
les logiciels de crypto ne peuvent être exportés qu'au
Canada depuis les USA.
<p>
<li>Le projet OpenBSD cherche plus de serveurs anoncvs, veuillez lire
    plus bas pour savoir comment faire.
</ul>

<h3><a name="EXAMPLE"><font color="#0000e0">Exemples d'utilisation de
    cvs(1)</font></a></h3>

<p>
AVERTISSEMENT : si vous souhaitez mettre à jour une branche
(telle qu'une branche de correctifs) vers <i>current</i>, vous devez
ajouter l'option <code>-A</code> à la commande cvs mais
autrement, cette option est inutile. D'anciennes versions de la
documentation OpenBSD recommandait l'usage de cette option dans de
nombreux exemples. Nous ne la recommandons plus, sauf lorsqu'elle est
absolument nécessaire.

<p>
Un exemple d'utilisation d'un serveur anoncvs pourrait être :
<pre>
% <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
% <strong>cd /tmp</strong>
% <strong>cvs get src/sys/arch/sparc</strong>
    [copie les fichiers depuis le serveur sur la machine]
% <strong>cvs log src/sys/arch/sparc/sparc/locore.s</strong>
    [montre le journal des commit pour le fichier donné]
% <strong>cvs diff -bc -r1.1 -r1.5 src/sys/arch/sparc/sparc/locore.s</strong>
    [Montre les changements entre les versions 1.1 et 1.5]
</pre>

<p>
<a name="pserver">Pour pouvoir utiliser cvs avec ``pserver'' (une
connexion TCP directe plutôt que l'utilisation de ssh ou rsh) vous
devez vous connecter :</a>

<pre>
% <strong>setenv CVSROOT :pserver:anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
% <strong>cvs login</strong>
(Connexion à anoncvs@anoncvs1.ca.openbsd.org)
CVS password: <strong>anoncvs</strong>
    [Cela écrit une ligne dans ~/.cvspass (le nom de fichier est
    écrasé par CVS_PASSFILE).]
    [Une ligne d'exemple de mon ~/.cvspass après avoir
    tapé 'blah' ]
    [password is:                                                            ]
    [:pserver:anoncvs@anoncvs5.usa.openbsd.org:/cvs Au'yc                    ]
    [...après s'être connecté une fois, le CVSROOT ci-dessus fonctionnera    ]
% <strong>cvs get ksrc-i386 ksrc-common</strong>
    [Vous permet de ne récupérer QUE ce qui est
    nécessaire pour créer un noyau i386 ]
</pre>

<p>
Voici comment quelqu'un qui utilise anoncvs met à jour son
arborescence des sources :
<ul><li>Tout d'abord il faut commencer par récupérer une
arborescence initiale :

<p> (Si vous suivez <i>current</i>):
<pre>
        # <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
        # <strong>cd /usr</strong>
        # <strong>cvs -q get -P src</strong>
</pre>

<p> (Si vous suivez la branche des correctifs pour 3.6) : 
    <pre>
        # <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
        # <strong>cd /usr</strong>
        # <strong>cvs -q get -rOPENBSD_3_6 -P src</strong>
</pre>


<li> Ensuite, pour mettre à jour cette arborescence :
<p> (Si vous suivez <i>current</i>):
<pre>
        # <strong>cd /usr/src</strong>
        # <strong>cvs -q up -Pd</strong>
</pre>

<p> (Si vous suivez la branche des correctifs pour 3.6) : 
<pre>
        # <strong>cd /usr/src</strong>
        # <strong>cvs -q up -rOPENBSD_3_6 -Pd</strong>
</pre>

À chaque fois que vous lancerez ceci, cela synchronisera votre
arborescence /usr/src. Cela ne détruira aucun de vos changements
locaux, mais tentera d'y intégrer les changements. Si vous
utilisez les répertoires obj (pas les liens symboliques obj),
vous pouvez passer l'option "-I obj" sur la ligne de commande, qui
permettra d'éviter que cvs n'émette un avertissement au
sujet de tous les répertoires obj qu'il va rencontrer et qui ne
se Situent pas sur le serveur.

<p>
<li> REMARQUE : si vous mettez à jour vos sources depuis un
     serveur autre que celui à partir duquel vous avez
     récupéré les sources (ou depuis le CD), vous
     <strong>devez</strong> ajouter l'option <em>-d $CVSROOT</em>
     à la commande cvs.  
<pre>
        # <strong>cd /usr/src</strong>
        # <strong>cvs -d $CVSROOT -q up -Pd</strong>
</pre>
</li>
</ul>

<p>
Pour <a name="ports">utiliser</a> les <a href=ports.html>ports</a>, il
faut procéder de la même façon qu'avec src :
<ul><li> 
<p> (Si vous suivez <i>current</i>) : 
<pre>
        # <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
        # <strong>cd /usr</strong>
        # <strong>cvs -q get -Pd ports</strong>
</pre>
<p> (Si vous suivez la branche des correctifs pour 3.6) : 
<pre>
        # <strong>setenv CVSROOT anoncvs@anoncvs.ca.openbsd.org:/cvs</strong>
        # <strong>cd /usr</strong>
        # <strong>cvs -q get -rOPENBSD_3_6 -P ports</strong>
</pre>
<li> Ensuite, pour mettre à jour l'arborescence : 
<p> (Si vous suivez <i>current</i>) : 
<pre>
        # <strong>cd /usr/ports</strong>
        # <strong>cvs -q up -Pd</strong>
</pre>
<p> (Si vous suivez la branche des correctifs pour 3.6) : 
<pre>
        # <strong>cd /usr/ports</strong>
        # <strong>cvs -q up -rOPENBSD_3_6 -Pd</strong>
</pre>
</ul>

Dans l'exemple précédent, <i>-q</i> est optionnel, et
n'est là que pour minimiser la sortie cvs. Pour ceux qui aime
avoir des écrans bien pleins, il peut être enlevé.

<p>
ou pour faire un diff sur un module corrigé en local (ici
<i>cd.c</i>) à inclure avec un rapport de bug :
<pre>
        # <strong>cd /usr</strong>
        # <strong>cvs diff -u src/sys/scsi/cd.c &gt; /tmp/patch</strong>
</pre>
</p>

<p>
La page du manuel
<a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1&amp;format=html">CVS(1)</a>
(inclue avec les sources de CVS) a beaucoup plus d'informations sur la
manière d'utiliser CVS.

<h4>Arborescence des sources X11</h4>

<p>
Les miroirs anoncvs comportent aussi l'arborescence des sources X11
(XFree86). Vous pouvez adapter les recettes ci-dessus pour mettre
à jour votre arborescence des source XFree86 depuis le
troisième CD. Vous pouvez copier ou télécharger
l'arbre des sources XFree86 3 avec le module cvs X11, cependant le
module contenant les sources XFree86 4 est XF4. Il y a deux
façons de récupérer les sources XF4 dans
<i>/usr/XF4</i> :
<ul>
<li>Copier l'arborescence depuis le CD (en supposant que le
    deuxième CD est monté sur /mnt) :
<pre>
        # <strong>cd /mnt; cp -Rp XF4 /usr</strong>
</pre>
<li>utiliser un union mount avec le CD monté dans un
    répertoire en écriture.
<pre>
        # <strong>mount -t union -o -b /mnt/XF4 /usr/XF4</strong>
</pre>
</ul>

Après ça, <i>/usr/X11</i> sera près à
être utilisé par cvs. Vous pouvez par exemple le mettre
à jour avec les sources -current (en supposant que vous avez
déjà prédéfinit la variable d'environnement
<var>CVSROOT</var>) :

<pre>
        # <strong>cd /usr/XF4</strong>
        # <strong>cvs -q update -Pd</strong>
</pre>

<p>
<strong>Avertissement :</strong>
Quand vous utilisez cvs il vous faudra prendre garde que votre
répertoire courant est soit la racine de l'arborescence des ports
ou une autre place telle que /tmp. Quelques commandes telles que "get"
peuvent créer une sous-arborescence arbitrairement dans le
répertoire courant, et chaque mise à jour successive ira
mettre à jour cette sous-arborescence.

<p>
Le serveur anoncvs donne une chance aux apprentis développeurs
d'apprendre les opérations cvs et de devenir ainsi
impliqué dans le développement des sources avant d'obtenir
un accès "commit". De plus, les gens fournissant des correctifs
peuvent les créer avec des diffs relatifs à l'arborescence
CVS, ce qui facilitera l'intégration.

<h3><a name="WHICH"><font color="#0000e0">Utiliser rsh(1) ou
    ssh(1)?</font></a></h3>

<p>
Par défaut, le client CVS utilise ssh ("secure shell":
<a href="http://www.openssh.com/">OpenSSH</a>)
pour dialoguer avec le serveur CVS.

<p>
De nombreux sites CVS ne supportent plus rsh pour des raisons de
sécurité. Des problèmes locaux tels que des pare-
feux ou des émulateurs de protocole imparfaits tels que slirp
peuvent aussi réduire l'utilisation de rsh. Cependant, si vous
souhaitez utiliser rsh, vous devez régler la variable
d'environnement <var>CVS_RSH</var> pour qu'elle pointe sur rsh
(typiquement, <strong>/usr/bin/rsh</strong>).

<p>
Si la politique locale empêche les connexions sortantes vers le
port par défaut de ssh (22), le port 2022 peut être
utilisé à la place. Notez cependant que tous les serveurs
anoncvs n'acceptent pas les connexions sur ce port. De plus, la plupart
des serveurs anoncvs n'acceptent plus le chiffrement
<strong>nul</strong>, puisqu'il est désactivé dans les
versions récentes de ssh pour raison de sécurité.
De plus, ne soyez pas tentés d'activer la compression : CVS
compresse déjà.

<p>
Vous pouvez spécifier quelque chose comme ce qui suit dans le
fichier de configuration <strong>$HOME/.ssh/config</strong> pour
éviter les écueils et restrictions mentionnées ci-
dessus :
<pre>
        Host anoncvs.ca.openbsd.org
            Compression no
            Port 2022
</pre>

<p>
CVS est un peu "bavard" au démarrage, pour éviter ceci, il
peut être utile de définir ceci :

<pre>
<strong>setenv CVS_CLIENT_PORT -1</strong>
</pre>

<p>
<h3><a name="SUP"><font color="#0000e0">Faire un miroir du CVS avec sup(1)</font></a></h3>

<p>
Les utilisateurs qui veulent faire un miroir de l'arborescence CVS
d'OpenBSD peuvent le faire depuis <em>anoncvs.usa.openbsd.org</em> ou
<em>anoncvs3.usa.openbsd.org</em> (ce sont des machines
différentes). Remarquez qu'il s'agit de l'arborescence cvs, et
<b>pas</b> de l'arborescence des sources. C'est utile uniquement si vous
voulez faire des opérations cvs de façon rapide (diff,
annotation, etc...) ou si vous avez de multiples arborescences de
sources et que vous voulez ne transférer les données
qu'une seule fois (vous pouvez ensuite récupérer une
arborescence des sources à partir de votre miroir cvs local).

<p>
Un exemple de fichier sup pourrait être :
<pre>
        cvs host=anoncvs.usa.openbsd.org hostbase=/ base=/home delete
</pre>
<p>
qui va créer un miroir de l'arborescence des ports dans /home/cvs
avec les fichiers de données sup dans /home/cvs. L'arborescence
du CVS OpenBSD fait actuellement une taille de 2.2 GB.

<h3><a name="MIRROR"><font color="#0000e0">Mettre en place un miroir
    anoncvs </font></a></h3>

<p> 
Si vous souhaitez mettre en place un site miroir anoncvs et de le mettre
à disposition du public, contactez le
<a href="mailto:sup@openbsd.org">mainteneur</a> anoncvs.

Les miroirs anoncvs nécessite 2.2 Go de disque et peuvent
utiliser jusqu'à 32 Mo de swap par utilisateur anoncvs (en
supposant que l'utilisateur fasse une opération d'envergure, de
plus petites opérations nécessiteront moins de ressources,
mais dans tous les cas, anoncvs utilise beaucoup plus de ressources que
sup ou ftp). De telles machines anoncvs se doivent d'avoir une
excellente connexion réseau pour la zone qu'elles ont l'intention
de servir. Un <a href="../anoncvs.shar">document</a> qui décrit
comment mettre en place les serveurs anoncvs est disponible.

<h3><font color=#0000e0>Remarques finales </font></h3>
Après avoir mis à jour l'arborescence des sources, vous
pouvez lire les commentaire en haut de <kbd>/usr/src/Makefile</kbd>
avant d'essayer de compiler. De plus vous devez construire un nouveau
noyau <strong>avant</strong> de faire un <kbd>make build</kbd> si
possible. Dans certains cas, il est indispensable de reconstruire et
installer l'utilitaire <kbd>config</kbd> avant de reconstruire le noyau.
Si <kbd>config GENERIC</kbd> ne fonctionne pas, c'en est probablement la
cause.
<p>
Il est important de noter que mettre à jour d'une version
d'OpenBSD vers une arborescence courante (current) est difficile
à cause des dépendances qui ne sont pas toujours
évidentes. Il est donc conseillé d'installer tout d'abord
le dernier snapshot avant de tenter de recompiler les sources.

<hr>
<a href="index.html"><img height=24 width=24 src="../back.gif" border=0 alt=OpenBSD></a> 
<a href=mailto:www@openbsd.org>www@openbsd.org</a>
<br>
<small>
Originally [OpenBSD: anoncvs.html,v 1.223 ]<br>
$Translation: anoncvs.html,v 1.67 2004/10/30 06:42:04 saad Exp $<br>
$OpenBSD: anoncvs.html,v 1.54 2004/10/30 08:40:25 jufi Exp $
</small>

</body>
</html>
