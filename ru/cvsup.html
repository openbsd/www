<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 3.2 Final//EN">
<html>
<head>
<title>OpenBSD CVSup</title>
<link rev="made" href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta http-equiv="Content-Type" content="text/html;charset=koi8-r">
<meta name="description" content="How to get OpenBSD updates via Internet using CVSup">
<meta name="keywords" content="openbsd,cvsup,updates">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 2001-2002 by OpenBSD.">
</head>

<body bgcolor="#FFFFFF" text="#000000" link="#23238E">

<a href="index.html">
<img alt="[OpenBSD]" height="30" width="141"
src="../images/smalltitle.gif" border="0"></a>

<h2><font color="#e00000">CVSup</font></h2>
<hr>

<h3>Оглавление</h3>
<ul>
<li><a href="#cvsup">Что такое CVSup?</a></li>
<li><a href="#starting">Работа с CVSup</a></li>
<li><a href="#using">Использование CVS для обновления исходного кода</a></li>
<li><a href="#checkout">Запуск CVSup в режиме извлечения</a></li>
<li><a href="#CVSROOT">Доступные CVSup сервера</a></li>
</ul>

<hr>


<h3><a name="cvsup"><font color="#0000e0">Что такое CVSup?</font></a></h3>

<p>
<b>CVSup</b> - это программное обеспечение позволяющее распространять и
обновлять деревья исходных текстов с главного <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cvs&amp;sektion=1">cvs(1)</a>
репозитория. Дерево исходных текстов OpenBSD поддерживается разработчиками на
центральной машине в Канаде. Используя CVSup, пользователь может содержать
своё собственное дерево исходных текстов в обновлённом состоянии.
</p>

<p>
<b>CVSup</b> использует, так называемую, вытягивающую модель обновления
исходных текстов. Под этой моделью подразумевается, что каждый CVSup клиент
запрашивает у сервера обновления. Сервер пассивно ожидает от клиента запрос.
Таким образом, все обновления провоцируются клиентом. Сервер никогда не
посылает данные, которые клиент не запрашивал. Пользователи же, должны
запускать клиент <b>CVSup</b> вручную или установить выполнение периодических
процессов с помощью <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=cron&amp;sektion=8">cron(8)</a>.
</p>

<p>
Термин <b>CVSup</b>, относится к полному пакету программ. Его главные
компоненты: клиент <tt>cvsup</tt>, который запускается на машине
пользователя и сервер <tt>cvsupd</tt>, который запущен на каждом CVSup сервере.
</p>

<p>
<b>CVSup</b> предназначался быть более эффективным и более гибким, чем
его предшественник - <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=sup&amp;sektion=1&amp;format=html">sup(1)</a>
</p> 

<p>
Проект OpenBSD в настоящее время имеет пять основных репозиториев: 
</p>

<ul>
  <li><b>src</b> - весь исходный текст для OpenBSD.</li>
  <li><b>ports</b> - адаптированное программное обеспечение (<a href="ports.html">порты</a>) для OpenBSD.</li>
  <li><b>www</b> - все веб страницы OpenBSD. (включая и эту).</li>
  <li><b>x11</b> - адаптированное под OpenBSD программное обеспечение
      <a href="http://www.XFree86.org/">XFree86-3</a>.</li>
  <li><b>xf4</b> - адаптированное под OpenBSD программное обеспечение
      <a href="http://www.XFree86.org/">XFree86-4</a>.</li>
</ul>

<h3><a name="CVS"><font color="#0000e0">Что такое CVS?</font></a></h3>

<p>
CVS - это система контроля версий, используется для управления исходными
текстами системы. Более подробно описано <a href="anoncvs.html#CVS">здесь</a>.
CVS и CVSup совершенно разные программы. Хотя CVS можно использовать для
удалённого доступа к файлам, он не оптимизирован для распространения полного
дерева по сети. CVSup более эффективно справляется с этой задачей.
</p>

<h3>
<a name="starting"><font color="#0000e0">Работа с CVSup</font></a>
</h3>

<p>
CVSup написан на Modula-3, поэтому его довольно сложно скомпилировать
и установить. Порт <tt>lang/ezm3</tt> содержит специальный дистрибутив
Modula-3 необходимый лишь для компиляции CVSup. Мы рекомендуем установить
уже собранный пакет CVSup с <a href="ftp.html">ftp сервера</a>, вместо
создания собственного из порта <tt>net/cvsup</tt>. В настоящий момент,
порты CVSup и Ezm3 доступны только для i386 платформы.
</p>

<p>
За дополнительной информацией о CVSup, обратитесь к домашней странице автора
<a href="http://www.polstra.com/projects/freeware/CVSup/">
http://www.polstra.com/projects/freeware/CVSup/</a>.
</p>

<p>
Пример файла конфигурации CVSup для
зеркалирования репозитория OpenBSD:
</p>

<pre>
        # Defaults that apply to all the collections
        *default release=cvs
        *default delete use-rel-suffix
        *default umask=002
        *default host=cvsup.uk.openbsd.org
        *default base=/cvs
        *default prefix=/cvs

        # If your network link is a T1 or faster, comment out the following line.
        *default compress

        OpenBSD-all
        #OpenBSD-src
        #OpenBSD-www
        #OpenBSD-ports
        #OpenBSD-x11
        #OpenBSD-xf4
</pre>

<p>
CVSup обновит весь исходной код OpenBSD с <b>cvsup.uk.openbsd.org</b> и
установит маску доступа <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=umask&amp;sektion=2">umask(2)</a>,
разрешающею запись для группы в локальном репозитории.
</p>

<p>
Предположим этот файл конфигурации, сохранен как <tt>cvs-supfile</tt>,
следующая команда запустит CVSup в графическом режиме:
</p>
<pre>
        cvsup cvs-supfile
</pre>
<p>
для запуска из скрипта или в терминале, используйте:
</p>
<pre>
        cvsup -g -L 2 cvs-supfile
</pre>

<h3><a name="using">
<font color="#0000e0">Использование CVS для обновления исходного кода</font>
</a></h3>

<p>
Чтобы получить любой из CVSup репозиториев.
Для Korn/Bourne оболочек:
</p>
<pre>
        # cd /usr
        # CVSROOT=/cvs cvs checkout src
</pre>
<p>
Для csh и его производных:
</p>
<pre>
        # cd /usr
        # setenv CVSROOT /cvs
        # cvs checkout src
</pre>

<p>
Вышесказанное извлечет current дерево исходных текстов OpenBSD. Чтобы
получить исходные тексты релиза OpenBSD, вы должны указать тег. Например:
</p>
<pre>
        # cd /usr
        # cvs checkout -rOPENBSD_2_9 src
</pre>
<p>
Или <tt>OPENBSD_2_8</tt> для 2.8, и т.д.
</p>

<h3><a name="checkout"><font color="#0000e0">Запуск CVSup в
режиме извлечения</font></a></h3>

<p>
В качестве альтернативы CVS, для получения исходных текстов, вы можете
использовать CVSup в режиме извлечения, добавляя <tt>тег</tt> или <tt>дату</tt>
к вашему файлу конфигурации, как <tt>*default</tt> или как опцию к указанному
репозиторию. В частности, вы можете использовать CVSup для обновления исходных
текстов и дерева портов, поставляемых на <a href="../orders.html">CD диске</a>.
</p>
<p>
Пример файла конфигурации для обновления портов:
</p>
<pre>
        # Defaults that apply to all the collections
        *default host=cvsup.uk.openbsd.org
        *default base=/var
        *default prefix=/usr
        *default release=cvs
        *default delete use-rel-suffix compress

        # Ports Collection.
        OpenBSD-ports tag=.
</pre>
<p>
Любой из CVS тегов может быть использован. Одиночная точка "." означает HEAD,
т.е. текущее, находящееся в разработке дерево. Будьте внимательны при указании
тега. CVSup не может отличить правильные теги от неправильных, попытка
синхронизации существующего дерева с указанием неправильного тега закончится
неудачей и CVSup удалит все существующие файлы.
</p>
<p>
Вы можете использовать ключевое слово <tt>date=[cc.]yy.mm.dd.hh.mm.ss</tt> для
выбора ревизии по времени. Все 17 или 20 символов должны быть указаны. Для 2000
года и более поздних необходимо указывать столетие <var>cc</var>. Для более
ранних годов достаточно указать только две последние цифры <var>yy</var>. Вы
можете также объединить <tt>тег</tt> и <tt>дату</tt>.
</p>

<h3>
<a name="CVSROOT"><font color="#0000e0">Доступные CVSup сервера</font></a>
</h3>

<p>
<a href="../cvsup.html#CVSROOT">Список доступных CVSup серверов</a>.

<p>
Если ваш сервер перечислен с неточной или неполной информацией, пожалуйста
свяжитесь с <a href="mailto:beck@openbsd.org"><tt>beck@openbsd.org</tt></a>
или <a href="mailto:brian@openbsd.org"><tt>brian@openbsd.org</tt></a>.

<p>
Вы можете использовать <a href="http://www.openbsd.org/cgi-bin/man.cgi?query=traceroute&amp;sektion=8">traceroute(8)</a>,
чтобы определить какой сервер находится ближе к вам. При возникновении проблем
с сервером, свяжитесь с <b>поддерживающим его персоналом</b>.

<p>
В настоящее время (7 апреля, 2003), размеры CVS репозитория таковы:
</p>
<table>
<tr><td width="20"></td>
    <td><strong>OpenBSD-ports</strong></td>
    <td>- <b>123</b>MB</td></tr>
<tr><td></td>
    <td><strong>OpenBSD-src</strong></td>
    <td>- <b>993</b>MB</td></tr>
<tr><td></td>
    <td><strong>OpenBSD-www</strong></td>
    <td>- <b>81</b>MB</td></tr>
<tr><td></td>
    <td><strong>OpenBSD-x11</strong></td>
    <td>- <b>200</b>MB</td></tr>
<tr><td></td>
    <td><strong>OpenBSD-xf4</strong></td>
    <td>- <b>439</b>MB</td></tr>
</table>
<p>
Должно быть, ещё дополнительно около <b>41</b>MB для CVSROOT и sup
каталогов. Суммарный размер репозитория увеличивается примерно на
<b>225</b>MB в год.
</p>
<p>
<strong>ВАЖНОЕ ПРИМЕЧАНИЕ:</strong> имеется несколько ограничений, касающихся
криптографического программного обеспечения, которые вы должны знать: 
</p>
<ul>
  <li>
    <p>
    Родина OpenBSD - Канада. Согласно
    <a href="http://www.efc.ca/pages/doc/crypto-export.html">
    исследованиям</a>, проведённым гражданином Канады, и как значится в
    <a href="http://axion.physics.ubc.ca/ECL.html">
    списке контроля над экспортом Канады</a>,
    экспортировать криптографическое ПО в остальной мир РАЗРЕШЕНО.
    </p>
  </li>
  <li>
    <p>
    Тем не менее, если вы находитесь вне США или Канады, вы не должны
    использовать криптографические части OpenBSD с анонимных CVS серверов
    расположенных в США. Рассматриваемые файлы...
    </p>
    <ul>
      <li><tt>src/kerberosIV/*</tt></li>
      <li><tt>src/kerberosV/*</tt></li>
      <li><tt>src/lib/libdes/*</tt></li>
      <li><tt>src/lib/libc/crypt/crypt.c</tt></li>
      <li><tt>src/lib/libc/crypt/morecrypt.c</tt></li>
      <li><tt>src/sys/crypto</tt></li>
      <li><tt>src/sys/netinet</tt></li>
      <li><tt>src/usr.sbin/afs/src/rxkad/*</tt></li>
      <li><tt>XF4/xc-mit/lib/Xdmcp/Wraphelp.c</tt></li>
      <li><tt>XF4/xc-old/lib/Xdmcp/Wraphelp.c</tt></li>
      <li><tt>XF4/xc/lib/Xdmcp/Wraphelp.c</tt></li>
    </ul>
    <p>
    По законам США ITAR криптографическое ПО может экспортироваться
    только в Канаду.
    </p>
  </li>
</ul>

<p>
Проект OpenBSD ищет дополнительные CVSup сервера -- если вы заинтересованы,
пожалуйста, свяжитесь с <a href="mailto:brian@openbsd.org">Brian Somers</a>
для обсуждения деталей конфигурирования.
</p>

<hr>
<a href="index.html">
<img height="24" width="24" src="../back.gif" border="0" alt="OpenBSD"></a>
<a href="mailto:www@openbsd.org">www@openbsd.org</a>

<br>
<small>
Originally [OpenBSD: cvsup.html,v 1.70 ]<br>
$Translation: cvsup.html,v 1.23 2003/11/02 17:17:24 dfa Exp $<br>
$OpenBSD: cvsup.html,v 1.20 2003/11/03 16:14:44 jufi Exp $
</small>

</body>
</html>
