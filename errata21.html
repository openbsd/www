<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>OpenBSD 2.1 errata</title>
<link rev=made href="mailto:www@openbsd.org">
<meta name="resource-type" content="document">
<meta name="description" content="the OpenBSD CD errata page">
<meta name="keywords" content="openbsd,cd,errata">
<meta name="distribution" content="global">
<meta name="copyright" content="This document copyright 1997-2001 by OpenBSD.">
</head>

<BODY BGCOLOR="#FFFFFF" TEXT="#000000" LINK="#23238E">

<a href="index.html"><img alt="[OpenBSD]" height="30" width="141" src="images/smalltitle.gif" border="0"></a>
<h2><font color="#0000e0">
This is the OpenBSD 2.1 release errata &amp; patch list:
</font></h2>

<hr>
<a href=stable.html>For OpenBSD patch branch information, please refer here.</a><br>
<br>
For errata on a certain release, click below:<br>
<a href="errata22.html">2.2</a>,
<a href="errata23.html">2.3</a>,
<a href="errata24.html">2.4</a>,
<a href="errata25.html">2.5</a>,
<a href="errata26.html">2.6</a>,
<a href="errata27.html">2.7</a>,
<a href="errata28.html">2.8</a>,
<a href="errata29.html">2.9</a>,
<a href="errata30.html">3.0</a>,
<a href="errata31.html">3.1</a>,
<a href="errata32.html">3.2</a>,
<a href="errata33.html">3.3</a>,
<a href="errata.html">3.4</a>.
<br>
<hr>

<p>
For more detailed information on how to install patches to OpenBSD, please
consult the <a href="./faq/faq10.html#10.14">OpenBSD FAQ</a>.
</p>

<br>
<dl>
<li><h3><font color="#e00000">All architectures</font></h3>
<ul>
<li>One of the install scripts has a flaw that makes the CD-ROM mount fail
	when using the CD-ROM as the install source media.
	To workaround this use the following sequence of commands before
	starting the install script. This must be done each time the install
	kernel is booted if the install script is to be run and the CD-ROM
	is the media to install from. Do the following at the shell prompt:
<pre><b>#</b> ed install.sub
/{_filesystem/s//{_fstype/
wq
<b>#</b>
</pre>
	For architectures where the install scripts start automatically
	(like amiga), you need to abort it at the (I)nstall or (U)pdate
	prompt by pressing Ctrl-C before doing the above command.  After
	that you can restart the install by:
<pre><b>#</b> install
</pre>
</ul>
<br>
<li><h3><font color="#e00000">Alpha</font></h3>
<ul>
<li>CD2 does not boot on the alpha, as had been planned. Instead, you
	must use the floppy install method.  This is not significantly
	harder..
</ul>
<br>
<li><h3><font color="#e00000">i386</font></h3>
<ul>
<li>Some rarer PC BIOSs do not like the hardrive bootblocks when used
as a MBR.  The symptom is that the BIOS says "READ ERROR" when booting,
but everything suggests it should work fine. In those cases, it is
sufficient to install OS-BS or some other primary bootloader as the main
MBR, then install OpenBSD in a partition all by itself starting at a
non-zero offset.  For instance, start OpenBSD at next track boundary or so.
<li>The i386/X11/SUMS.md5 file contains 4 incorrect MD5 checksums.
These have been corrected on the ftp mirrors. The correct lines are:<br>
MD5 (X33doc.tgz) = 6aa0be7987f9a3cf32a63b5ea9a83b39<br>
MD5 (X33html.tgz) = 6ba39d41aef7c75c35a0533275c6f8c0<br>
MD5 (X33ps.tgz) = ea49fc1b12c17fc16ece7d0e4ad4ee06<br>
MD5 (RELNOTES) = 689fda20596a4eb82f86ded51efb01f4<br>
<li>A lot of people with IDE disk drives fail to read the
INSTALL.i386 document, and hence end up with geometry translation
problems.  Read the document, please.
</ul>
<br>
<li><h3><font color="#e00000">Amiga</font></h3>
<ul>
<li>The amiga install has a flaw wrt Tseng based graphic cards: when entering
	multiuser mode the console won't get a login prompt.  This is due to
	a problem in the shipped /dev/MAKEDEV script.  To fix, enter single
	user mode and do:
<pre><b>#</b> cd /dev
<b>#</b> sh MAKEDEV ttye6
</pre>
</ul>
<li><h3><font color="#e00000">Sparc</font></h3>
<ul>
<li>The sparc X11R6.3 xdm-config files reference /usr/X11R6.3/... This is
	due to X11R6.3's default config file contents.  To fix, su and
	type:
<pre><b>#</b> cd /usr
<b>#</b> ln -s X11R6 X11R6.3
</pre>
<li>The sparc "single floppy install disk" has a problem when you specify
	"dumb" in response to the terminal type query.  As a work-around
	first specify an invalid terminal such as "bogus" and when prompted
	again for a terminal type, enter "dumb" and it will work correctly.
<li>When netbooting an older sparc system such as a Sun4 or Sun4c, the boot
	may hang up at the end of the tftp transfer of the bootstrap due
	to the tftp transfer working in 512-byte blocks.  If this occurs
	create a "padded" version of the bootstrap (boot or zboot) as follows:
<pre><b>#</b> cd /tftpboot
<b>#</b> dd if=boot of=newboot obs=512 conv=osync
<b>#</b> mv newboot boot
</pre>
<li>The sparc install script has two flaws that make the kernel copy
	and the bootblock install fail. The kernel copy only fails
	then installing from CD-ROM. To workaround this use the
	following sequence of commands before starting the install
	script. This must be done each time the install kernel is
	booted if the install script is to be run and the CD-ROM is
	the media to install from. Do the following at the shell
	prompt:
        if you install from CD-ROM do the following:
<pre><b>#</b> ed install.md 
/\/bsd/s//\/mnt2\/2.1\/sparc\/bsd/ 
wq 
<b>#</b>
</pre>
        ... or if you plan to use the bsd.scsi3 kernel you should use instead:
<pre><b>#</b> ed install.md 
/\/bsd/s//\/mnt2\/2.1\/sparc\/bsd.scsi3/ 
wq 
<b>#</b>
</pre>
        The following one you'll have to do always (not only then
	installing from CD-ROM)
<pre><b>#</b> ed /usr/mdec/binstall 
/getopt/,/getopt/+4d 
wq 
<b>#</b>
</pre>
</ul>
<li><h3><font color="#e00000">Pmax</font></h3>
<ul>
<li> When using the X11R6 binaries from the 2.1 release you will get
errors like:
<pre><b>#</b> mkfontdir
mkfontdir: undefined symbol: 'astpending' 12
Segmentation fault (core dumped)
</pre>
this is due to a little problem affecting the compatibility between
the OpenBSD/arc port (on which the X11R6 clients were build) and
OpenBSD/pmax. You can work around this problem by using the arc
version of the shared libc instead of the pmax one. Once you have the
OpenBSD/arc 2.1 libc.so.16.1, do the following:
<pre><b>#</b> cd /usr/lib
<b>#</b> mv libc.so.16.1 original_libc.so.16.1
<b>#</b> cp /where_you_have_downloaded_it_to/libc.so.16.1 .
<b>#</b> chown root.bin libc.so.16.1
<b>#</b> chmod 444 libc.so.16.1
</pre>
Please be careful while doing this - because the libc is a very
sensitive part of the system. You can remove the original_libc.so.16.1
after the next reboot if everything is working fine.
</ul>
<p>
<li><h3><font color="#e00000">Mac68k</font></h3>
<ul>
<li>The installer generates incorrect /etc/fstab files causing messages such as "file system read-only" on bootup.
To correct, boot to single-user mode (by clicking that checkbox in the Booter's Booting:Options dialog) and do the following:
<pre>
<b>#</b> mount /dev/sd0a /
<b>#</b> ed /etc/fstab
1,$s/ ufs / ffs /
1,$s/ ro / rw /
w
q
</pre>
Alternately, simply invoke vi or another editor and change the root filesystem 
to be of type ffs rather than ufs and be rw (read-write) rather than ro
(read-only).  In either case, you'll need to reboot the system afterwards.
Make this correction as soon as possible after installing the system.
The installer should not have specified the filesystem as the old
"ufs" type; the "ffs" type is more correct.

<li>The installer forgets to install the kernel onto the filesystem.
This is because the installer expects all packages including the kernel to 
be tar'ed and gzip'ed.  The kernel was not shipped that way.  Therefore, you
must make this correction <em>before attempting to boot the system</em>.
To correct, use the Installer mini-shell and do the following:
<pre>
> cpin :[internal-macos-path]:bsd-generic bsd
</pre>
This should place the kernel as /bsd on the filesystem. You should
replace the above string with the colon-delimited path from your desktop to
wherever you have placed the kernel.  If possible, it is easiest to drag the
kernel into the same folder as the Installer, so you can simply issue a
command without leading colon(s) like:
<pre>
> cpin bsd-generic bsd
</pre>
Good luck.
</ul>

</dl>
<hr>

<a href=stable.html>For OpenBSD patch branch information, please refer here.</a><br>
<br>
For errata on a certain release, click below:<br>
<a href="errata22.html">2.2</a>,
<a href="errata23.html">2.3</a>,
<a href="errata24.html">2.4</a>,
<a href="errata25.html">2.5</a>,
<a href="errata26.html">2.6</a>,
<a href="errata27.html">2.7</a>,
<a href="errata28.html">2.8</a>,
<a href="errata29.html">2.9</a>,
<a href="errata30.html">3.0</a>,
<a href="errata31.html">3.1</a>,
<a href="errata32.html">3.2</a>,
<a href="errata33.html">3.3</a>,
<a href="errata.html">3.4</a>.
<br>

<hr>
<a href=index.html><img height=24 width=24 src=back.gif border=0 alt=OpenBSD></a> 
<a href="mailto:www@openbsd.org">www@openbsd.org</a>
<br><small>$OpenBSD: errata21.html,v 1.30 2003/10/24 22:12:40 david Exp $</small>

</body>
</html>
