<!doctype html>
<html lang=en id=plus>
<meta charset=utf-8>
<title>OpenBSD 6.4 Changelog</title>
<meta name="description" content="OpenBSD 6.4 changes">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" type="text/css" href="openbsd.css">
<link rel="canonical" href="https://www.openbsd.org/plus64.html">
<style>
strong {
	color: var(--red);
	font-weight: normal;
}

h3 {
	color: var(--blue);
}
</style>

<h2 id=OpenBSD>
<a href="index.html">
<i>Open</i><b>BSD</b></a>
6.4 Changelog
</h2>
<hr>

<p>
This selection is intended to include all important
and all user-visible changes.
For a complete record of all changes, please see the "source-changes"
mailing list, called "OpenBSD CVS"
in the <a href="https://marc.info/?l=openbsd-cvs">archives</a>,
or use <a href="anoncvs.html#CVS">CVS</a>.

<p>
Note: <strong>Problems for which patches exist are marked in red</strong>.

<p>
For changes in other releases, click below:<br>
<a href="plus20.html">2.0</a>,
<a href="plus21.html">2.1</a>,
<a href="plus22.html">2.2</a>,
<a href="plus23.html">2.3</a>,
<a href="plus24.html">2.4</a>,
<a href="plus25.html">2.5</a>,
<a href="plus26.html">2.6</a>,
<a href="plus27.html">2.7</a>,
<a href="plus28.html">2.8</a>,
<a href="plus29.html">2.9</a>,
<a href="plus30.html">3.0</a>,
<a href="plus31.html">3.1</a>,
<a href="plus32.html">3.2</a>,
<a href="plus33.html">3.3</a>,
<a href="plus34.html">3.4</a>,
<a href="plus35.html">3.5</a>,
<a href="plus36.html">3.6</a>,
<br>
<a href="plus37.html">3.7</a>,
<a href="plus38.html">3.8</a>,
<a href="plus39.html">3.9</a>,
<a href="plus40.html">4.0</a>,
<a href="plus41.html">4.1</a>,
<a href="plus42.html">4.2</a>,
<a href="plus43.html">4.3</a>,
<a href="plus44.html">4.4</a>,
<a href="plus45.html">4.5</a>,
<a href="plus46.html">4.6</a>,
<a href="plus47.html">4.7</a>,
<a href="plus48.html">4.8</a>,
<a href="plus49.html">4.9</a>,
<a href="plus50.html">5.0</a>,
<a href="plus51.html">5.1</a>,
<a href="plus52.html">5.2</a>,
<a href="plus53.html">5.3</a>,
<br>
<a href="plus54.html">5.4</a>,
<a href="plus55.html">5.5</a>,
<a href="plus56.html">5.6</a>,
<a href="plus57.html">5.7</a>,
<a href="plus58.html">5.8</a>,
<a href="plus59.html">5.9</a>,
<a href="plus60.html">6.0</a>,
<a href="plus61.html">6.1</a>,
<a href="plus62.html">6.2</a>,
<a href="plus63.html">6.3</a>,
<a href="plus65.html">6.5</a>,
<a href="plus66.html">6.6</a>,
<a href="plus67.html">6.7</a>,
<a href="plus68.html">6.8</a>,
<a href="plus69.html">6.9</a>,
<a href="plus70.html">7.0</a>,
<a href="plus71.html">7.1</a>,
<br>
<a href="plus72.html">7.2</a>,
<a href="plus73.html">7.3</a>,
<a href="plus74.html">7.4</a>,
<a href="plus75.html">7.5</a>,
<a href="plus76.html">7.6</a>,
<a href="plus77.html">7.7</a>,
<a href="plus78.html">7.8</a>,
<a href="plus.html">current</a>.
<br>

<p>
<h3>Changes made between OpenBSD 6.3 and 6.4</h3>
<p>

<ul>
<li>Many changes not listed here.
<!-- 2018-04-16 -->
<li>Fix "heap full" errors in the amd64 boot loader when loading microcode.
<li>Add support in <a href="https://man.openbsd.org/com.4">com(4)</a> for Exar XR17V354 4-port devices.
<!-- 2018-04-15 -->
<li>Add TCP support to <a href="https://man.openbsd.org/snmpd.8">snmpd(8)</a>. Apart from processing multiple requests in parallel, this implements RFC 3430.
<li>Make <a href="https://man.openbsd.org/relayd.8">relayd(8)</a> set destination host state to HOST_DOWN in case of TCP read timeout.
<li><strong>6.1, 6.2 and 6.3 SECURITY FIX: Correct heap overflow bugs in <a href="https://man.openbsd.org/perl.1">perl(1)</a>.</strong><br>A source code patch is available for <a href="errata61.html#p039_perl">6.1</a>, <a href="errata62.html#p011_perl">6.2</a> and <a href="errata63.html#p001_perl">6.3</a>.
<!-- 2018-04-14 -->
<li>Make ENGINE_finish() succeed on NULL in LibreSSL, simplifies caller code.
<li>Make <a href="https://man.openbsd.org/ksh.1">ksh(1)</a> count $SECONDS using monotonic clock.
<li>Fix for <a href="https://man.openbsd.org/mg.1">mg(1)</a> when trying to write backups in home dir when run under a different effective user.
<!-- 2018-04-13 -->
<li>Remove hfsc support from <a href="https://man.openbsd.org/pfctl.8">pfctl(8)</a>.
<li>Don't panic if ipmi_sendcmd() fails.
<li>Make <a href="https://man.openbsd.org/sshd.8">sshd(8)</a> more resilient against user enumeration timing attacks.
<li>Implemented MAP_STACK option for <a href="https://man.openbsd.org/mmap.2">mmap(2)</a>. At pagefaults and syscalls the kernel will check that the SP points to MAP_STACK memory.
<!-- 2018-04-12 -->
<li>Stop using the PID in <a href="https://man.openbsd.org/ping.8">ping(8)</a>.
<li>Make <a href="https://man.openbsd.org/httpd.8">httpd(8)</a> listen on all IPv4 and IPv6 addresses for "listen on *".
<li>More steps for i386 Meltdown fixes, will trigger some performance issues.
<li>Make <a href="https://man.openbsd.org/re.4">re(4)</a> handle newer devices with only 64bit BARs, and map 32bit BAR as a fallback.
<!-- 2018-04-11 -->
<li>Add mixer save/restore capability to the <a href="https://man.openbsd.org/audio.4">audio(4)</a> driver for use during suspend/resume.
<li>Add support in <a href="https://man.openbsd.org/umsm.4">umsm(4)</a> for Huawei k3772-based devices.
<li>Make <a href="https://man.openbsd.org/sasyncd.8">sasyncd(8)</a> schedule events against the monotonic clock so it fires punctually even if system clock is changed.
<li>Have <a href="https://man.openbsd.org/fstat.1">fstat(1)</a> print rtable for internet sockets unless it's the default.
<li>In <a href="https://man.openbsd.org/tmux.1">tmux(1)</a>, add x and X to choose-tree to kill an item.
<li>Make sure the kernel doesn't call logwakeup() while holding a mutex to prevent lock ordering issues.
<!-- 2018-04-10 -->
<li>Make <a href="https://man.openbsd.org/mandoc.1">mandoc(1)</a> define a previously undefined integer as being zero.
<li>Make <a href="https://man.openbsd.org/ksh.1">ksh(1)</a> support 64bit integer operations on 32bit arches too.
<li>Added <a href="https://man.openbsd.org/octcrypto.4">octcrypto(4)</a>, a driver for the octeon cryptographic unit, providing hardware-accelerated implementations for several encryption and authentication algorithms for <a href="https://man.openbsd.org/ipsec.4">ipsec(4)</a>. Disabled for now.
<!-- 2018-04-09 -->
<li>Make <a href="https://man.openbsd.org/smtpd.8">smtpd(8)</a> spfwalk check for legitimate IPv4 and IPv6 addresses before printing.
<li>Make headers, manpages and kernel prefer and recommend AF_UNIX name rather than AF_LOCAL.
<li>In kqueue, test for preexisting conditions when re-enabling events.
<li>Make <a href="https://man.openbsd.org/pcidump.8">pcidump(8)</a> print BARs for bridges as well.
<li>On amd64, add support for EFI Random Number Generator and use it to XOR random data into the kernel.
<li>Add a hook to the standalone boot code to use a firmware-supplied random function in addition of the machine dependent random function to insert entropy into the booted kernel.
<!-- 2018-04-08 -->
<li>IPv6 fix for <a href="https://man.openbsd.org/gif.4">gif(4)</a>.
<li>Attach the mbuf tag on output <a href="https://man.openbsd.org/gif.4">gif(4)</a> packets to suppress loops over the interface and avoid leak of the tag on every packet.
<li>For certain arm devices, if the PHY address isn't specified, only attach a single PHY. Makes Theobrama Systems RK3399-Q7 SoM network interfaces work.
<li>Make <a href="https://man.openbsd.org/shutdown.8">shutdown(8)</a> print deadline estimates in the local timezone.
<li>Enable <a href="https://man.openbsd.org/islrtc.4">islrtc(4)</a> on arm64 GENERIC and RAMDISK kernels.
<li>Added <a href="https://man.openbsd.org/islrtc.4">islrtc(4)</a>, a driver for the ISL208 real time clock.
<li>Work around libtool exec limitations.
<li>Correct libtls <a href="https://man.openbsd.org/tls_config_clear_keys.3">tls_config_clear_keys(3)</a> behaviour, leaving other configuration data intact.
<li>In libtls, switch to <a href="https://man.openbsd.org/OPENSSL_init_ssl.3">OPENSSL_init_ssl(3)</a> to prevent an openssl configuration file from being loaded behind our backs.
<li>Add support in <a href="https://man.openbsd.org/dwmmc.4">dwmmc(4)</a> for GPIO card detection.
<li>Increase <a href="https://man.openbsd.org/em.4">em(4)</a> delay after reset to 20ms and add a fix for i219 based devices.
<!-- 2018-04-17 -->
<li>In UEFI, respect the parts where mappings indicate they can be made non-readable, non-executable or read-only.
<li>Fixed <a href="https://man.openbsd.org/tmpfs.4">tmpfs(4)</a> to not attempt calling <a href="https://man.openbsd.org/copyin.9">copyin(9)</a> itself.
<li>Patch binutils 2.17 so it passes option -Wno-null-pointer-arithmetic when compiled with LLVM 6.0.0.
<li>Updated llvm to 6.0.0.
<li>Make <a href="https://man.openbsd.org/fstat.1">fstat(1)</a> print a p flag for file descriptors opened after <a href="https://man.openbsd.org/pledge.2">pledge(2)</a>.
<li>Better rounding to cylinder boundaries in <a href="https://man.openbsd.org/disklabel.8">disklabel(8)</a>.
<li>In <a href="https://man.openbsd.org/ssh.1">ssh(1)</a>, allow "Sendenv -PATTERN" to clear environment previously labeled for sending.
<li>Fix file descriptor leak in <a href="https://man.openbsd.org/httpd.8">httpd(8)</a> after processing ranged requests.
<li>Use existing pf state to speed up UDP socket lookup.
<li>Fix memory leak in libcrypto if EVP_Digest() fails.
<!-- 2018-04-06 -->
<li>In libcrypto, tighten up various checks for X509_VERIFY_PARAM functions.
<li>In <a href="https://man.openbsd.org/ssh.1">ssh(1)</a>, relax checking of authorized_keys environment="..." options to allow underscores in variable names
<li>Stop using a non-portable .R <a href="https://man.openbsd.org/man.7">man(7)</a> macro in <a href="https://man.openbsd.org/mandoc.1">mandoc(1)</a>.
<li>Update <a href="https://man.openbsd.org/mandoc.1">mandoc(1)</a> to use documented and portable character escape sequences for .Do/.Dq.
<!-- 2018-04-05 -->
<li>Import pcap_set_immediate_mode() from mainline libpcap which allows a libpcap-based program to process packets as soon as they arrive.
<li>Remove obsolete PF_TRANS_ALTQ from <a href="https://man.openbsd.org/pf.4">pf(4)</a>. Note the required steps in the <a href="https://www.openbsd.org/faq/current.html#r20180404">update guide</a> if updating from source.
<li>Update default IPQoS in <a href="https://man.openbsd.org/ssh.1">ssh(1)</a> and <a href="https://man.openbsd.org/sshd.8">sshd(8)</a>.
<li>Libcrypto fixes in X509_NAME_add_entry().
<!-- 2018-04-04 -->
<li>Fix crash in <a href="https://man.openbsd.org/dig.1">dig(1)</a> when +trace option is enabled and a truncated reply forces fallback to TCP.
<!-- 2018-04-03 -->
<li>Deactivate WITNESS checks in <a href="https://man.openbsd.org/ddb.4">ddb(4)</a>, when db_active is set.
<li>On <a href="https://man.openbsd.org/vlan.4">vlan(4)</a> interfaces, use link0 to use llprio in transmitted packets.
<li>Imported regenerated moduli files for <a href="https://man.openbsd.org/ssh.1">ssh(1)</a>.
<li>Tweak vlan printing in <a href="https://man.openbsd.org/tcpdump.8">tcpdump(8)</a> to properly decode priority field.
<li>OpenSSH 7.7 released.
<li>Enabled <a href="https://man.openbsd.org/mvrng.4">mvrng(4)</a> for arm64 GENERIC and RAMDISK kernels.
<li>Fix in <a href="https://man.openbsd.org/bgpd.8">bgpd(8)</a> for aspath_verify() regarding 2-byte vs 4-byte AS path entries.
<li>Enabled <a href="https://man.openbsd.org/imxiomuxc.4">imxiomuxc(4)</a> on arm64 GENERIC and RAMDISK kernels.
<li>Unhook libXfont from xenocara builds, obsoleted by libXfont2.
<li>Enabled <a href="https://man.openbsd.org/dwpcie.4">dwpcie(4)</a>, <a href="https://man.openbsd.org/fec.4">fec(4)</a> and <a href="https://man.openbsd.org/imxccm.4">imxccm(4)</a> on arm64 GENERIC and RAMDISK kernels.
<li>Add minimal driver <a href="https://man.openbsd.org/dwpcie.4">dwpcie(4)</a> for the Synopsys Designware PCIe core.
<li>Added support for more Intel Apollo Lake devices found on some NUC and Celeron based systems.
<li>In <a href="https://man.openbsd.org/com.4">com(4)</a>, add support for register shift/IO-width to allow UARTs using 32-bit registers instead of 8-bit, found on some armv7, arm64 and amd64 SoCs.
<li>Add support for arbitrary-length integers in <a href="https://man.openbsd.org/test.1">test(1)</a>.
<!-- 2018-04-02 -->
<li>Fix binutils 2.17 to build without warnings on LLVM 6.0.0.
<li>Enabled <a href="https://man.openbsd.org/imxanatop.4">imxanatop(4)</a> on armv7 RAMDISK kernels.
<li>Fix for previously incorrect MII speed setting on armv7 <a href="https://man.openbsd.org/fec.4">fec(4)</a>.
<li>Fixes in <a href="https://man.openbsd.org/apply.1">apply(1)</a> for <a href="https://man.openbsd.org/realloc.3">realloc(3)</a> noticed when <a href="https://man.openbsd.org/malloc.conf.5">malloc.conf(5)</a> had the J option enabled.
<li>LibreSSL 2.7.2 released.
<li>Fixes for UFS2 with softdep enabled.
<!-- 2018-04-01 -->
<li>Implemented an EFI driver to allow PXE boot over EFIs Simple Network Protocol, allowing TFTP boot on U-Boot based armv7 and arm64 machines.
<li>Fix '-v' option to <a href="https://man.openbsd.org/procmap.1">procmap(1)</a> when using -a to help show holes in the process map.
<li>Enabled <a href="https://man.openbsd.org/mvtemp.4">mvtemp(4)</a> on arm64 GENERIC kernels.
<li>Added <a href="https://man.openbsd.org/mvtemp.4">mvtemp(4)</a> a driver for temperature sensors found on Marvell Armada SoCs.
<li>Fix mbuf reuse when sending ARP responses to prevent stale mbuf state affecting the ARP reply packet.
<li>Fix 64bit integer overflows in <a href="https://man.openbsd.org/expr.1">expr(1)</a>.
<li>Fix a hang in i386 vmware guests in /sbin/init.
<li>Recommit of the i386 Meltdown fix.
<li>Fix '-i' on <a href="https://man.openbsd.org/dhclient.8">dhclient(8)</a> to discard previously defined values.
<!-- 2018-03-31 -->
<li>Enable <a href="https://man.openbsd.org/imxiic.4">imxiic(4)</a> and <a href="https://man.openbsd.org/imxanatop.4">imxanatop(4)</a> on arm64 GENERIC and RAMDISK kernels.
<li>Enable <a href="https://man.openbsd.org/imxgpc.4">imxgpc(4)</a>, <a href="https://man.openbsd.org/imxgpio.4">imxgpio(4)</a> and <a href="https://man.openbsd.org/imxesdhc.4">imxesdhc(4)</a> on GENERIC and RAMDISK kernels for the arm64 platform.
<li>Also move <a href="https://man.openbsd.org/imxgpc.4">imxgpc(4)</a>, <a href="https://man.openbsd.org/imxgpio.4">imxgpio(4)</a> and <a href="https://man.openbsd.org/imxesdhc.4">imxesdhc(4)</a> drivers so they can be shared between arm64 and armv7.
<li>Fix potential overflow in <a href="https://man.openbsd.org/cut.1">cut(1)</a> for 64bit systems.
<!-- 2018-03-30 -->
<li>Updated bdftopcf to version 1.1.
<li>Moved driver for <a href="https://man.openbsd.org/imxuart.4">imxuart(4)</a> so it can be shared by arm64 and armv7.
<li>Updated <a href="https://man.openbsd.org/xterm.1">xterm(1)</a> to version 331.
<li>Updated <a href="https://man.openbsd.org/unbound.8">unbound(8)</a> to 1.7.0.
<li>Enable <a href="https://man.openbsd.org/mvclock.4">mvclock(4)</a>, <a href="https://man.openbsd.org/mvicu.4">mvicu(4)</a>, <a href="https://man.openbsd.org/mvpinctrl.4">mvpinctrl(4)</a>, <a href="https://man.openbsd.org/mvgpio.4">mvgpio(4)</a> and <a href="https://man.openbsd.org/mvrtc.4">mvrtc(4)</a> on GENERIC and RAMDISK kernels for arm64 platforms.
<li>Added support for <a href="https://man.openbsd.org/mvrtc.4">mvrtc(4)</a>, a real time clock integrated on various Marvell Armada SoCs.
<li>Fixed some <a href="https://man.openbsd.org/setlocale.3">setlocale(3)</a> bugs.
<li>Add support in the flattened device tree code for legacy binding of Marvell devices for "usb-nop-xceiv" PHYs.
<li>Fix memory leak in sparc64 ofwboot when booting <a href="https://man.openbsd.org/softraid.4">softraid(4)</a> crypto devices.
<li>Prevent <a href="https://man.openbsd.org/tmux.1">tmux(1)</a> from crashing in certain cases with empty windows.
<!-- 2018-03-29 -->
<li>Fixed network locking in <a href="https://man.openbsd.org/pppx.4">pppx(4)</a>.
<li>Fix in libcrypto for CVS-2018-0739 regarding ASN.1 recursive definition depth.
<li>Remove RDTSCP from CPUID flags reported to <a href="https://man.openbsd.org/vmm.4">vmm(4)</a> guests.
<li>Fix remaining external file system locking so VOP_LOCKs are done in accordance with how WITNESS wants it.
<li>Fix memory leak in <a href="https://man.openbsd.org/pf.4">pf(4)</a> when adding same table twice.
<li>Check for possible NFS race after sleeping to prevent future lock ordering problem.
<li>Mark ext2fs inode recursive lock as RWL_IS_VNODE to help when WITNESS is enabled.
<li>Configure <a href="https://man.openbsd.org/dwxe.4">dwxe(4)</a> TX and RX chain delay based on device tree properties.
<!-- 2018-03-27 -->
<li>In the X.org DRM code, defer disabling the vblank IRQ until next interrupt.
<li>Updated time zone data to tzdata2018d.
<li>Added <a href="https://man.openbsd.org/acpicmos.4">acpicmos(4)</a>, a driver that implements SystemCMOS access support.
<li>SSLeay history from 0.4 to 0.8.1b added to SSL manpages.
<li>Make sure <a href="https://man.openbsd.org/nc.1">nc(1)</a> clears password buffers in non-terminating cases.
<li>Fix wrong execution and out of boundary writes in <a href="https://man.openbsd.org/apply.1">apply(1)</a>.
<li>Make sure programs violating a <a href="https://man.openbsd.org/pledge.2">pledge(2)</a> promise cannot block the final SIGABRT.
<li>Try harder to execute code protected by mutexes after entering <a href="https://man.openbsd.org/ddb.4">ddb(4)</a>.
<li>Exclude SIGKILL from <a href="https://man.openbsd.org/ptrace.2">ptrace(2)</a> interception to prevent deadlock when parent waits for the traced process.
<!-- 2018-03-26 -->
</ul>
